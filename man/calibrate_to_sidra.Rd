% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calibrate-to-sidra.R
\name{calibrate_to_sidra}
\alias{calibrate_to_sidra}
\title{Calibrate Weights to IBGE SIDRA Series (Optional)}
\usage{
calibrate_to_sidra(
  data,
  theme = c("unemployment", "employment", "labor_force", "income", "custom"),
  sidra_series = NULL,
  verbose = TRUE
)
}
\arguments{
\item{data}{A data.table output from \code{\link{mensalizePNADC}} with
\code{compute_weights = TRUE}. Must contain \code{weight_monthly} and
employment status variables (\code{VD4001}, \code{VD4002}, etc.).}

\item{theme}{Character. Which IBGE series to match:
\describe{
\item{"unemployment"}{Taxa de desocupacao - unemployment rate}
\item{"employment"}{Populacao ocupada - employment levels}
\item{"labor_force"}{PEA/PNEA - labor force participation}
\item{"income"}{Rendimento habitual - income aggregates}
\item{"custom"}{User provides target series via \code{sidra_series}}
}}

\item{sidra_series}{Optional data.frame with monthly target series.
Required if \code{theme = "custom"}. Must contain:
\itemize{
\item \code{ref_month_yyyymm}: Month in YYYYMM format
\item \code{m_*}: Target values for each indicator (in thousands)
}}

\item{verbose}{Logical. Print progress messages? Default TRUE.}
}
\value{
A data.table with the input data plus:
\itemize{
\item \code{weight_sidra}: Bayesian-adjusted weight matching SIDRA series
}

The original \code{weight_monthly} is preserved for comparison.
}
\description{
This is an \strong{optional} function for users who need their estimates to exactly
match IBGE's official monthly series. The core \code{\link{mensalizePNADC}}
function already produces valid monthly weights; this function provides
additional calibration for specific themes.

\strong{Important}: Different themes require different Bayesian calibrations.
For example, weights calibrated to match unemployment rates will differ
from weights calibrated to match employment levels.
}
\details{
Applies theme-specific Bayesian calibration so aggregated estimates match
IBGE's official SIDRA published series.
\subsection{Why Theme-Specific Calibration?}{

IBGE's published SIDRA series are internally consistent but use slightly
different adjustments for different indicators. This means:

\itemize{
\item Weights optimized for unemployment rate may not sum exactly to
the published employment level
\item Weights optimized for employment may not produce the exact
published unemployment rate
}

Choose the theme that matches your primary analysis focus.
}

\subsection{Algorithm}{

Uses Bayes' theorem to adjust individual weights:
\deqn{P(status | category) = P(status) \times P(category | status) / P(category)}

Where:
\itemize{
\item status = employment situation (employed, unemployed, etc.)
\item category = demographic/geographic cell
\item P(status) is derived from SIDRA targets
}
}
}
\examples{
\dontrun{
# First, get base weights (auto-fetches population from SIDRA)
crosswalk <- mensalizePNADC(pnadc_full, compute_weights = TRUE)

# Then, calibrate for unemployment analysis
unemployment_data <- calibrate_to_sidra(crosswalk, theme = "unemployment")

# Calculate unemployment rate (will match IBGE SIDRA exactly)
unemployment_data[, .(
  rate = sum(weight_sidra * (VD4002 == 2)) /
         sum(weight_sidra * (VD4001 == 1)) * 100
), by = ref_month_yyyymm]
}

}
\seealso{
\code{\link{mensalizePNADC}} for core mensalization (required first)
\code{\link{adjust_weights_bayesian}} for the underlying Bayesian algorithm
}
