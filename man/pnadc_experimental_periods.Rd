% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/experimental-period-identification.R
\name{pnadc_experimental_periods}
\alias{pnadc_experimental_periods}
\title{Experimental Period Identification Strategies}
\usage{
pnadc_experimental_periods(
  crosswalk,
  data = NULL,
  strategy = c("none", "probabilistic", "upa_aggregation", "both"),
  upa_homogeneity_threshold = 0.8,
  verbose = TRUE
)
}
\arguments{
\item{crosswalk}{A crosswalk data.table from \code{pnadc_identify_periods()}}

\item{data}{The original PNADC data.table used to build the crosswalk
(required for probabilistic strategy to access date bounds)}

\item{strategy}{Character vector specifying which strategies to apply.
Options: "none", "probabilistic", "upa_aggregation", "both"}

\item{upa_homogeneity_threshold}{Numeric. Only apply UPA aggregation if
the measured UPA homogeneity rate exceeds this threshold. Default 0.80.}

\item{verbose}{Logical. If TRUE, print progress information.}
}
\value{
A modified crosswalk with additional columns:
\itemize{
\item \code{ref_fortnight_likely}: Probabilistic best guess (NA if range > 2)
\item \code{ref_fortnight_confidence}: Probability of being correct (0.5-1.0)
\item \code{ref_week_likely}: Probabilistic best guess (NA if range > 2)
\item \code{ref_week_confidence}: Probability of being correct (0.5-1.0)
\item \code{ref_fortnight_upa}: UPA-aggregated fortnight (if strategy enabled)
\item \code{ref_week_upa}: UPA-aggregated week (if strategy enabled)
}
}
\description{
Two experimental strategies are available:
\itemize{
\item \strong{probabilistic}: For narrow ranges (2 possible fortnights/weeks),
calculates the probability-weighted best guess based on date position
\item \strong{upa_aggregation}: Aggregates constraints at UPA level
(experimental - IBGE does NOT interview UPAs together)
}
}
\details{
Provides experimental strategies for improving fortnight and week
identification rates beyond the standard algorithm. These strategies
are for research and testing purposes and should NOT replace the main
identification logic.
\subsection{Probabilistic Strategy}{

When the interview date range spans exactly 2 fortnights or weeks, we can
calculate the probability that the interview occurred in the earlier vs later
period based on the relative position of the date range boundaries.

For example, if date_min is day 10 and date_max is day 20, and the fortnight
boundary is day 15, then:
\itemize{
\item Days 10-15 (6 days) fall in fortnight 1
\item Days 16-20 (5 days) fall in fortnight 2
\item Probability of fortnight 1: 6/11 â‰ˆ 55\%
}
}

\subsection{UPA Aggregation Strategy}{

This strategy tests whether aggregating constraints at UPA level (across all
households in the same UPA) improves determination rates. This is EXPERIMENTAL
because IBGE does NOT interview entire UPAs on the same day - interviews are
spread across the quarter.

The UPA homogeneity rate (percentage of UPAs where all determined households
have the same fortnight/week) is calculated first. Only if this exceeds the
threshold is UPA aggregation applied.
}
}
\note{
These strategies produce "likely" assignments, not definitive determinations.
The standard \code{pnadc_identify_periods()} function should be used for
rigorous analysis. These experimental outputs are useful for:
\itemize{
\item Sensitivity analysis
\item Robustness checks
\item Research into identification algorithm improvements
}
}
\examples{
\dontrun{
# Build standard crosswalk
crosswalk <- pnadc_identify_periods(pnadc_data)

# Apply experimental strategies
crosswalk_exp <- pnadc_experimental_periods(
  crosswalk,
  pnadc_data,
  strategy = "probabilistic"
)

# Check how many additional "likely" assignments we get
crosswalk_exp[, .(
  determined = sum(!is.na(ref_fortnight_in_quarter)),
  likely = sum(!is.na(ref_fortnight_likely)),
  high_confidence = sum(ref_fortnight_confidence >= 0.7, na.rm = TRUE)
)]
}

}
\seealso{
\code{\link{pnadc_identify_periods}} to build the crosswalk that
this function modifies.
}
