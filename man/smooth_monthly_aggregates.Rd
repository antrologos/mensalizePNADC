% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/smooth-aggregates.R
\name{smooth_monthly_aggregates}
\alias{smooth_monthly_aggregates}
\title{Smooth Monthly Aggregates}
\usage{
smooth_monthly_aggregates(
  monthly_aggregates,
  calibration_start = 201301L,
  calibration_end = 201912L
)
}
\arguments{
\item{monthly_aggregates}{A data.table with monthly aggregated indicators.
Required columns:
\itemize{
\item \code{ref_month_yyyymm}: Month identifier in YYYYMM format
\item \code{z_*}: Indicator columns with monthly totals (e.g., z_popocup)
}}

\item{calibration_start}{Integer YYYYMM. Start of calibration period. Default 201301.}

\item{calibration_end}{Integer YYYYMM. End of calibration period. Default 201912.}
}
\value{
A data.table with smoothed monthly estimates. For each input variable
\code{z_varname}, the output includes:
\itemize{
\item \code{m_varname}: Smoothed monthly estimate
}
}
\description{
When quarterly survey data is converted to monthly estimates, the resulting
time series often shows artificial quarterly patterns. This function applies
a smoothing algorithm that:
\enumerate{
\item Computes 3-month differences to capture trends
\item Stratifies by month position within quarter (1st, 2nd, 3rd)
\item Accumulates changes via cumulative sums
\item Calibrates against a reference period
\item Produces smooth monthly series that preserve genuine variation
}
}
\details{
Applies moving average methodology to remove quarterly artifacts from
monthly estimates derived from quarterly survey data.

The smoothing algorithm works as follows:

For each indicator variable:
\enumerate{
\item Compute 3-month difference: \code{d3 = 3 * (value[t] - value[t-1])}
\item Split by month position (1, 2, 3 within quarter)
\item Compute cumulative sum within each position
\item Calculate residual from intermediate series during calibration period
\item Apply position-specific adjustment
\item Final smoothed value uses moving average of quarterly reference
}
}
\examples{
\dontrun{
# After calibrating weights, aggregate to monthly totals
monthly_agg <- calibrated_data[, .(z_populacao = sum(weight_calibrated)), by = ref_month_yyyymm]
smoothed <- smooth_monthly_aggregates(monthly_agg)
}

}
\seealso{
\code{\link{calibrate_monthly_weights}}, \code{\link{mensalizePNADC}}
}
