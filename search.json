[{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting Started with mensalizePNADC","text":"mensalizePNADC package converts Brazilâ€™s quarterly PNADC (Pesquisa Nacional por Amostra de Domicilios Continua) survey data monthly time series. provides two main capabilities: Reference month identification: Determines month within quarter survey observation refers Monthly weight computation: Adjusts survey weights monthly (instead quarterly) estimates","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"performance-summary","dir":"Articles","previous_headings":"Introduction","what":"Performance Summary","title":"Getting Started with mensalizePNADC","text":"Tested 55 quarters (2012Q1 - 2025Q3) 28,395,273 observations:","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Getting Started with mensalizePNADC","text":"","code":"# Install from GitHub devtools::install_github(\"antrologos/mensalizePNADC\")"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"important-use-stacked-data","dir":"Articles","previous_headings":"","what":"Important: Use Stacked Data","title":"Getting Started with mensalizePNADC","text":"algorithm achieves 95.83% determination rate processing stacked multi-quarter data. process quarters individually, â€™ll get ~65-75% determination. Recommended: Stack least 2 years quarterly data calling mensalizePNADC().","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"algorithm-overview-visual-diagram","dir":"Articles","previous_headings":"","what":"Algorithm Overview: Visual Diagram","title":"Getting Started with mensalizePNADC","text":"reference month identification follows 6-step pipeline. â€™s complete flow:","code":"â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                    REFERENCE MONTH IDENTIFICATION PIPELINE                   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  INPUTS (per observation): â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  Year (Ano)  â”‚  â”‚  Quarter     â”‚  â”‚  Birthday    â”‚  â”‚  Age         â”‚ â”‚              â”‚  â”‚  (Trimestre) â”‚  â”‚  (V2008/1/2) â”‚  â”‚  (V2009)     â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚                â”‚                  â”‚                 â”‚         â–¼                â–¼                  â–¼                 â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ STEP 1: Calculate Valid Interview Saturdays                                 â”‚ â”‚         (IBGE \"Parada TÃ©cnica\" Rules)                                       â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  For each month, find first Saturday with â‰¥4 days in that month.            â”‚ â”‚  This defines when interviews for that month's reference week can occur.    â”‚ â”‚                                                                             â”‚ â”‚  OUTPUT: date_min = First Saturday of Month 1                               â”‚ â”‚          date_max = First Saturday of Month 3 + 21 days                     â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚                                      â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ STEP 2: Apply Birthday Constraints                                          â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  Compare (Survey_Year - Birth_Year) with Reported_Age to determine if      â”‚ â”‚  interview was BEFORE or AFTER the person's birthday this year.            â”‚ â”‚                                                                             â”‚ â”‚  If AFTER birthday  â†’ date_min = max(date_min, Sat_after_birthday)          â”‚ â”‚  If BEFORE birthday â†’ date_max = min(date_max, Sat_before_birthday)         â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚                                      â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ STEP 3: Convert Date Ranges to Month Positions (1, 2, or 3)                 â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  month_min_pos = which month does date_min fall in?                         â”‚ â”‚  month_max_pos = which month does date_max fall in?                         â”‚ â”‚                                                                             â”‚ â”‚  Special handling: days 1-3 of a month belong to previous month's week      â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚                                      â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ STEP 4: Aggregate to UPA-Panel Level                                        â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  All people in same (UPA, V1014) are interviewed in the SAME MONTH.         â”‚ â”‚  Take intersection of all individual constraints:                           â”‚ â”‚                                                                             â”‚ â”‚    upa_month_min = max(all individual month_min_pos)                        â”‚ â”‚    upa_month_max = min(all individual month_max_pos)                        â”‚ â”‚                                                                             â”‚ â”‚  If upa_month_min = upa_month_max â†’ DETERMINED!                             â”‚ â”‚  If upa_month_min < upa_month_max â†’ Still ambiguous, try Step 5             â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚                                      â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ STEP 5: Cross-Quarter Aggregation (KEY INNOVATION)                          â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  PNADC uses ROTATING PANEL: same (UPA, V1014) interviewed in SAME MONTH     â”‚ â”‚  POSITION across all quarterly visits (up to 5 consecutive quarters).       â”‚ â”‚                                                                             â”‚ â”‚  Combine constraints from ALL quarters â†’ dramatically improves accuracy:    â”‚ â”‚                                                                             â”‚ â”‚    Per-quarter only:  ~65-75% determination                                 â”‚ â”‚    Cross-quarter:     ~95.83% determination                                 â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚                                      â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ STEP 6: Handle Exception Quarters                                           â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  For quarters with non-standard timing (2016t3, 2016t4, 2017t2, 2022t3,     â”‚ â”‚  2023t2), apply relaxed rule: â‰¥3 days instead of â‰¥4 days.                   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚                                      â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ OUTPUT                                                                       â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  ref_month_in_quarter: 1, 2, 3, or NA (indeterminate)                       â”‚ â”‚  ref_month:            Full date (e.g., 2023-02-01)                         â”‚ â”‚  ref_month_yyyymm:     Integer format (e.g., 202302)                        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"basic-usage-identifying-reference-months","dir":"Articles","previous_headings":"","what":"Basic Usage: Identifying Reference Months","title":"Getting Started with mensalizePNADC","text":"common use case identifying month observation refers , joining information data.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-1-prepare-your-data","dir":"Articles","previous_headings":"Basic Usage: Identifying Reference Months","what":"Step 1: Prepare your data","title":"Getting Started with mensalizePNADC","text":"need stacked quarterly PNADC data least columns:","code":"library(mensalizePNADC) library(data.table)  # Load your stacked quarterly PNADC data pnadc <- fread(\"pnadc_stacked.csv\",   select = c(\"Ano\", \"Trimestre\", \"UPA\", \"V1008\", \"V1014\", \"V2003\",              \"V2008\", \"V20081\", \"V20082\", \"V2009\"))  # Check data dimensions cat(\"Rows:\", nrow(pnadc), \"\\n\") cat(\"Quarters:\", uniqueN(pnadc[, .(Ano, Trimestre)]), \"\\n\")"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-2-get-the-crosswalk","dir":"Articles","previous_headings":"Basic Usage: Identifying Reference Months","what":"Step 2: Get the crosswalk","title":"Getting Started with mensalizePNADC","text":"","code":"crosswalk <- mensalizePNADC(pnadc) # Step 1/1: Identifying reference months... #   Determination rate: 95.8%  print(crosswalk) # PNADC Reference Month Crosswalk # ------------------------------- # Observations: 28,395,273 # Determination rate: 95.8% # Date range: 201201 - 202509 # # Join keys: Ano, Trimestre, UPA, V1008, V1014, V2003 # Output columns: ref_month, ref_month_in_quarter, ref_month_yyyymm"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-3-join-with-original-data","dir":"Articles","previous_headings":"Basic Usage: Identifying Reference Months","what":"Step 3: Join with original data","title":"Getting Started with mensalizePNADC","text":"","code":"# Load an original quarterly file library(haven) original <- read_dta(\"PNADC_2023T1.dta\")  # Join to add monthly information monthly_data <- merge(original, crosswalk,   by = c(\"Ano\", \"Trimestre\", \"UPA\", \"V1008\", \"V1014\", \"V2003\"),   all.x = TRUE)  # Now you have: # - ref_month: Reference month as Date (e.g., 2023-01-01) # - ref_month_in_quarter: Position in quarter (1, 2, 3, or NA) # - ref_month_yyyymm: Integer YYYYMM format (e.g., 202301)"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-4-use-the-monthly-information","dir":"Articles","previous_headings":"Basic Usage: Identifying Reference Months","what":"Step 4: Use the monthly information","title":"Getting Started with mensalizePNADC","text":"","code":"# Filter to a specific month jan_2023 <- monthly_data[ref_month_yyyymm == 202301]  # Group by month by_month <- monthly_data[, .(   n_obs = .N,   mean_age = mean(V2009, na.rm = TRUE) ), by = ref_month_yyyymm]  # Check determination rate by year monthly_data[, .(   total = .N,   determined = sum(!is.na(ref_month_in_quarter)),   rate = round(mean(!is.na(ref_month_in_quarter)) * 100, 1) ), by = Ano]"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"how-the-algorithm-works-detailed-explanation","dir":"Articles","previous_headings":"","what":"How the Algorithm Works: Detailed Explanation","title":"Getting Started with mensalizePNADC","text":"reference month identification algorithm determines three months quarter survey observation belongs . section explains step detail concrete examples.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"background-pnadc-survey-structure","dir":"Articles","previous_headings":"How the Algorithm Works: Detailed Explanation","what":"Background: PNADC Survey Structure","title":"Getting Started with mensalizePNADC","text":"PNADC interviews households reference weeks throughout quarter. reference week: Ends Saturday Belongs specific reference month (month containing week) Follows IBGEâ€™s â€œParada TÃ©cnicaâ€ (technical break) scheduling rules challenge: PNADC microdata records quarter (Trimestre), specific month. package recovers month using birthday constraints panel structure.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-1-calculate-valid-interview-saturdays","dir":"Articles","previous_headings":"How the Algorithm Works: Detailed Explanation","what":"Step 1: Calculate Valid Interview Saturdays","title":"Getting Started with mensalizePNADC","text":"Goal: Determine Saturdays can serve end reference week month. IBGE Rule: reference week belongs month Saturday least 4 days within month. ensures majority 7-day reference week falls within month. calculate first valid Saturday: Detailed Example Q1 2023: Counter-example showing skip second Saturday: matters: valid Saturday calculation defines possible interview date range quarter: date_min = First valid Saturday Month 1 date_max = First valid Saturday Month 3 + 21 days (allowing 4 reference weeks) Q1 2023: date_min = Jan 7, date_max = Mar 4 + 21 = Mar 25.","code":"first_saturday_day = day of the first Saturday of the month if first_saturday_day >= 4:     use this Saturday (it has enough days in the month) else:     use the second Saturday (first_saturday_day + 7) JANUARY 2023:   Sun  Mon  Tue  Wed  Thu  Fri  SAT    1    2    3    4    5    6   [7]  â† First Saturday is day 7                                      7 â‰¥ 4? YES â†’ Valid! (7 days in January)  FEBRUARY 2023:   Wed  Thu  Fri  SAT  ...    1    2    3   [4]              â† First Saturday is day 4                                   4 â‰¥ 4? YES â†’ Valid! (4 days in February)  MARCH 2023:   Wed  Thu  Fri  SAT  ...    1    2    3   [4]              â† First Saturday is day 4                                   4 â‰¥ 4? YES â†’ Valid! (4 days in March) APRIL 2023:   SAT  Sun  Mon  Tue  ...   [1]   2    3    4              â† First Saturday is day 1                                   1 â‰¥ 4? NO â†’ Skip!    Fri  SAT  Sun  ...    7   [8]   9                   â† Second Saturday is day 8                                   Use this one instead"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-2-apply-birthday-constraints","dir":"Articles","previous_headings":"How the Algorithm Works: Detailed Explanation","what":"Step 2: Apply Birthday Constraints","title":"Getting Started with mensalizePNADC","text":"Goal: Narrow possible interview date window using personâ€™s birthday reported age. Key insight: reported age combined birth year tells us whether interview happened personâ€™s birthday year. calculation: Detailed Example 1: Interview birthday Detailed Example 2: Interview birthday Saturdays? Since reference weeks end Saturdays, constrain first Saturday () birthday, birthday . aligns IBGEâ€™s scheduling. Unknown birthdays: V2008=99, V20081=99, V20082=9999 (unknown), personâ€™s birthday constrain date. However, may still determined household aggregation (Step 4) cross-quarter aggregation (Step 5).","code":"visit_before_birthday = (Survey_Year - Birth_Year) - Reported_Age  If = 0: Interview was AFTER birthday (person already celebrated this year) If = 1: Interview was BEFORE birthday (birthday hasn't happened yet) Person: Born March 15, 1990 Survey Year: 2023 Reported Age: 33  Check: 2023 - 1990 = 33        33 - 33 = 0  â†’ Interview was AFTER March 15, 2023  Constraint: date_min = max(date_min, first_Saturday_on_or_after(March 15))             date_min = max(Jan 7, March 18) = March 18  This person can only have been interviewed in MARCH (month 3). The first two months are ruled out! Person: Born March 15, 1990 Survey Year: 2023 Reported Age: 32  Check: 2023 - 1990 = 33        33 - 32 = 1  â†’ Interview was BEFORE March 15, 2023  Constraint: date_max = min(date_max, Saturday_before(March 15))             date_max = min(March 25, March 11) = March 11  This person can only have been interviewed in JANUARY or FEBRUARY. March is ruled out!"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-3-convert-date-ranges-to-month-positions","dir":"Articles","previous_headings":"How the Algorithm Works: Detailed Explanation","what":"Step 3: Convert Date Ranges to Month Positions","title":"Getting Started with mensalizePNADC","text":"Goal: Transform date window [date_min, date_max] month--quarter positions (1, 2, 3). Basic conversion: Boundary handling (days 1-3 month): Interviews days 1-3 month typically belong reference week started previous month. algorithm handles : Example: Determination check:","code":"month_min_pos = which month of the quarter does date_min fall in? month_max_pos = which month of the quarter does date_max fall in? For date_min: if day â‰¤ 3 AND not in first month of quarter:               subtract 1 from month position  For date_max: if day â‰¤ 3:               use the month of (date - 3 days) instead date_min = March 2, 2023 (Q1)   Day 2 â‰¤ 3 and March is not month 1 of Q1   â†’ month_min_pos = 3 - 1 = 2 (February)  date_max = March 25, 2023 (Q1)   Day 25 > 3   â†’ month_max_pos = 3 (March)  Result: month_min_pos=2, month_max_pos=3 â†’ still ambiguous (Feb or Mar) If month_min_pos = month_max_pos â†’ Reference month DETERMINED If month_min_pos < month_max_pos â†’ Still ambiguous, need more constraints If month_min_pos > month_max_pos â†’ Inconsistent (contradictory birthday data)"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-4-aggregate-to-upa-panel-level","dir":"Articles","previous_headings":"How the Algorithm Works: Detailed Explanation","what":"Step 4: Aggregate to UPA-Panel Level","title":"Getting Started with mensalizePNADC","text":"Goal: Combine constraints household members interviewed together. Key insight: people UPA + V1014 (panel) interviewed together reference month. individual constraints respect month must satisfied simultaneously. aggregation: works: Taking maximum minimums minimum maximums gives us intersection individual constraint windows. Detailed Example: constraints inconsistent?","code":"upa_month_min = MAX of all individual month_min_pos upa_month_max = MIN of all individual month_max_pos Household (UPA=123456, V1014=1) has 3 members:  Person A: month_min=1, month_max=2 (could be Jan or Feb) Person B: month_min=1, month_max=3 (could be Jan, Feb, or Mar) Person C: month_min=2, month_max=3 (could be Feb or Mar)  Aggregation:   upa_month_min = max(1, 1, 2) = 2   upa_month_max = min(2, 3, 3) = 2  Result: min=2, max=2 â†’ Reference month is FEBRUARY!  Visual representation:               Jan    Feb    Mar Person A:     [======] Person B:     [=============] Person C:            [========] Intersection:        [==]      â† Only February satisfies all constraints Person A: month_min=1, month_max=1 (must be Jan) Person B: month_min=3, month_max=3 (must be Mar)  upa_month_min = max(1, 3) = 3 upa_month_max = min(1, 3) = 1  Result: min=3 > max=1 â†’ INCONSISTENT!  This is rare and usually indicates data quality issues. These observations remain indeterminate (ref_month_in_quarter = NA)."},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-5-cross-quarter-aggregation-the-key-innovation","dir":"Articles","previous_headings":"How the Algorithm Works: Detailed Explanation","what":"Step 5: Cross-Quarter Aggregation (The Key Innovation)","title":"Getting Started with mensalizePNADC","text":"Goal: Leverage PNADCâ€™s rotating panel design combine constraints across quarters. PNADC Panel Structure: PNADC uses rotating panel household (UPA + V1014) interviewed 5 consecutive quarters. Crucially, household always interviewed relative month position within quarter across visits (always month 1, always month 2, always month 3). aggregation logic: Since relative month position constant across quarters, constraints quarter apply quarters UPA-V1014: Detailed Example: powerful: household ambiguous Q1 (month 1 2) might birthday Q3 conclusively determines month 2. determination propagates back Q1! always stack multiple quarters calling mensalizePNADC()!","code":"UPA=123456, V1014=1 interview schedule:   2023-Q1: Month 1 of the quarter â†’ January   2023-Q2: Month 1 of the quarter â†’ April   2023-Q3: Month 1 of the quarter â†’ July   2023-Q4: Month 1 of the quarter â†’ October   2024-Q1: Month 1 of the quarter â†’ January            [Then rotates out] For each (UPA, V1014) group across ALL quarters:   upa_month_min = MAX of all month_min_pos from all quarters   upa_month_max = MIN of all month_max_pos from all quarters UPA=123456, V1014=1 appears in 5 quarters:    2023-Q1: month_min=1, month_max=2 (ambiguous: Jan or Feb)   2023-Q2: month_min=1, month_max=3 (ambiguous: Apr, May, or Jun)   2023-Q3: month_min=2, month_max=2 (DETERMINED: Aug, i.e., month 2)   2023-Q4: month_min=1, month_max=2 (ambiguous: Oct or Nov)   2024-Q1: month_min=2, month_max=3 (ambiguous: Feb or Mar)  Cross-quarter aggregation:   upa_month_min = max(1, 1, 2, 1, 2) = 2   upa_month_max = min(2, 3, 2, 2, 3) = 2  Result: ALL 5 quarters get ref_month_in_quarter = 2  This means:   2023-Q1 â†’ February   2023-Q2 â†’ May   2023-Q3 â†’ August   2023-Q4 â†’ November   2024-Q1 â†’ February â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ IMPACT ON DETERMINATION RATE:                                      â”‚ â”‚                                                                     â”‚ â”‚   Per-quarter processing (each quarter alone):    ~65-75%          â”‚ â”‚   Stacked multi-quarter (cross-quarter):          ~95.83%          â”‚ â”‚                                                                     â”‚ â”‚   Improvement: +25-30 percentage points!                            â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-6-handle-exception-quarters","dir":"Articles","previous_headings":"How the Algorithm Works: Detailed Explanation","what":"Step 6: Handle Exception Quarters","title":"Getting Started with mensalizePNADC","text":"Goal: Apply relaxed rules quarters IBGE used non-standard scheduling. Background: quarters, IBGEâ€™s technical breaks crossed month boundaries unusual ways. standard rule (â‰¥4 days) may produce impossible results quarters. Exception quarters: Relaxed rule: observations still indeterminate Step 5 exception quarters, algorithm: Recalculates first valid Saturdays min_days = 3 (instead 4) Recalculates date ranges applies birthday constraints Recalculates month positions adjusted boundary handling (day â‰¤ 2 instead â‰¤ 3) Re-aggregates UPA-Panel level now determined, uses result; otherwise remains NA Example: 2016t3, Saturday falls day 3 month skipped standard rule (3 < 4) accepted exception rule (3 â‰¥ 3).","code":"get_exception_quarters() # [1] \"2016t3\" \"2016t4\" \"2017t2\" \"2022t3\" \"2023t2\""},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"summary-what-makes-observations-indeterminate","dir":"Articles","previous_headings":"How the Algorithm Works: Detailed Explanation","what":"Summary: What Makes Observations Indeterminate?","title":"Getting Started with mensalizePNADC","text":"6 steps, approximately 4.2% observations remain indeterminate (ref_month_in_quarter = NA). Common reasons: Handling indeterminate observations: Exclude: Remove monthly analysis Quarterly fallback: Use original quarterly weights observations Proportional distribution: Distribute 1/3 three months","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"computing-monthly-weights","dir":"Articles","previous_headings":"","what":"Computing Monthly Weights","title":"Getting Started with mensalizePNADC","text":"monthly aggregate estimates (e.g., monthly employment counts), need monthly-appropriate survey weights.","code":""},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"how-weight-calibration-works","dir":"Articles","previous_headings":"Computing Monthly Weights","what":"How Weight Calibration Works","title":"Getting Started with mensalizePNADC","text":"compute_weights = TRUE, package: SIDRA provides moving-quarter estimates Package transforms exact monthly values Boundary months extrapolated via quadratic regression celula1: Age groups (0-13, 14-29, 30-59, 60+) celula2: Post-stratum group + age celula3: State (UF) + celula2 celula4: Post-stratum (posest) + celula2 Calibrates monthly population totals weight_monthly output calibrated match IBGEâ€™s official monthly population estimates (~206 million average).","code":"# Load full data with all required variables pnadc_full <- fread(\"pnadc_stacked_full.csv\")  # Run mensalization with weight computation # (automatically fetches population from SIDRA API) result <- mensalizePNADC(pnadc_full,   compute_weights = TRUE,   verbose = TRUE) # Step 1/4: Identifying reference months... #   Determination rate: 95.8% # Step 2/4: Fetching monthly population from SIDRA... # Step 3/4: Calibrating monthly weights (rake weighting)... # Step 4/4: Smoothing monthly aggregates...  # Use weight_monthly for monthly estimates monthly_pop <- result[, .(   population = sum(weight_monthly, na.rm = TRUE) ), by = ref_month_yyyymm]"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"topic-specific-calibration-coming-soon","dir":"Articles","previous_headings":"","what":"Topic-Specific Calibration (Coming Soon)","title":"Getting Started with mensalizePNADC","text":"future version include calibrate_to_sidra() theme-specific Bayesian calibration exactly match IBGEâ€™s published SIDRA series specific indicators.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"how-it-will-work","dir":"Articles","previous_headings":"Topic-Specific Calibration (Coming Soon)","what":"How It Will Work","title":"Getting Started with mensalizePNADC","text":"base weight_monthly provides general-purpose monthly weights calibrated population totals. However, different labor market indicators (unemployment rate, employment level, income) may require slightly different weight adjustments exactly match IBGEâ€™s official published series. calibrate_to_sidra() function : Fetch target series SIDRA (e.g., unemployment rate, employment levels) Apply Bayesian adjustment weights aggregated estimates match official series Return theme-specific weights (e.g., weight_sidra_unemployment) Planned themes:","code":""},{"path":[]},{"path":[]},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"using-modular-functions","dir":"Articles","previous_headings":"","what":"Using Modular Functions","title":"Getting Started with mensalizePNADC","text":"control, use individual functions:","code":"# Step 1: Just identify reference months months <- identify_reference_month(pnadc)  # Step 2: Check determination rate by quarter months[, .(   total = .N,   determined = sum(!is.na(ref_month_in_quarter)),   rate = round(mean(!is.na(ref_month_in_quarter)) * 100, 1) ), by = .(Ano, Trimestre)]  # Step 3: Validate input data validation <- validate_pnadc(pnadc, stop_on_error = FALSE)  # Step 4: Fetch population data manually pop_data <- fetch_monthly_population(verbose = TRUE)  # Step 5: Calibrate weights separately calibrated <- calibrate_monthly_weights(merged_data, pop_data)"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"performance","dir":"Articles","previous_headings":"","what":"Performance","title":"Getting Started with mensalizePNADC","text":"package optimized large datasets: Tips best performance: Use data.table directly (automatic conversion data.frame adds overhead) Load required columns reading data Process multiple years together (cross-quarter aggregation improves accuracy)","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"tips-and-best-practices","dir":"Articles","previous_headings":"","what":"Tips and Best Practices","title":"Getting Started with mensalizePNADC","text":"Process multiple quarters together: algorithm benefits cross-quarter aggregation. Processing 2012-2025 together gives ~96% determination vs ~70% per-quarter. Start reference month identification: donâ€™t always need monthly weights. Often just knowing reference month enough. Check determination rates year: Rates 96-99% 2013-2019. Lower rates may indicate data issues. Handle indeterminate observations: Decide whether exclude use quarterly-level analysis cases. Use weight_monthly general analysis: rake-weighted output appropriate purposes.","code":"crosswalk[, .(rate = mean(!is.na(ref_month_in_quarter))), by = .(Ano, Trimestre)]"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"further-reading","dir":"Articles","previous_headings":"","what":"Further Reading","title":"Getting Started with mensalizePNADC","text":"IBGE PNADC Documentation Package function reference: ?mensalizePNADC, ?identify_reference_month Source code: GitHub repository","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Marcos Hecksher. Author, maintainer. Rogerio Barbosa. Author. Claude AI. Contributor.           R package implementation","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hecksher M, Barbosa R (2026). mensalizePNADC: Convert Quarterly PNADC Survey Data Monthly Time Series. R package version 0.1.0, https://antrologos.github.io/mensalizePNADC/.","code":"@Manual{,   title = {mensalizePNADC: Convert Quarterly PNADC Survey Data to Monthly Time Series},   author = {Marcos Hecksher and Rogerio Barbosa},   year = {2026},   note = {R package version 0.1.0},   url = {https://antrologos.github.io/mensalizePNADC/}, }"},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"mensalizepnadc","dir":"","previous_headings":"","what":"Convert Quarterly PNADC Survey Data to Monthly Time Series","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"Convert Brazilâ€™s quarterly PNADC survey data monthly time series. ğŸ“– Full Documentation â€” Detailed algorithm explanation examples diagrams","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"mensalizePNADC package identifies reference months Brazilâ€™s quarterly PNADC (Pesquisa Nacional por Amostra de Domicilios Continua) survey data optionally computes monthly survey weights. enables monthly (instead quarterly) labor market analysis using PNADC microdata. Key Features: High accuracy: 95.83% determination rate 28.4 million observations (2012-2025) Fast processing: 6.3 minutes 28.4 million rows (basic mode), 8.1 minutes weight calibration Minimal dependencies: Requires data.table checkmate; sidrar needed weight calibration Flexible output: Returns crosswalk easy joins original data","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"","code":"# Install from GitHub devtools::install_github(\"antrologos/mensalizePNADC\")"},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick Start","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"","code":"library(mensalizePNADC) library(data.table)  # Load stacked quarterly PNADC data (minimum required columns) pnadc <- fread(\"pnadc_stacked.csv\",   select = c(\"Ano\", \"Trimestre\", \"UPA\", \"V1008\", \"V1014\", \"V2003\",              \"V2008\", \"V20081\", \"V20082\", \"V2009\"))  # Get reference month crosswalk crosswalk <- mensalizePNADC(pnadc) # Step 1/1: Identifying reference months... #   Determination rate: 95.8%  # Join with original data result <- merge(original_data, crosswalk,   by = c(\"Ano\", \"Trimestre\", \"UPA\", \"V1008\", \"V1014\", \"V2003\"))  # Now use ref_month_yyyymm for monthly analysis result[, .(n = .N), by = ref_month_yyyymm]"},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"important-use-stacked-data-for-best-results","dir":"","previous_headings":"","what":"Important: Use Stacked Data for Best Results","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"mensalization algorithm achieves 95.83% determination rate processing stacked multi-quarter data. process quarters individually, â€™ll get ~65-75% determination. design: PNADC uses rotating panel households interviewed relative month position quarter (always month 1, always month 2, always month 3). algorithm combines birthday constraints quarters narrow month household belongs . Recommended: Stack least 2 years quarterly data calling mensalizePNADC().","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"how-reference-month-identification-works","dir":"","previous_headings":"","what":"How Reference Month Identification Works","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"PNADC collected quarterly, interview actually corresponds specific reference week within quarter. package identifies three months quarter observation belongs .","code":""},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"step-1-determine-valid-interview-saturdays","dir":"","previous_headings":"How Reference Month Identification Works > Step-by-Step Algorithm","what":"Step 1: Determine Valid Interview Saturdays","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"IBGEâ€™s â€œParada Tecnicaâ€ (technical break) rules define interviews can occur. reference week ends Saturday, Saturday must least 4 days within reference month. month quarter, algorithm finds first valid Saturday: possible interview date range quarter spans first Saturday month 1 (first Saturday month 3 + 21 days).","code":"Example for Q1 2023: - January 2023: First Saturday is Jan 7 (has 7 days in Jan) -> Valid - February 2023: First Saturday is Feb 4 (has 4 days in Feb) -> Valid - March 2023: First Saturday is Mar 4 (has 4 days in Mar) -> Valid"},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"step-2-apply-birthday-constraints","dir":"","previous_headings":"How Reference Month Identification Works > Step-by-Step Algorithm","what":"Step 2: Apply Birthday Constraints","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"respondentâ€™s reported age birthdate constrains interview occurred: Age = Year - BirthYear (visit birthday): interview must first Saturday following birthday Age = Year - BirthYear - 1 (visit birthday): interview must birthday person, narrows possible interview date window.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"step-3-convert-date-ranges-to-month-positions","dir":"","previous_headings":"How Reference Month Identification Works > Step-by-Step Algorithm","what":"Step 3: Convert Date Ranges to Month Positions","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"narrowed date range converted month--quarter positions (1, 2, 3): minimum possible date falls month 2, month_min_pos = 2 maximum possible date falls month 1, month_max_pos = 1 Special handling dates near month boundaries (within first 3 days)","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"step-4-aggregate-to-upa-panel-level","dir":"","previous_headings":"How Reference Month Identification Works > Step-by-Step Algorithm","what":"Step 4: Aggregate to UPA-Panel Level","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"individuals UPA + Panel (V1014) interviewed together reference month. algorithm takes intersection individual constraints within UPA-Panel group: upa_month_min == upa_month_max, reference month uniquely determined.","code":"upa_month_min = max(individual month_min positions) upa_month_max = min(individual month_max positions)"},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"step-5-cross-quarter-aggregation-key-innovation","dir":"","previous_headings":"How Reference Month Identification Works > Step-by-Step Algorithm","what":"Step 5: Cross-Quarter Aggregation (Key Innovation)","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"PNADC rotating panel: UPA-V1014 interviewed relative month position (always month 1, always month 2, always month 3) across quarterly visits (5 consecutive quarters). algorithm aggregates constraints across quarters UPA-V1014, just within single quarter. dramatically improves determination rates: Per-quarter: uses birthday constraints quarter (~70% determination) Cross-quarter: Combines constraints visits (~96% determination)","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"step-6-handle-exception-quarters","dir":"","previous_headings":"How Reference Month Identification Works > Step-by-Step Algorithm","what":"Step 6: Handle Exception Quarters","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"quarters non-standard timing rules (technical breaks cross month boundaries). quarters 2016t3, 2016t4, 2017t2, 2022t3, 2023t2, relaxed rule (minimum 3 days instead 4) applied standard rule fails determine month.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"how-monthly-weight-calibration-works","dir":"","previous_headings":"","what":"How Monthly Weight Calibration Works","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"compute_weights = TRUE, package computes monthly survey weights sum IBGEâ€™s official monthly population estimates.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"step-1-fetch-monthly-population-from-sidra-api","dir":"","previous_headings":"How Monthly Weight Calibration Works","what":"Step 1: Fetch Monthly Population from SIDRA API","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"function automatically downloads population estimates IBGEâ€™s SIDRA API (table 6022). Challenge: SIDRA provides moving-quarter population estimates, exact monthly values. SIDRA value represents 3-month average centered middle month: Transformation: function shifts values align center month: - m_populacao[Feb 2012] = SIDRA value code 201203 Boundary Extrapolation: first month (Jan 2012) latest month centered moving quarter. extrapolated using quadratic regression population differences nearest 25 observations.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"step-2-hierarchical-rake-weighting","dir":"","previous_headings":"How Monthly Weight Calibration Works","what":"Step 2: Hierarchical Rake Weighting","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"original quarterly weights (V1028) redistributed months using iterative proportional fitting (rake weighting) across nested calibration cells: level, weights adjusted : preserves quarterly totals redistributing months proportionally.","code":"sum(weight_new) by (cell, month) / sum(weight_old) by (cell, month)   = sum(V1028) by (cell, quarter) / sum(weight_old) by (cell, month)"},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"step-3-final-calibration-to-population-totals","dir":"","previous_headings":"How Monthly Weight Calibration Works","what":"Step 3: Final Calibration to Population Totals","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"hierarchical reweighting, final scaling ensures monthly weighted totals match SIDRA population: output weight_monthly calibrated match IBGEâ€™s official monthly population estimates.","code":"weight_final = weight_calibrated * (SIDRA_population / sum(weight_calibrated))"},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"required-input-variables","dir":"","previous_headings":"","what":"Required Input Variables","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"Minimum (reference month identification ): Additional (compute_weights = TRUE):","code":""},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"performance-results","dir":"","previous_headings":"","what":"Performance Results","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"Tested 55 quarters (2012Q1 - 2025Q3) 28,395,273 total observations:","code":""},{"path":[]},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"overall-statistics","dir":"","previous_headings":"Performance Results","what":"Overall Statistics","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"Total observations: 28,395,273 Determined: 27,211,667 (95.83%) determined: 1,183,606 (4.17%)","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"monthly-weights","dir":"","previous_headings":"","what":"Monthly Weights","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"monthly aggregate estimates, compute monthly-appropriate survey weights: weight_monthly output calibrated match IBGEâ€™s official monthly population estimates SIDRA table 6022. Average monthly population: ~206 million (matching Brazilâ€™s population).","code":"result <- mensalizePNADC(pnadc_full,   compute_weights = TRUE)  # Use weight_monthly for estimates result[, .(pop = sum(weight_monthly)), by = ref_month_yyyymm]"},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"topic-specific-calibration-coming-soon","dir":"","previous_headings":"","what":"Topic-Specific Calibration (Coming Soon)","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"future version include calibrate_to_sidra() theme-specific Bayesian calibration exactly match IBGEâ€™s published SIDRA series specific indicators.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"how-it-will-work","dir":"","previous_headings":"Topic-Specific Calibration (Coming Soon)","what":"How It Will Work","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"base weight_monthly mensalizePNADC() provides general-purpose monthly weights calibrated population totals. However, different labor market indicators (unemployment rate, employment level, income) may require slightly different weight adjustments exactly match IBGEâ€™s official published series. calibrate_to_sidra() function : Fetch target series SIDRA (e.g., unemployment rate, employment levels) Apply Bayesian adjustment weights aggregated estimates match official series Return theme-specific weights (e.g., weight_sidra_unemployment) Planned themes: separate main function? Different indicators require different calibrations. base weight_monthly self-consistent general-purpose, theme-specific weights optimized matching specific published series.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"authors","dir":"","previous_headings":"","what":"Authors","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"Marcos Hecksher - Original methodology Stata implementation Rogerio Barbosa - R package author","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"ğŸ“– Online Documentation â€” Full pkgdown website function reference vignettes ğŸ“– Getting Started Vignette â€” Detailed algorithm explanation diagrams examples installing, run vignette(\"getting-started\", package = \"mensalizePNADC\") rendered version","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"IBGE PNADC Documentation Hecksher, M. (2024). Mensalizacao da PNADC. Working paper.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"MIT","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_monthly_weights.html","id":null,"dir":"Reference","previous_headings":"","what":"Calibrate Monthly Weights â€” calibrate_monthly_weights","title":"Calibrate Monthly Weights â€” calibrate_monthly_weights","text":"original PNADC survey weights (V1028) designed quarterly estimates. function creates monthly weights : Grouping observations nested demographic/geographic cells Iteratively adjusting weights monthly totals match quarterly totals within cell Calibrating final weights external monthly population totals","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_monthly_weights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calibrate Monthly Weights â€” calibrate_monthly_weights","text":"","code":"calibrate_monthly_weights(data, monthly_totals, n_cells = 4L)"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_monthly_weights.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calibrate Monthly Weights â€” calibrate_monthly_weights","text":"data data.frame data.table PNADC microdata including reference month information (output identify_reference_month). Required columns include: Reference month columns: ref_month_yyyymm, ref_month_in_quarter Survey design: V1028, UF, posest, posest_sxi Demographics: V2009 (age) Time: Ano, Trimestre monthly_totals data.frame monthly population totals. Required columns: ref_month_yyyymm anomesexato: YYYYMM integer m_populacao: Monthly population thousands n_cells Integer. Number hierarchical cell levels use (1-4). Default 4 (full hierarchy). Lower values faster less precise.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_monthly_weights.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calibrate Monthly Weights â€” calibrate_monthly_weights","text":"data.table input data plus: weight_calibrated: Calibrated monthly weight celula1 celula4: Cell identifiers (computed)","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_monthly_weights.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calibrate Monthly Weights â€” calibrate_monthly_weights","text":"Redistributes quarterly survey weights monthly weights using hierarchical calibration across demographic geographic cells. hierarchical calibration cells : celula1 Age groups: 0-13, 14-29, 30-59, 60+ celula2 Post-stratum group + age group celula3 State (UF) + celula2 celula4 Post-stratum (posest) + celula2 level, weights adjusted : sum(weight_new) (cell, month) / sum(weight_old) (cell, month) equals sum(V1028) (cell, quarter) / sum(weight_old) (cell, month) preserves quarterly totals redistributing months.","code":""},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_monthly_weights.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calibrate Monthly Weights â€” calibrate_monthly_weights","text":"","code":"if (FALSE) { # \\dontrun{ # First identify reference months crosswalk <- identify_reference_month(pnadc_data) merged <- merge(pnadc_data, crosswalk, by = join_keys)  # Then calibrate weights result <- calibrate_monthly_weights(merged, monthly_pop) } # }"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_to_sidra.html","id":null,"dir":"Reference","previous_headings":"","what":"Calibrate Weights to IBGE SIDRA Series (Optional) â€” calibrate_to_sidra","title":"Calibrate Weights to IBGE SIDRA Series (Optional) â€” calibrate_to_sidra","text":"optional function users need estimates exactly match IBGE's official monthly series. core mensalizePNADC function already produces valid monthly weights; function provides additional calibration specific themes. Important: Different themes require different Bayesian calibrations. example, weights calibrated match unemployment rates differ weights calibrated match employment levels.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_to_sidra.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calibrate Weights to IBGE SIDRA Series (Optional) â€” calibrate_to_sidra","text":"","code":"calibrate_to_sidra(   data,   theme = c(\"unemployment\", \"employment\", \"labor_force\", \"income\", \"custom\"),   sidra_series = NULL,   verbose = TRUE )  adjust_weights_bayesian(data, monthly_targets, employment_detail = TRUE)"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_to_sidra.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calibrate Weights to IBGE SIDRA Series (Optional) â€” calibrate_to_sidra","text":"data data.table output mensalizePNADC compute_weights = TRUE. Must contain weight_monthly employment status variables (VD4001, VD4002, etc.). theme Character. IBGE series match: \"unemployment\" Taxa de desocupacao - unemployment rate \"employment\" Populacao ocupada - employment levels \"labor_force\" PEA/PNEA - labor force participation \"income\" Rendimento habitual - income aggregates \"custom\" User provides target series via sidra_series sidra_series Optional data.frame monthly target series. Required theme = \"custom\". Must contain: ref_month_yyyymm: Month YYYYMM format m_*: Target values indicator (thousands) verbose Logical. Print progress messages? Default TRUE.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_to_sidra.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calibrate Weights to IBGE SIDRA Series (Optional) â€” calibrate_to_sidra","text":"data.table input data plus: weight_sidra: Bayesian-adjusted weight matching SIDRA series original weight_monthly preserved comparison.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_to_sidra.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calibrate Weights to IBGE SIDRA Series (Optional) â€” calibrate_to_sidra","text":"Applies theme-specific Bayesian calibration aggregated estimates match IBGE's official SIDRA published series.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_to_sidra.html","id":"why-theme-specific-calibration-","dir":"Reference","previous_headings":"","what":"Why Theme-Specific Calibration?","title":"Calibrate Weights to IBGE SIDRA Series (Optional) â€” calibrate_to_sidra","text":"IBGE's published SIDRA series internally consistent use slightly different adjustments different indicators. means: Weights optimized unemployment rate may sum exactly published employment level Weights optimized employment may produce exact published unemployment rate Choose theme matches primary analysis focus.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_to_sidra.html","id":"algorithm","dir":"Reference","previous_headings":"","what":"Algorithm","title":"Calibrate Weights to IBGE SIDRA Series (Optional) â€” calibrate_to_sidra","text":"Uses Bayes' theorem adjust individual weights: $$P(status | category) = P(status) \\times P(category | status) / P(category)$$ : status = employment situation (employed, unemployed, etc.) category = demographic/geographic cell P(status) derived SIDRA targets","code":""},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_to_sidra.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calibrate Weights to IBGE SIDRA Series (Optional) â€” calibrate_to_sidra","text":"","code":"if (FALSE) { # \\dontrun{ # First, get base weights crosswalk <- mensalizePNADC(pnadc_full, compute_weights = TRUE,                              monthly_totals = monthly_pop)  # Then, calibrate for unemployment analysis unemployment_data <- calibrate_to_sidra(crosswalk, theme = \"unemployment\")  # Calculate unemployment rate (will match IBGE SIDRA exactly) unemployment_data[, .(   rate = sum(weight_sidra * (VD4002 == 2)) /          sum(weight_sidra * (VD4001 == 1)) * 100 ), by = ref_month_yyyymm] } # }"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/compute_labor_indicators.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Labor Force Indicators â€” compute_labor_indicators","title":"Compute Labor Force Indicators â€” compute_labor_indicators","text":"Computes employment rates, unemployment rates, labor market indicators using survey weights. Can compute indicators grouping variable (typically month).","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/compute_labor_indicators.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Labor Force Indicators â€” compute_labor_indicators","text":"","code":"compute_labor_indicators(   data,   weight_var = \"weight_monthly\",   by = \"ref_month_yyyymm\",   indicators = \"all\" )"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/compute_labor_indicators.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Labor Force Indicators â€” compute_labor_indicators","text":"data data.frame data.table PNADC microdata weights. Required columns depend indicators requested. weight_var Character. Name weight variable use. Default \"weight_monthly\". Character vector grouping variables. Default \"ref_month_yyyymm\" monthly indicators. indicators Character vector indicators compute. Options: \"population\": Total population, age 14+, labor force, etc. \"employment\": Employment type (formal, informal, etc.) \"sector\": Employment economic sector \"rates\": Unemployment rate, participation rate, etc \"income\": Income aggregates averages \"\": indicators (default)","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/compute_labor_indicators.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Labor Force Indicators â€” compute_labor_indicators","text":"data.table requested indicators aggregated grouping variables.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/compute_labor_indicators.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Labor Force Indicators â€” compute_labor_indicators","text":"Calculates standard PNADC labor force indicators weighted microdata. Population indicators: pop_total: Total population pop_14plus: Population age 14+ pop_employed: Employed persons pop_unemployed: Unemployed persons pop_labor_force: Labor force (employed + unemployed) pop_out_of_lf: labor force Rate indicators: rate_participation: Labor force / pop 14+ (%) rate_employment: Employed / pop 14+ (%) rate_unemployment: Unemployed / labor force (%)","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/compute_labor_indicators.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Labor Force Indicators â€” compute_labor_indicators","text":"","code":"if (FALSE) { # \\dontrun{ # Monthly indicators indicators <- compute_labor_indicators(weighted_data)  # Indicators by state by_state <- compute_labor_indicators(weighted_data, by = c(\"ref_month_yyyymm\", \"UF\")) } # }"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/fetch-sidra-population.html","id":null,"dir":"Reference","previous_headings":"","what":"Fetch Monthly Population from SIDRA â€” fetch-sidra-population","title":"Fetch Monthly Population from SIDRA â€” fetch-sidra-population","text":"Functions download transform IBGE's population estimates SIDRA API use monthly weight calibration.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/fetch_monthly_population.html","id":null,"dir":"Reference","previous_headings":"","what":"Fetch Monthly Population from SIDRA â€” fetch_monthly_population","title":"Fetch Monthly Population from SIDRA â€” fetch_monthly_population","text":"Downloads population estimates IBGE SIDRA API (table 6022) transforms moving-quarter exact monthly values.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/fetch_monthly_population.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fetch Monthly Population from SIDRA â€” fetch_monthly_population","text":"","code":"fetch_monthly_population(   start_yyyymm = NULL,   end_yyyymm = NULL,   verbose = TRUE )"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/fetch_monthly_population.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fetch Monthly Population from SIDRA â€” fetch_monthly_population","text":"start_yyyymm Integer. First month include (YYYYMM format). NULL, returns available months. end_yyyymm Integer. Last month include (YYYYMM format). NULL, returns available months. verbose Logical. Print progress messages? Default TRUE.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/fetch_monthly_population.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fetch Monthly Population from SIDRA â€” fetch_monthly_population","text":"data.table columns: ref_month_yyyymm: Integer YYYYMM format m_populacao: Monthly population thousands","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/fetch_monthly_population.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fetch Monthly Population from SIDRA â€” fetch_monthly_population","text":"SIDRA table 6022 provides moving-quarter population estimates. value represents 3-month average centered middle month. example, value code 201203 (quarter ending March 2012) represents population February 2012. function: Fetches raw moving-quarter data SIDRA Transforms exact monthly values aligning middle months Extrapolates boundary months (first last) using quadratic regression extrapolation follows methodology Hecksher (2024), using quadratic regression population differences estimate first month (Jan 2012) recent month.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/fetch_monthly_population.html","id":"dependencies","dir":"Reference","previous_headings":"","what":"Dependencies","title":"Fetch Monthly Population from SIDRA â€” fetch_monthly_population","text":"function requires sidrar package API access. Install : install.packages(\"sidrar\")","code":""},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/reference/fetch_monthly_population.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fetch Monthly Population from SIDRA â€” fetch_monthly_population","text":"","code":"if (FALSE) { # \\dontrun{ # Fetch all available months pop <- fetch_monthly_population()  # Fetch specific date range pop <- fetch_monthly_population(201301, 201912) } # }"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/get_exception_quarters.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Exception Quarters â€” get_exception_quarters","title":"Get Exception Quarters â€” get_exception_quarters","text":"Returns list quarters IBGE used non-standard technical break timing. quarters, first reference week month needs 3 days (instead usual 4) within month.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/get_exception_quarters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Exception Quarters â€” get_exception_quarters","text":"","code":"get_exception_quarters()"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/get_exception_quarters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Exception Quarters â€” get_exception_quarters","text":"Character vector exception quarters \"YYYYtQ\" format","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/get_exception_quarters.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get Exception Quarters â€” get_exception_quarters","text":"exception quarters documented IBGE's methodology notes: 2016t3: September 25 - October 1 technical break 2016t4: December 25-31 technical break 2017t2: June 25 - July 1 technical break 2022t3: September 25 - October 1 technical break 2023t2: June 25 - July 1 technical break","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/get_exception_quarters.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Exception Quarters â€” get_exception_quarters","text":"","code":"get_exception_quarters() #> [1] \"2016t3\" \"2016t4\" \"2017t2\" \"2022t3\" \"2023t2\" # [1] \"2016t3\" \"2016t4\" \"2017t2\" \"2022t3\" \"2023t2\""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/identify_reference_month.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify Reference Month in PNADC Data â€” identify_reference_month","title":"Identify Reference Month in PNADC Data â€” identify_reference_month","text":"PNADC quarterly survey, interview actually refers specific week within quarter. function identifies month week belongs , enabling monthly (instead quarterly) time series analysis. algorithm uses: IBGE's reference week timing rules (first Saturday sufficient days month) Respondent birthdates constrain possible interview dates UPA-panel level aggregation (everyone sampling unit interviewed together)","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/identify_reference_month.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify Reference Month in PNADC Data â€” identify_reference_month","text":"","code":"identify_reference_month(data, exception_quarters = NULL)"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/identify_reference_month.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify Reference Month in PNADC Data â€” identify_reference_month","text":"data data.frame data.table PNADC microdata. Required columns: Ano: Survey year Trimestre: Quarter (1-4) UPA: Primary Sampling Unit V1014: Panel identifier V2008: Birth day (1-31) V20081: Birth month (1-12) V20082: Birth year V2009: Age Optional recommended complete crosswalk: V1008: Household sequence within UPA V2003: Person sequence within household exception_quarters Character vector quarters relaxed timing rules, format \"YYYYtQ\" (e.g., \"2016t3\"). NULL (default), uses built-list known exceptions: 2016t3, 2016t4, 2017t2, 2022t3, 2023t2.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/identify_reference_month.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify Reference Month in PNADC Data â€” identify_reference_month","text":"data.table original key columns plus: ref_month: Reference month Date (first day month, e.g., \"2023-01-01\") ref_month_in_quarter: Position quarter (1, 2, 3) NA indeterminate ref_month_yyyymm: Integer YYYYMM format (e.g., 202301)","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/identify_reference_month.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Identify Reference Month in PNADC Data â€” identify_reference_month","text":"Determines month within quarter corresponds survey observation based IBGE's \"Parada Tecnica\" (technical break) rules. determination rate (proportion observations identified reference month) typically 85-90%. Observations determined marked NA. function processes data following steps: Calculate first valid interview Saturday month quarter person, calculate possible interview date range based birthday constraints Convert date ranges month--quarter positions Aggregate UPA-panel level (persons must agree) Handle exception quarters relaxed timing rules","code":""},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/reference/identify_reference_month.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identify Reference Month in PNADC Data â€” identify_reference_month","text":"","code":"if (FALSE) { # \\dontrun{ # Identify reference months result <- identify_reference_month(pnadc_data)  # Check determination rate result[, .(   total = .N,   determined = sum(!is.na(ref_month_in_quarter)),   rate = mean(!is.na(ref_month_in_quarter)) ), by = .(Ano, Trimestre)] } # }"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC-package.html","id":null,"dir":"Reference","previous_headings":"","what":"mensalizePNADC: Convert Quarterly PNADC Survey Data to Monthly Time Series â€” mensalizePNADC-package","title":"mensalizePNADC: Convert Quarterly PNADC Survey Data to Monthly Time Series â€” mensalizePNADC-package","text":"mensalizePNADC package provides tools convert Brazil's quarterly PNADC (Pesquisa Nacional por Amostra de Domicilios Continua) survey data monthly time series. package offers two main capabilities: Reference month identification: Determines month within quarter survey observation refers , using IBGE's \"Parada Tecnica\" rules respondent birthdates Monthly weight computation: Adjusts survey weights monthly (instead quarterly) estimates using hierarchical calibration Bayesian methods","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC-package.html","id":"main-functions","dir":"Reference","previous_headings":"","what":"Main Functions","title":"mensalizePNADC: Convert Quarterly PNADC Survey Data to Monthly Time Series â€” mensalizePNADC-package","text":"mensalizePNADC Main function processes stacked quarterly PNADC data returns crosswalk joining original data identify_reference_month Identifies month observation refers (core algorithm) calibrate_monthly_weights Redistributes quarterly weights monthly using hierarchical calibration smooth_monthly_aggregates Removes quarterly artifacts monthly series adjust_weights_bayesian Final Bayesian weight adjustment compute_labor_indicators Computes standard labor force indicators weighted data","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC-package.html","id":"utility-functions","dir":"Reference","previous_headings":"","what":"Utility Functions","title":"mensalizePNADC: Convert Quarterly PNADC Survey Data to Monthly Time Series â€” mensalizePNADC-package","text":"validate_pnadc Validates input data required columns get_exception_quarters Returns quarters non-standard IBGE timing rules","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC-package.html","id":"background","dir":"Reference","previous_headings":"","what":"Background","title":"mensalizePNADC: Convert Quarterly PNADC Survey Data to Monthly Time Series â€” mensalizePNADC-package","text":"PNADC quarterly household survey conducted IBGE (Brazilian Institute Geography Statistics) provides labor market demographic information. survey published quarterly, interview actually refers specific week within quarter. package implements methodology developed Marcos Hecksher identify reference months compute monthly-appropriate survey weights, enabling monthly time series analysis PNADC data.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC-package.html","id":"methodology","dir":"Reference","previous_headings":"","what":"Methodology","title":"mensalizePNADC: Convert Quarterly PNADC Survey Data to Monthly Time Series â€” mensalizePNADC-package","text":"reference month identification algorithm uses: IBGE's reference week timing rules (\"Parada Tecnica\") Respondent birthdates constrain possible interview dates UPA-panel level aggregation (everyone interviewed together) monthly weight computation uses: Hierarchical calibration across demographic/geographic cells Moving average smoothing remove quarterly artifacts Bayesian posterior adjustment match employment targets","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"mensalizePNADC: Convert Quarterly PNADC Survey Data to Monthly Time Series â€” mensalizePNADC-package","text":"IBGE Manual Basico da Entrevista PNADC (methodology \"Parada Tecnica\")","code":""},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"mensalizePNADC: Convert Quarterly PNADC Survey Data to Monthly Time Series â€” mensalizePNADC-package","text":"Marcos Hecksher mdhecksher@gmail.com","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC.html","id":null,"dir":"Reference","previous_headings":"","what":"Mensalize PNADC Quarterly Survey Data â€” mensalizePNADC","title":"Mensalize PNADC Quarterly Survey Data â€” mensalizePNADC","text":"function processes stacked quarterly PNADC microdata : Identify month within quarter observation refers Optionally compute monthly survey weights (compute_weights = TRUE) output crosswalk table can joined original (unstacked) PNADC data files add monthly time information.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mensalize PNADC Quarterly Survey Data â€” mensalizePNADC","text":"","code":"mensalizePNADC(   data,   compute_weights = FALSE,   output = c(\"crosswalk\", \"microdata\", \"aggregates\"),   verbose = TRUE )"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mensalize PNADC Quarterly Survey Data â€” mensalizePNADC","text":"data data.frame data.table stacked quarterly PNADC microdata. reference month identification (compute_weights = FALSE), minimum required columns : Ano, Trimestre: Year quarter UPA, V1014: Primary sampling unit panel V2008, V20081, V20082: Birth day, month, year V2009: Age monthly weight computation (compute_weights = TRUE), additional columns required. See Details. compute_weights Logical. TRUE, compute monthly survey weights addition identifying reference months. Default FALSE. Requires sidrar package fetch population data IBGE SIDRA API. output Character. return: \"crosswalk\" (default): Minimal crosswalk joining \"microdata\": Full microdata computed columns \"aggregates\": Monthly aggregated indicators verbose Logical. Print progress messages? Default TRUE.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mensalize PNADC Quarterly Survey Data â€” mensalizePNADC","text":"Depends output parameter: output = \"crosswalk\" (default): data.table join keys new time variables: Join keys: Ano, Trimestre, UPA, V1008, V1014, V2003 ref_month: Reference month Date ref_month_in_quarter: Position quarter (1, 2, 3) NA ref_month_yyyymm: Integer YYYYMM format weight_monthly: Monthly weight (compute_weights = TRUE) output = \"microdata\": Full input data computed columns added. output = \"aggregates\": Monthly aggregated indicators.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Mensalize PNADC Quarterly Survey Data â€” mensalizePNADC","text":"Main function convert quarterly PNADC survey data monthly time series. Returns crosswalk data.frame joining original data, adding reference month information optionally monthly survey weights.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC.html","id":"reference-month-identification","dir":"Reference","previous_headings":"","what":"Reference Month Identification","title":"Mensalize PNADC Quarterly Survey Data â€” mensalizePNADC","text":"algorithm determines month survey response refers based : IBGE's \"Parada Tecnica\" rules reference week timing Respondent birthdates (constrains possible interview dates) UPA-panel grouping (everyone interviewed together) Typically 85-90% observations can assigned definite reference month.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC.html","id":"monthly-weight-computation","dir":"Reference","previous_headings":"","what":"Monthly Weight Computation","title":"Mensalize PNADC Quarterly Survey Data â€” mensalizePNADC","text":"compute_weights = TRUE, function: Fetches monthly population IBGE SIDRA API (table 6022) Redistributes quarterly weights months using hierarchical rake weighting Smooths monthly aggregates remove quarterly artifacts resulting weight_monthly final weight general-purpose monthly analysis. Bayesian adjustment applied. theme-specific calibration match IBGE SIDRA series (e.g., unemployment rate, employment levels), use calibrate_to_sidra separately. Additional required columns weight computation: Survey design: V1028, V1008, V2003, UF, posest, posest_sxi","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC.html","id":"dependencies","dir":"Reference","previous_headings":"","what":"Dependencies","title":"Mensalize PNADC Quarterly Survey Data â€” mensalizePNADC","text":"compute_weights = TRUE, sidrar package required fetch population data. Install : install.packages(\"sidrar\")","code":""},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mensalize PNADC Quarterly Survey Data â€” mensalizePNADC","text":"","code":"if (FALSE) { # \\dontrun{ # Basic usage: identify reference months only library(mensalizePNADC)  # Load stacked quarterly data (minimum columns) pnadc <- data.table::fread(\"pnadc_stacked.csv\",   select = c(\"Ano\", \"Trimestre\", \"UPA\", \"V1008\", \"V1014\", \"V2003\",              \"V2008\", \"V20081\", \"V20082\", \"V2009\"))  # Get crosswalk crosswalk <- mensalizePNADC(pnadc)  # Join with original quarterly file original <- haven::read_dta(\"PNADC_2023T1.dta\") monthly <- dplyr::left_join(original, crosswalk,   by = c(\"Ano\", \"Trimestre\", \"UPA\", \"V1008\", \"V1014\", \"V2003\"))   # With monthly weights for general analysis # (requires sidrar package and internet connection) pnadc_full <- haven::read_dta(\"PNADCtrimestralempilhada.dta\")  result <- mensalizePNADC(pnadc_full, compute_weights = TRUE)  # Use weight_monthly for any monthly aggregate result[, .(pop = sum(weight_monthly)), by = ref_month_yyyymm] } # }"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/print.pnadc_crosswalk.html","id":null,"dir":"Reference","previous_headings":"","what":"Print Method for pnadc_crosswalk â€” print.pnadc_crosswalk","title":"Print Method for pnadc_crosswalk â€” print.pnadc_crosswalk","text":"Print Method pnadc_crosswalk","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/print.pnadc_crosswalk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print Method for pnadc_crosswalk â€” print.pnadc_crosswalk","text":"","code":"# S3 method for class 'pnadc_crosswalk' print(x, ...)"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/print.pnadc_crosswalk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print Method for pnadc_crosswalk â€” print.pnadc_crosswalk","text":"x pnadc_crosswalk object ... Additional arguments (ignored)","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/print.pnadc_crosswalk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print Method for pnadc_crosswalk â€” print.pnadc_crosswalk","text":"Invisibly returns x","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/smooth_monthly_aggregates.html","id":null,"dir":"Reference","previous_headings":"","what":"Smooth Monthly Aggregates â€” smooth_monthly_aggregates","title":"Smooth Monthly Aggregates â€” smooth_monthly_aggregates","text":"quarterly survey data converted monthly estimates, resulting time series often shows artificial quarterly patterns. function applies smoothing algorithm : Computes 3-month differences capture trends Stratifies month position within quarter (1st, 2nd, 3rd) Accumulates changes via cumulative sums Calibrates reference period Produces smooth monthly series preserve genuine variation","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/smooth_monthly_aggregates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smooth Monthly Aggregates â€” smooth_monthly_aggregates","text":"","code":"smooth_monthly_aggregates(   monthly_aggregates,   calibration_start = 201301L,   calibration_end = 201912L )"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/smooth_monthly_aggregates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Smooth Monthly Aggregates â€” smooth_monthly_aggregates","text":"monthly_aggregates data.table monthly aggregated indicators. Required columns: ref_month_yyyymm: Month identifier YYYYMM format z_*: Indicator columns monthly totals (e.g., z_popocup) calibration_start Integer YYYYMM. Start calibration period. Default 201301. calibration_end Integer YYYYMM. End calibration period. Default 201912.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/smooth_monthly_aggregates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Smooth Monthly Aggregates â€” smooth_monthly_aggregates","text":"data.table smoothed monthly estimates. input variable z_varname, output includes: m_varname: Smoothed monthly estimate","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/smooth_monthly_aggregates.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Smooth Monthly Aggregates â€” smooth_monthly_aggregates","text":"Applies moving average methodology remove quarterly artifacts monthly estimates derived quarterly survey data. smoothing algorithm works follows: indicator variable: Compute 3-month difference: d3 = 3 * (value[t] - value[t-1]) Split month position (1, 2, 3 within quarter) Compute cumulative sum within position Calculate residual intermediate series calibration period Apply position-specific adjustment Final smoothed value uses moving average quarterly reference","code":""},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/reference/utils-dates.html","id":null,"dir":"Reference","previous_headings":"","what":"Date Utility Functions â€” utils-dates","title":"Date Utility Functions â€” utils-dates","text":"Internal helper functions date calculations, designed match Stata's date handling conventions.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/utils-validation.html","id":null,"dir":"Reference","previous_headings":"","what":"Input Validation Utilities â€” utils-validation","title":"Input Validation Utilities â€” utils-validation","text":"Internal helper functions validating PNADC input data.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/validate_pnadc.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate PNADC Input Data â€” validate_pnadc","title":"Validate PNADC Input Data â€” validate_pnadc","text":"Checks input data required columns specified processing.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/validate_pnadc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate PNADC Input Data â€” validate_pnadc","text":"","code":"validate_pnadc(data, check_weights = FALSE, stop_on_error = TRUE)"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/validate_pnadc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate PNADC Input Data â€” validate_pnadc","text":"data data.frame data.table PNADC microdata check_weights Logical. TRUE, also check weight-related variables. stop_on_error Logical. TRUE, stops error. FALSE, returns validation report list.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/validate_pnadc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate PNADC Input Data â€” validate_pnadc","text":"stop_on_error TRUE, returns invisibly valid stops error. FALSE, returns list validation results.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/validate_pnadc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Validate PNADC Input Data â€” validate_pnadc","text":"","code":"if (FALSE) { # \\dontrun{ validate_pnadc(my_data) validate_pnadc(my_data, check_weights = TRUE) } # }"}]
