<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Applied Examples: Monthly vs Quarterly Labor Market Analysis • PNADCperiods</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Applied Examples: Monthly vs Quarterly Labor Market Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PNADCperiods</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/getting-started.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/download-and-prepare.html">Download and Prepare Data</a></li>
    <li><a class="dropdown-item" href="../articles/applied-examples.html">Applied Examples</a></li>
    <li><a class="dropdown-item" href="../articles/annual-poverty-analysis.html">Annual Poverty Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/complex-survey-design.html">Complex Survey Design</a></li>
    <li><a class="dropdown-item" href="../articles/how-it-works.html">How PNADCperiods Works</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/determination-rates-benchmark.html">Benchmark Report</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/antrologos/PNADCperiods/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Applied Examples: Monthly vs Quarterly Labor Market Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/antrologos/PNADCperiods/blob/HEAD/vignettes/applied-examples.Rmd" class="external-link"><code>vignettes/applied-examples.Rmd</code></a></small>
      <div class="d-none name"><code>applied-examples.Rmd</code></div>
    </div>

    
    
<!--
MAINTAINER NOTE:
The code chunks in this vignette must match the code in:
  mensalizacao_pnad/code/generate_vignette_data.R

Look for comments like "# VIGNETTE CODE: chunk-name" in that script.
To regenerate figures, run that script. Changes to code here
must be mirrored in the generation script (and vice versa).

Run code/check_vignette_sync.R to verify synchronization before release.
-->
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Brazil’s Continuous National Household Sample Survey (PNADC) is one
of the most important sources of labor market data in Latin America.
Regularly, IBGE (Brazil’s statistics agency) publishes the quarterly and
annual microdata used for the calculation of official labor market
statistics: unemployment rates, employment levels, and other key
indicators. However, what many users don’t realize is that these
<strong>quarterly (or annual) statistics are actually an average of
three-month phenomena</strong>. In the official IBGE website for
indicators extration (SIDRA) there is indeed monthly information.
However, these monthly series are not a snapshot of a particular month,
but instead a rolling average of all interviews conducted during three
months.</p>
<p>This averaging has three important consequences:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Timing errors</strong>: The quarterly peak of
unemployment may not coincide with the actual monthly peak. A crisis
that peaked in April might show up as a “Q2” phenomenon, obscuring when
the shock actually hit.</p></li>
<li><p><strong>Magnitude errors</strong>: The true size of a peak or
trough of a variable is diluted by averaging with adjacent months. If
unemployment spiked to 16% in one month but was 12% in the surrounding
months, the quarterly average would show something like
13-14%—understating the severity of the shock.</p></li>
<li><p><strong>Turning point detection</strong>: The precise month when
a trend reversed direction becomes blurred. Did the economy start
recovering in May or June? Quarterly data can’t tell you.</p></li>
</ol>
<p>The <code>PNADCperiods</code> package solves this problem by
identifying which specific month each interview refers to, using
birthday information and IBGE’s interview scheduling rules. With stacked
multi-quarter data, the algorithm achieves a <strong>94.3% determination
rate (8 quarters) or 97.0% (full 2012-2025 history)</strong> for monthly
identification—meaning we can assign specific reference months to nearly
all observations.</p>
<p>This vignette demonstrates three compelling cases where monthly data
reveals dynamics that quarterly data hides, culminating in a powerful
validation using minimum wage transitions.</p>
<blockquote>
<p><strong>Working with poverty or income data?</strong> This vignette
focuses on <strong>labor market</strong> indicators using quarterly
PNADC data. For poverty and income analysis using annual PNADC data
(which includes comprehensive household income variables), see <a href="annual-poverty-analysis.html">Monthly Poverty Analysis with Annual
PNADC Data</a>.</p>
</blockquote>
<hr>
</div>
<div class="section level2">
<h2 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<p>To reproduce these analyses, you need stacked PNADC microdata
spanning multiple quarters. The code below assumes you have already
loaded and processed your data. See <a href="download-and-prepare.html">Download and Prepare Data</a> for data
preparation, or <a href="getting-started.html">Get Started</a> for basic
usage.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://antrologos.github.io/PNADCperiods/">PNADCperiods</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="preparing-the-data">Preparing the Data<a class="anchor" aria-label="anchor" href="#preparing-the-data"></a>
</h2>
<p>This section shows how to create the aggregate time series used in
the examples below.</p>
<div class="section level3">
<h3 id="step-1-load-and-mensalize-your-data">Step 1: Load and Mensalize Your Data<a class="anchor" aria-label="anchor" href="#step-1-load-and-mensalize-your-data"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load your stacked PNADC data (see download-and-prepare vignette)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.fstpackage.org" class="external-link">fst</a></span><span class="op">)</span></span>
<span><span class="va">pnadc</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://www.fstpackage.org/reference/write_fst.html" class="external-link">read_fst</a></span><span class="op">(</span><span class="st">"path/to/your/pnadc_stacked.fst"</span>, as.data.table <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build crosswalk (identify reference periods)</span></span>
<span><span class="va">crosswalk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pnadc_identify_periods.html">pnadc_identify_periods</a></span><span class="op">(</span><span class="va">pnadc</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply crosswalk with weight calibration</span></span>
<span><span class="va">pnadc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pnadc_apply_periods.html">pnadc_apply_periods</a></span><span class="op">(</span></span>
<span>  <span class="va">pnadc</span>,</span>
<span>  <span class="va">crosswalk</span>,</span>
<span>  weight_var <span class="op">=</span> <span class="st">"V1028"</span>,</span>
<span>  anchor <span class="op">=</span> <span class="st">"quarter"</span>,</span>
<span>  calibrate <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-2-create-labor-market-variables">Step 2: Create Labor Market Variables<a class="anchor" aria-label="anchor" href="#step-2-create-labor-market-variables"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter to working-age population (14+)</span></span>
<span><span class="va">pnadc</span> <span class="op">&lt;-</span> <span class="va">pnadc</span><span class="op">[</span><span class="va">V2009</span> <span class="op">&gt;=</span> <span class="fl">14</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Create labor market indicators</span></span>
<span><span class="va">pnadc</span><span class="op">[</span>, <span class="fu">`:=`</span><span class="op">(</span></span>
<span>  <span class="co"># PEA: Economically Active Population (VD4001 == 1)</span></span>
<span>  pea <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fifelse.html" class="external-link">fifelse</a></span><span class="op">(</span><span class="va">VD4001</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fl">1L</span>, <span class="fl">0L</span><span class="op">)</span>,</span>
<span></span>
<span>  <span class="co"># Employed (VD4002 == 1)</span></span>
<span>  employed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fifelse.html" class="external-link">fifelse</a></span><span class="op">(</span><span class="va">VD4002</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fl">1L</span>, <span class="fl">0L</span><span class="op">)</span>,</span>
<span></span>
<span>  <span class="co"># Unemployed (in labor force but not employed)</span></span>
<span>  unemployed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fifelse.html" class="external-link">fifelse</a></span><span class="op">(</span><span class="va">VD4002</span> <span class="op">==</span> <span class="fl">2</span>, <span class="fl">1L</span>, <span class="fl">0L</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Formality indicator (among employed)</span></span>
<span><span class="co"># Formal: positions 1,3,5,7 OR positions 8,9 with social security contribution</span></span>
<span><span class="va">pnadc</span><span class="op">[</span>, <span class="va">formal</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fifelse.html" class="external-link">fifelse</a></span><span class="op">(</span></span>
<span>  <span class="va">VD4009</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">3L</span>, <span class="fl">5L</span>, <span class="fl">7L</span><span class="op">)</span>, <span class="fl">1L</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fifelse.html" class="external-link">fifelse</a></span><span class="op">(</span><span class="va">VD4009</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8L</span>, <span class="fl">9L</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">VD4012</span> <span class="op">==</span> <span class="fl">1L</span>, <span class="fl">1L</span>, <span class="fl">0L</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">pnadc</span><span class="op">[</span><span class="va">VD4002</span> <span class="op">!=</span> <span class="fl">1</span>, <span class="va">formal</span> <span class="op">:=</span> <span class="cn">NA_integer_</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-3-create-quarterly-series">Step 3: Create Quarterly Series<a class="anchor" aria-label="anchor" href="#step-3-create-quarterly-series"></a>
</h3>
<p>Quarterly aggregates use the original IBGE weight
(<code>V1028</code>):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">quarterly_total</span> <span class="op">&lt;-</span> <span class="va">pnadc</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span></span>
<span>  unemployment_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">unemployed</span> <span class="op">*</span> <span class="va">V1028</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span></span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pea</span> <span class="op">*</span> <span class="va">V1028</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  participation_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pea</span> <span class="op">*</span> <span class="va">V1028</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span></span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">V1028</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  formalization_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">formal</span> <span class="op">*</span> <span class="va">V1028</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span></span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">employed</span> <span class="op">*</span> <span class="va">V1028</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span>, by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">Ano</span>, <span class="va">Trimestre</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Add period column for plotting (mid-quarter date)</span></span>
<span><span class="va">quarterly_total</span><span class="op">[</span>, <span class="va">period</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">Ano</span>, <span class="st">"-"</span>, <span class="op">(</span><span class="va">Trimestre</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">3</span> <span class="op">+</span> <span class="fl">2</span>, <span class="st">"-15"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-4-create-monthly-series">Step 4: Create Monthly Series<a class="anchor" aria-label="anchor" href="#step-4-create-monthly-series"></a>
</h3>
<p>Monthly aggregates use <code>weight_monthly</code> from
PNADCperiods:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter to observations with determined reference month</span></span>
<span><span class="va">pnadc_monthly</span> <span class="op">&lt;-</span> <span class="va">pnadc</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">weight_monthly</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">monthly_total</span> <span class="op">&lt;-</span> <span class="va">pnadc_monthly</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span></span>
<span>  unemployment_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">unemployed</span> <span class="op">*</span> <span class="va">weight_monthly</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span></span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pea</span> <span class="op">*</span> <span class="va">weight_monthly</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  participation_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pea</span> <span class="op">*</span> <span class="va">weight_monthly</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span></span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_monthly</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  formalization_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">formal</span> <span class="op">*</span> <span class="va">weight_monthly</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span></span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">employed</span> <span class="op">*</span> <span class="va">weight_monthly</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span>, by <span class="op">=</span> <span class="va">ref_month_yyyymm</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Add period column for plotting (mid-month date)</span></span>
<span><span class="va">monthly_total</span><span class="op">[</span>, <span class="va">period</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>  <span class="va">ref_month_yyyymm</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">100</span>, <span class="st">"-"</span>,</span>
<span>  <span class="va">ref_month_yyyymm</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">100</span>, <span class="st">"-15"</span></span>
<span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>With these objects created, you can now run all the examples
below.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="covid-19-unemployment-the-true-peak">1. COVID-19 Unemployment: The True Peak<a class="anchor" aria-label="anchor" href="#covid-19-unemployment-the-true-peak"></a>
</h2>
<p>The COVID-19 pandemic caused the sharpest labor market shock in
Brazilian history. Within weeks, millions of workers lost their jobs or
exited the labor force entirely. Policymakers scrambled to respond, but
the quarterly data they relied on couldn’t tell them exactly when the
crisis peaked or how severe it truly was.</p>
<p>This matters because emergency policy responses—unemployment
benefits, business support, public health measures—need to be calibrated
to the actual severity of the shock. If quarterly data says unemployment
peaked at 14.4% but the true monthly peak was 16.1%, policymakers might
underestimate the resources needed for relief programs. Similarly,
knowing that the peak occurred in a specific month rather than a generic
“quarter” helps researchers connect labor market outcomes to specific
policy interventions or public health events.</p>
<p>Let’s compare the quarterly and monthly unemployment series during
the COVID period:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter to COVID period (Oct 2019 - Jan 2022)</span></span>
<span><span class="va">covid_quarterly</span> <span class="op">&lt;-</span> <span class="va">quarterly_total</span><span class="op">[</span><span class="va">period</span> <span class="op">&gt;=</span> <span class="st">"2019-10-01"</span> <span class="op">&amp;</span> <span class="va">period</span> <span class="op">&lt;=</span> <span class="st">"2022-01-01"</span><span class="op">]</span></span>
<span><span class="va">covid_monthly</span> <span class="op">&lt;-</span> <span class="va">monthly_total</span><span class="op">[</span><span class="va">period</span> <span class="op">&gt;=</span> <span class="st">"2019-10-01"</span> <span class="op">&amp;</span> <span class="va">period</span> <span class="op">&lt;=</span> <span class="st">"2022-01-01"</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Find the unemployment peaks</span></span>
<span><span class="va">peak_quarterly</span> <span class="op">&lt;-</span> <span class="va">covid_quarterly</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">unemployment_rate</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">peak_monthly</span> <span class="op">&lt;-</span> <span class="va">covid_monthly</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">unemployment_rate</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Create the comparison plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Quarterly as step function (emphasizes moving-average nature)</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">covid_quarterly</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">unemployment_rate</span><span class="op">)</span>,</span>
<span>            color <span class="op">=</span> <span class="st">"steelblue"</span>, linewidth <span class="op">=</span> <span class="fl">1.2</span>, direction <span class="op">=</span> <span class="st">"mid"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">covid_quarterly</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">unemployment_rate</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Monthly as line</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">covid_monthly</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">unemployment_rate</span><span class="op">)</span>,</span>
<span>            color <span class="op">=</span> <span class="st">"darkred"</span>, linewidth <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">covid_monthly</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">unemployment_rate</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"darkred"</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Annotate monthly peak</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>,</span>
<span>           x <span class="op">=</span> <span class="va">peak_monthly</span><span class="op">$</span><span class="va">period</span>, xend <span class="op">=</span> <span class="va">peak_monthly</span><span class="op">$</span><span class="va">period</span>,</span>
<span>           y <span class="op">=</span> <span class="va">peak_monthly</span><span class="op">$</span><span class="va">unemployment_rate</span> <span class="op">+</span> <span class="fl">0.005</span>,</span>
<span>           yend <span class="op">=</span> <span class="va">peak_monthly</span><span class="op">$</span><span class="va">unemployment_rate</span> <span class="op">+</span> <span class="fl">0.02</span>,</span>
<span>           arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>           x <span class="op">=</span> <span class="va">peak_monthly</span><span class="op">$</span><span class="va">period</span>,</span>
<span>           y <span class="op">=</span> <span class="va">peak_monthly</span><span class="op">$</span><span class="va">unemployment_rate</span> <span class="op">+</span> <span class="fl">0.022</span>,</span>
<span>           label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Monthly peak: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">peak_monthly</span><span class="op">$</span><span class="va">period</span>, <span class="st">"%b %Y"</span><span class="op">)</span>, <span class="st">"\n"</span>,</span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.1f%%"</span>, <span class="va">peak_monthly</span><span class="op">$</span><span class="va">unemployment_rate</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           size <span class="op">=</span> <span class="fl">3.2</span>, color <span class="op">=</span> <span class="st">"darkred"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Annotate quarterly peak</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>,</span>
<span>           x <span class="op">=</span> <span class="va">peak_quarterly</span><span class="op">$</span><span class="va">period</span> <span class="op">+</span> <span class="fl">30</span>, xend <span class="op">=</span> <span class="va">peak_quarterly</span><span class="op">$</span><span class="va">period</span> <span class="op">+</span> <span class="fl">30</span>,</span>
<span>           y <span class="op">=</span> <span class="va">peak_quarterly</span><span class="op">$</span><span class="va">unemployment_rate</span> <span class="op">-</span> <span class="fl">0.005</span>,</span>
<span>           yend <span class="op">=</span> <span class="va">peak_quarterly</span><span class="op">$</span><span class="va">unemployment_rate</span> <span class="op">-</span> <span class="fl">0.02</span>,</span>
<span>           arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>           x <span class="op">=</span> <span class="va">peak_quarterly</span><span class="op">$</span><span class="va">period</span> <span class="op">+</span> <span class="fl">30</span>,</span>
<span>           y <span class="op">=</span> <span class="va">peak_quarterly</span><span class="op">$</span><span class="va">unemployment_rate</span> <span class="op">-</span> <span class="fl">0.025</span>,</span>
<span>           label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Quarterly peak: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">peak_quarterly</span><span class="op">$</span><span class="va">period</span>, <span class="st">"%b %Y"</span><span class="op">)</span>, <span class="st">"\n"</span>,</span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.1f%%"</span>, <span class="va">peak_quarterly</span><span class="op">$</span><span class="va">unemployment_rate</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           size <span class="op">=</span> <span class="fl">3.2</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Scales and labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.10</span>, <span class="fl">0.17</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"3 months"</span>, date_labels <span class="op">=</span> <span class="st">"%b\n%Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"COVID-19 Unemployment Spike: Monthly vs Quarterly"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Monthly data (red) shows the true peak; quarterly (blue) averages it away"</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"Unemployment Rate"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Source: PNADC/IBGE. Quarterly shown as step function to emphasize moving-average nature."</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figures/applied-examples/fig-covid-unemployment.png" style="width:100.0%" alt="COVID-19 Unemployment: Monthly vs Quarterly"><div class="figcaption">COVID-19 Unemployment: Monthly vs
Quarterly</div>
</div>
<p>The monthly series reveals that unemployment peaked roughly 2
percentage points higher than the quarterly data suggests, and the
timing of the peak is more precisely identified. This difference
represents millions of additional unemployed workers whose situation was
masked by quarterly averaging.</p>
<hr>
</div>
<div class="section level2">
<h2 id="the-2014-2017-recession-tracking-month-by-month-deterioration">2. The 2014-2017 Recession: Tracking Month-by-Month
Deterioration<a class="anchor" aria-label="anchor" href="#the-2014-2017-recession-tracking-month-by-month-deterioration"></a>
</h2>
<p>Brazil’s 2014-2017 recession was one of the deepest in the country’s
history. Unemployment rose from around 6% to over 13%, a catastrophic
deterioration affecting tens of millions of families. But how did this
deterioration unfold? Did unemployment rise gradually, or in sudden
jumps?</p>
<p>The monthly data tells reveals that the recession unfolded in fits
and starts, with several months showing unemployment increases exceeding
1 percentage point—sudden shocks that were invisible in the averaged
quarterly figures.</p>
<p>This distinction matters for understanding the political economy of
recessions. Sudden jumps in unemployment create different social and
political pressures than gradual deterioration. They may trigger policy
responses, protests, or other social reactions.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter to recession period (Jun 2014 - Jun 2017)</span></span>
<span><span class="va">recession_quarterly</span> <span class="op">&lt;-</span> <span class="va">quarterly_total</span><span class="op">[</span><span class="va">period</span> <span class="op">&gt;=</span> <span class="st">"2014-06-01"</span> <span class="op">&amp;</span> <span class="va">period</span> <span class="op">&lt;=</span> <span class="st">"2017-06-01"</span><span class="op">]</span></span>
<span><span class="va">recession_monthly</span> <span class="op">&lt;-</span> <span class="va">monthly_total</span><span class="op">[</span><span class="va">period</span> <span class="op">&gt;=</span> <span class="st">"2014-06-01"</span> <span class="op">&amp;</span> <span class="va">period</span> <span class="op">&lt;=</span> <span class="st">"2017-06-01"</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Find the peak</span></span>
<span><span class="va">peak_recession</span> <span class="op">&lt;-</span> <span class="va">recession_monthly</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">unemployment_rate</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Calculate month-over-month changes</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/data.table/man/setorder.html" class="external-link">setorder</a></span><span class="op">(</span><span class="va">recession_monthly</span>, <span class="va">period</span><span class="op">)</span></span>
<span><span class="va">recession_monthly</span><span class="op">[</span>, <span class="va">change</span> <span class="op">:=</span> <span class="va">unemployment_rate</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/shift.html" class="external-link">shift</a></span><span class="op">(</span><span class="va">unemployment_rate</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Identify months with large jumps (&gt; 1 percentage point)</span></span>
<span><span class="va">big_jumps</span> <span class="op">&lt;-</span> <span class="va">recession_monthly</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">change</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">change</span> <span class="op">&gt;</span> <span class="fl">0.01</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Create the plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Quarterly</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">recession_quarterly</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">unemployment_rate</span><span class="op">)</span>,</span>
<span>            color <span class="op">=</span> <span class="st">"steelblue"</span>, linewidth <span class="op">=</span> <span class="fl">1</span>, direction <span class="op">=</span> <span class="st">"mid"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">recession_quarterly</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">unemployment_rate</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Monthly</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">recession_monthly</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">unemployment_rate</span><span class="op">)</span>,</span>
<span>            color <span class="op">=</span> <span class="st">"darkred"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">recession_monthly</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">unemployment_rate</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"darkred"</span>, size <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Highlight big monthly jumps</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">big_jumps</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">unemployment_rate</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"darkred"</span>, size <span class="op">=</span> <span class="fl">3</span>, shape <span class="op">=</span> <span class="fl">21</span>, fill <span class="op">=</span> <span class="st">"yellow"</span>, stroke <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Mark the peak</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"point"</span>, x <span class="op">=</span> <span class="va">peak_recession</span><span class="op">$</span><span class="va">period</span>, y <span class="op">=</span> <span class="va">peak_recession</span><span class="op">$</span><span class="va">unemployment_rate</span>,</span>
<span>           color <span class="op">=</span> <span class="st">"darkred"</span>, size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">18</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>           x <span class="op">=</span> <span class="va">peak_recession</span><span class="op">$</span><span class="va">period</span> <span class="op">+</span> <span class="fl">45</span>, y <span class="op">=</span> <span class="va">peak_recession</span><span class="op">$</span><span class="va">unemployment_rate</span>,</span>
<span>           label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Peak: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">peak_recession</span><span class="op">$</span><span class="va">period</span>, <span class="st">"%b %Y"</span><span class="op">)</span>, <span class="st">"\n"</span>,</span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.1f%%"</span>, <span class="va">peak_recession</span><span class="op">$</span><span class="va">unemployment_rate</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           size <span class="op">=</span> <span class="fl">3</span>, hjust <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Scales and labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.06</span>, <span class="fl">0.14</span>, <span class="fl">0.02</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"6 months"</span>, date_labels <span class="op">=</span> <span class="st">"%b\n%Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"2014-2017 Recession: Month-by-Month Unemployment Rise"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Yellow circles: months with &gt;1 p.p. unemployment increase. Monthly data (red) vs quarterly (blue)."</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"Unemployment Rate"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Source: PNADC/IBGE. Monthly data reveals sudden jumps hidden in quarterly averages."</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figures/applied-examples/fig-recession-detail.png" style="width:100.0%" alt="2014-2017 Recession: Month-by-Month Detail"><div class="figcaption">2014-2017 Recession: Month-by-Month Detail</div>
</div>
<p>The yellow circles mark months where unemployment jumped by more than
1 percentage point: sudden deteriorations that are completely invisible
in the smooth quarterly trend. These moments likely correspond to
specific economic or policy events that researchers can now
investigate.</p>
<hr>
</div>
<div class="section level2">
<h2 id="minimum-wage-adjustments-validating-mensalization">3. Minimum Wage Adjustments: Validating Mensalization<a class="anchor" aria-label="anchor" href="#minimum-wage-adjustments-validating-mensalization"></a>
</h2>
<p>Perhaps the most compelling validation of the mensalization
methodology comes from tracking minimum wage adjustments. PNADC collects
two income measures:</p>
<ul>
<li>
<strong>Habitual income (VD4016)</strong>: What the worker usually
earns—refers to the <strong>current</strong> reference month</li>
<li>
<strong>Effective income (VD4017)</strong>: What the worker actually
received—refers to the <strong>previous</strong> month</li>
</ul>
<p>This distinction creates almost a natural experiment. When the
minimum wage increases (typically in January), workers earning the
minimum wage should show the new value in their <em>habitual</em> income
immediately, but their <em>effective</em> income should still show the
old value (since it refers to the previous month). The following month,
effective income catches up.</p>
<p>This one-month lag is a prediction of the mensalization methodology.
If our reference month identification is correct, we should see this
pattern clearly. If it’s wrong, the pattern would be blurred or
absent.</p>
<div class="section level3">
<h3 id="methodology">Methodology<a class="anchor" aria-label="anchor" href="#methodology"></a>
</h3>
<p>We focus on formal private sector employees (VD4009 == 1) aged 18 and
older, tracking the share earning <strong>exactly</strong> each
historical minimum wage value. This precise measurement (not “around
minimum wage” but “exactly R$ 622” or “exactly R$ 678”) makes the
transition patterns especially clear.</p>
</div>
<div class="section level3">
<h3 id="preparing-the-minimum-wage-data">Preparing the Minimum Wage Data<a class="anchor" aria-label="anchor" href="#preparing-the-minimum-wage-data"></a>
</h3>
<p>The analysis below requires pre-computed objects:
<code>monthly_mw_exact</code> (monthly aggregates by MW value) and
<code>mw_adjustment_months</code> (dates when MW changed). Here’s how to
create them:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Historical minimum wage values (R$)</span></span>
<span><span class="co"># Note: 2020 had two adjustments (Jan and Feb), 2023 had mid-year adjustment (May)</span></span>
<span><span class="va">mw_history</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  start_yyyymm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">201201</span>, <span class="fl">201301</span>, <span class="fl">201401</span>, <span class="fl">201501</span>, <span class="fl">201601</span>, <span class="fl">201701</span>, <span class="fl">201801</span>,</span>
<span>                   <span class="fl">201901</span>, <span class="fl">202001</span>, <span class="fl">202002</span>, <span class="fl">202101</span>, <span class="fl">202201</span>, <span class="fl">202301</span>, <span class="fl">202305</span>,</span>
<span>                   <span class="fl">202401</span>, <span class="fl">202501</span><span class="op">)</span>,</span>
<span>  mw_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">622</span>, <span class="fl">678</span>, <span class="fl">724</span>, <span class="fl">788</span>, <span class="fl">880</span>, <span class="fl">937</span>, <span class="fl">954</span>, <span class="fl">998</span>, <span class="fl">1039</span>, <span class="fl">1045</span>, <span class="fl">1100</span>,</span>
<span>               <span class="fl">1212</span>, <span class="fl">1302</span>, <span class="fl">1320</span>, <span class="fl">1412</span>, <span class="fl">1518</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">mw_adjustment_months</span> <span class="op">&lt;-</span> <span class="va">mw_history</span><span class="op">$</span><span class="va">start_yyyymm</span></span>
<span></span>
<span><span class="co"># For each formal private sector employee, identify which MW they earn</span></span>
<span><span class="va">pnadc_formal</span> <span class="op">&lt;-</span> <span class="va">pnadc</span><span class="op">[</span><span class="va">VD4009</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">V2009</span> <span class="op">&gt;=</span> <span class="fl">18</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">weight_monthly</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Match exact habitual/effective incomes to MW values</span></span>
<span><span class="va">pnadc_formal</span><span class="op">[</span>, <span class="va">habitual_mw</span> <span class="op">:=</span> <span class="va">mw_history</span><span class="op">[</span><span class="va">start_yyyymm</span> <span class="op">&lt;=</span> <span class="va">ref_month_yyyymm</span><span class="op">]</span><span class="op">[</span><span class="va">.N</span>, <span class="va">mw_value</span><span class="op">]</span>, by <span class="op">=</span> <span class="va">ref_month_yyyymm</span><span class="op">]</span></span>
<span><span class="va">pnadc_formal</span><span class="op">[</span>, <span class="va">at_habitual_mw</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">VD4016</span> <span class="op">==</span> <span class="va">habitual_mw</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">pnadc_formal</span><span class="op">[</span>, <span class="va">at_effective_mw</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">VD4017</span> <span class="op">==</span> <span class="va">habitual_mw</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Aggregate by month and MW value</span></span>
<span><span class="va">monthly_mw_exact</span> <span class="op">&lt;-</span> <span class="va">pnadc_formal</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span></span>
<span>  n_workers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_monthly</span><span class="op">)</span>,</span>
<span>  pct_habitual <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">at_habitual_mw</span> <span class="op">*</span> <span class="va">weight_monthly</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_monthly</span><span class="op">)</span>,</span>
<span>  pct_effective <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">at_effective_mw</span> <span class="op">*</span> <span class="va">weight_monthly</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_monthly</span><span class="op">)</span></span>
<span><span class="op">)</span>, by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">ref_month_yyyymm</span>, mw_value <span class="op">=</span> <span class="va">habitual_mw</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">monthly_mw_exact</span><span class="op">[</span>, <span class="va">period</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">ref_month_yyyymm</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">100</span>, <span class="st">"-"</span>,</span>
<span>                                             <span class="va">ref_month_yyyymm</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">100</span>, <span class="st">"-15"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-smoking-gun-january-2013-transition">The Smoking Gun: January 2013 Transition<a class="anchor" aria-label="anchor" href="#the-smoking-gun-january-2013-transition"></a>
</h3>
<p>The clearest test of our methodology comes from examining a single,
clean transition. In January 2013, the minimum wage increased from R$
622 to R$ 678:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create long format for plotting (needed for all MW examples)</span></span>
<span><span class="va">mw_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/melt.data.table.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">monthly_mw_exact</span>,</span>
<span>                id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ref_month_yyyymm"</span>, <span class="st">"period"</span>, <span class="st">"mw_value"</span>, <span class="st">"n_workers"</span><span class="op">)</span>,</span>
<span>                measure.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pct_habitual"</span>, <span class="st">"pct_effective"</span><span class="op">)</span>,</span>
<span>                variable.name <span class="op">=</span> <span class="st">"income_type"</span>,</span>
<span>                value.name <span class="op">=</span> <span class="st">"pct_at_mw"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add readable labels</span></span>
<span><span class="va">mw_long</span><span class="op">[</span>, <span class="va">income_label</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fifelse.html" class="external-link">fifelse</a></span><span class="op">(</span><span class="va">income_type</span> <span class="op">==</span> <span class="st">"pct_habitual"</span>,</span>
<span>                                   <span class="st">"Habitual Income (current month)"</span>,</span>
<span>                                   <span class="st">"Effective Income (previous month)"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Get adjustment dates for reference lines</span></span>
<span><span class="va">adj_dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">mw_adjustment_months</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">100</span>, <span class="st">"-"</span>,</span>
<span>                             <span class="va">mw_adjustment_months</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">100</span>, <span class="st">"-15"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter to the first transition period (Oct 2012 - Apr 2013)</span></span>
<span><span class="va">mw_2013</span> <span class="op">&lt;-</span> <span class="va">mw_long</span><span class="op">[</span><span class="va">period</span> <span class="op">&gt;=</span> <span class="st">"2012-10-15"</span> <span class="op">&amp;</span> <span class="va">period</span> <span class="op">&lt;=</span> <span class="st">"2013-04-15"</span> <span class="op">&amp;</span></span>
<span>                   <span class="va">mw_value</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">622</span>, <span class="fl">678</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Create the plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mw_2013</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">pct_at_mw</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">mw_value</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">mw_value</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Mark the adjustment date (January 2013)</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2013-01-15"</span><span class="op">)</span>,</span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span>, color <span class="op">=</span> <span class="st">"gray40"</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Facet by income type</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">income_label</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Scales and labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 month"</span>, date_labels <span class="op">=</span> <span class="st">"%b\n%Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"622"</span> <span class="op">=</span> <span class="st">"#b2182b"</span>, <span class="st">"678"</span> <span class="op">=</span> <span class="st">"#2166ac"</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"622"</span> <span class="op">=</span> <span class="st">"R$ 622 (old)"</span>, <span class="st">"678"</span> <span class="op">=</span> <span class="st">"R$ 678 (new)"</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"MW Value"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"622"</span> <span class="op">=</span> <span class="st">"solid"</span>, <span class="st">"678"</span> <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"MW Transition: January 2013 (R$ 622 -&gt; R$ 678)"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Habitual income shows transition in January; Effective income shows same pattern in February"</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"Share Earning Exact MW"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Vertical line = MW adjustment. Habitual income refers to current month; effective to previous month."</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figures/applied-examples/fig-mw-2013-transition.png" style="width:100.0%" alt="MW 2013 Transition Detail"><div class="figcaption">MW 2013 Transition Detail</div>
</div>
<p>This is the smoking gun. In the left panel (habitual income), workers
shift from R$ 622 to R$ 678 in <strong>January</strong>. In the right
panel (effective income), the same shift happens in
<strong>February</strong>—exactly the one-month lag predicted by the
temporal reference of each variable.</p>
</div>
<div class="section level3">
<h3 id="a-harder-test-the-2020-double-adjustment">A Harder Test: The 2020 Double Adjustment<a class="anchor" aria-label="anchor" href="#a-harder-test-the-2020-double-adjustment"></a>
</h3>
<p>The January 2013 transition demonstrates the one-month lag with
perfect clarity. But what happens when things get more complicated? The
year 2020 provides an unusually demanding test.</p>
<p>In an unusual sequence, Brazil adjusted the minimum wage twice in
consecutive months:</p>
<ul>
<li>
<strong>January 2020</strong>: R$ 998 → R$ 1,039 (annual
adjustment)</li>
<li>
<strong>February 2020</strong>: R$ 1,039 → R$ 1,045
(correction)</li>
</ul>
<p>This creates a situation where R$ 1,039 was the official minimum wage
for only one month. If our reference month identification were
imprecise, these rapid transitions would blur together. Instead:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter to 2020 double adjustment period (Jul 2019 - Jul 2020)</span></span>
<span><span class="va">mw_2020</span> <span class="op">&lt;-</span> <span class="va">mw_long</span><span class="op">[</span><span class="va">period</span> <span class="op">&gt;=</span> <span class="st">"2019-07-15"</span> <span class="op">&amp;</span> <span class="va">period</span> <span class="op">&lt;=</span> <span class="st">"2020-07-15"</span> <span class="op">&amp;</span></span>
<span>                   <span class="va">mw_value</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">998</span>, <span class="fl">1039</span>, <span class="fl">1045</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Get adjustment dates in this period</span></span>
<span><span class="va">adj_2020</span> <span class="op">&lt;-</span> <span class="va">adj_dates</span><span class="op">[</span><span class="va">adj_dates</span> <span class="op">&gt;=</span> <span class="st">"2019-07-15"</span> <span class="op">&amp;</span> <span class="va">adj_dates</span> <span class="op">&lt;=</span> <span class="st">"2020-07-15"</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Create the plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mw_2020</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">pct_at_mw</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">mw_value</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">mw_value</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Mark adjustment months</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">adj_2020</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span>, color <span class="op">=</span> <span class="st">"gray40"</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Facet by income type</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">income_label</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Scales and labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 month"</span>, date_labels <span class="op">=</span> <span class="st">"%b\n%Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"998"</span> <span class="op">=</span> <span class="st">"#b2182b"</span>, <span class="st">"1039"</span> <span class="op">=</span> <span class="st">"#7b3294"</span>, <span class="st">"1045"</span> <span class="op">=</span> <span class="st">"#2166ac"</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"998"</span> <span class="op">=</span> <span class="st">"R$ 998 (2019)"</span>, <span class="st">"1039"</span> <span class="op">=</span> <span class="st">"R$ 1,039 (Jan 2020)"</span>,</span>
<span>                               <span class="st">"1045"</span> <span class="op">=</span> <span class="st">"R$ 1,045 (Feb 2020+)"</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"MW Value"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"998"</span> <span class="op">=</span> <span class="st">"solid"</span>, <span class="st">"1039"</span> <span class="op">=</span> <span class="st">"solid"</span>, <span class="st">"1045"</span> <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span>,</span>
<span>                        guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"The 2020 Double Adjustment: A Demanding Test"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"R$ 998 -&gt; R$ 1,039 (Jan) -&gt; R$ 1,045 (Feb). Three values, two transitions, one-month lag preserved."</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"Share Earning Exact MW"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Vertical lines = MW adjustments. The short-lived R$ 1,039 value (one month only) creates a sharp test."</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figures/applied-examples/fig-mw-2020-double.png" style="width:100.0%" alt="MW 2020 Double Adjustment"><div class="figcaption">MW 2020 Double Adjustment</div>
</div>
<p>The pattern remains crisp even under this demanding test. In habitual
income:</p>
<ul>
<li>January shows R$ 1,039 replacing R$ 998</li>
<li>February shows R$ 1,045 replacing R$ 1,039</li>
</ul>
<p>In effective income, each transition appears exactly one month later.
The short-lived R$ 1,039 value creates a distinctive spike visible in
both panels, offset by precisely one month.</p>
</div>
<div class="section level3">
<h3 id="the-full-picture-2012-2025">The Full Picture: 2012-2025<a class="anchor" aria-label="anchor" href="#the-full-picture-2012-2025"></a>
</h3>
<p>Even with consecutive monthly adjustments creating overlapping
transitions, the one-month lag remains crisp. Does this pattern hold
across the entire series?</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create color palette (blue to red gradient)</span></span>
<span><span class="va">mw_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">monthly_mw_exact</span><span class="op">$</span><span class="va">mw_value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">n_mw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mw_vals</span><span class="op">)</span></span>
<span><span class="va">palette_fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#2166ac"</span>, <span class="st">"#67a9cf"</span>, <span class="st">"#d1e5f0"</span>,</span>
<span>                                  <span class="st">"#fddbc7"</span>, <span class="st">"#ef8a62"</span>, <span class="st">"#b2182b"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mw_colors</span> <span class="op">&lt;-</span> <span class="fu">palette_fn</span><span class="op">(</span><span class="va">n_mw</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mw_colors</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">mw_vals</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter to MW values with meaningful presence (&gt;0.1% at some point)</span></span>
<span><span class="va">mw_long</span><span class="op">[</span>, <span class="va">max_pct</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">pct_at_mw</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">mw_value</span><span class="op">]</span></span>
<span><span class="va">mw_long_filtered</span> <span class="op">&lt;-</span> <span class="va">mw_long</span><span class="op">[</span><span class="va">max_pct</span> <span class="op">&gt;</span> <span class="fl">0.001</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Create the plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mw_long_filtered</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">pct_at_mw</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">mw_value</span><span class="op">)</span>, group <span class="op">=</span> <span class="va">mw_value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.6</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Mark MW adjustment months</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">adj_dates</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, alpha <span class="op">=</span> <span class="fl">0.3</span>, color <span class="op">=</span> <span class="st">"gray40"</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Facet by income type</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">income_label</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Scales and labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 year"</span>, date_labels <span class="op">=</span> <span class="st">"%Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">mw_colors</span>, name <span class="op">=</span> <span class="st">"MW Value (R$)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Share of Formal Workers Earning Each Exact MW Value"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Each line = one MW value. Vertical lines = MW adjustments. Pattern shifted 1 month between panels."</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"Share of Workers"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Source: PNADC/IBGE. Formal private sector employees age 18+. All calculations use weight_monthly."</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>    legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figures/applied-examples/fig-mw-big-picture.png" style="width:100.0%" alt="MW Big Picture: All Values Over Time"><div class="figcaption">MW Big Picture: All Values Over Time</div>
</div>
<p>The figure shows all minimum wage values tracked over the full
period. Each vertical line marks a MW adjustment. Notice how the pattern
in the top panel (habitual income) is shifted one month earlier than the
bottom panel (effective income)—exactly as predicted, consistently
across thirteen years and fourteen minimum wage values.</p>
<p>This provides strong validation that the mensalization algorithm
correctly identifies reference months.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="summary-what-monthly-data-reveals">Summary: What Monthly Data Reveals<a class="anchor" aria-label="anchor" href="#summary-what-monthly-data-reveals"></a>
</h2>
<table class="table">
<colgroup>
<col width="20%">
<col width="43%">
<col width="35%">
</colgroup>
<thead><tr class="header">
<th>Analysis</th>
<th>Quarterly Limitation</th>
<th>Monthly Insight</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>COVID unemployment</strong></td>
<td>Peak understated</td>
<td>True peak ~2 p.p. higher</td>
</tr>
<tr class="even">
<td><strong>Recession tracking</strong></td>
<td>Appears as smooth climb</td>
<td>Multiple months with &gt;1 p.p. jumps</td>
</tr>
<tr class="odd">
<td><strong>Minimum wage</strong></td>
<td>Timing impossible</td>
<td>1-month lag validates methodology</td>
</tr>
</tbody>
</table>
<p>Monthly data from <code>PNADCperiods</code> enables:</p>
<ul>
<li>
<strong>Precise timing</strong> of economic turning points</li>
<li>
<strong>True magnitudes</strong> of shocks (not moving
averages)</li>
<li>
<strong>Exact dating</strong> of policy-relevant changes</li>
<li>
<strong>Validation</strong> through known temporal patterns</li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="beyond-monthly-fortnightly-and-weekly-analysis">4. Beyond Monthly: Fortnightly and Weekly Analysis<a class="anchor" aria-label="anchor" href="#beyond-monthly-fortnightly-and-weekly-analysis"></a>
</h2>
<p>The examples above demonstrate the power of monthly disaggregation.
But <code>PNADCperiods</code> can go even finer: the package also
identifies <strong>fortnightly</strong> (quinzenal, 15-day periods) and
<strong>weekly</strong> reference periods for each observation.</p>
<div class="section level3">
<h3 id="when-does-finer-granularity-matter">When Does Finer Granularity Matter?<a class="anchor" aria-label="anchor" href="#when-does-finer-granularity-matter"></a>
</h3>
<p>Some phenomena unfold faster than monthly cycles:</p>
<ul>
<li>
<strong>Rapid policy shocks</strong>: COVID-19 lockdowns began
mid-March 2020—the monthly average blends pre- and post-lockdown</li>
<li>
<strong>Holiday effects</strong>: Carnival, Christmas, and New Year
have distinctive within-month labor market patterns</li>
<li>
<strong>Transition timing</strong>: Knowing exactly which fortnight
or week a change occurred can matter for event studies</li>
</ul>
<p>However, finer granularity comes at a cost: <strong>smaller
samples</strong>.</p>
</div>
<div class="section level3">
<h3 id="the-sample-size-trade-off">The Sample Size Trade-Off<a class="anchor" aria-label="anchor" href="#the-sample-size-trade-off"></a>
</h3>
<p><strong>Strict determination rates</strong> (from
<code><a href="../reference/pnadc_identify_periods.html">pnadc_identify_periods()</a></code>):</p>
<table class="table">
<colgroup>
<col width="21%">
<col width="31%">
<col width="31%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th>Granularity</th>
<th>Determination Rate</th>
<th>Typical Obs/Period</th>
<th>Best For</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Monthly</td>
<td>
<strong>94.3%</strong> (8Q) / <strong>97.0%</strong> (full)</td>
<td>~65,000</td>
<td>Most analyses</td>
</tr>
<tr class="even">
<td>Fortnightly</td>
<td><strong>8.9%</strong></td>
<td>~3,000</td>
<td>Transition timing</td>
</tr>
<tr class="odd">
<td>Weekly</td>
<td><strong>3.3%</strong></td>
<td>~500</td>
<td>Shock detection</td>
</tr>
</tbody>
</table>
<p><strong>Why the low rates for fortnights and weeks?</strong> Unlike
months, which aggregate constraints across multiple quarterly visits
(leveraging the panel design), fortnights and weeks can only use
information from within a single quarter. The birthday constraints
rarely narrow the interview window to a single 15-day or 7-day
period.</p>
</div>
<div class="section level3">
<h3 id="boosting-sub-monthly-sample-sizes-with-experimental-strategies">Boosting Sub-Monthly Sample Sizes with Experimental Strategies<a class="anchor" aria-label="anchor" href="#boosting-sub-monthly-sample-sizes-with-experimental-strategies"></a>
</h3>
<p>The strict rates above can be improved using
<code><a href="../reference/pnadc_experimental_periods.html">pnadc_experimental_periods()</a></code>. This function applies two
strategies:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Probabilistic assignment</strong>: When the interview
window spans exactly two consecutive periods and ≥X% of the interval
falls in one period, assign to that period. Threshold X set by
<code>confidence_threshold</code> parameter.</p></li>
<li><p><strong>UPA aggregation</strong>: When ≥Y% of strictly identified
observations within a UPA-V1014 group have the same period, extend that
assignment to undetermined observations. Threshold Y set by
<code>upa_proportion_threshold</code>.</p></li>
</ol>
<p>With experimental strategies (<code>strategy = "both"</code>,
conf=0.85, upa=0.80):</p>
<table class="table">
<thead><tr class="header">
<th>Granularity</th>
<th>Strict Rate (8Q)</th>
<th>Experimental Rate</th>
<th>Improvement</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Fortnight</td>
<td>8.9%</td>
<td><strong>~12-13%</strong></td>
<td>~1.4× more data</td>
</tr>
<tr class="even">
<td>Weekly</td>
<td>3.3%</td>
<td><strong>~5-6%</strong></td>
<td>~1.6-1.8× more data</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> The improvement is modest but meaningful. For
comparison, using conf=0.8 (less conservative) achieves fortnight 13.5%
and week 7.5%, while conf=0.9 (more conservative) achieves fortnight
13.5% and week 3.6%. The fortnight rate doesn’t vary much with
threshold, but weekly rate is threshold-sensitive.</p>
<p>The examples below use experimental strategies to maximize
fortnight/week sample sizes while maintaining reasonable confidence.</p>
</div>
<div class="section level3">
<h3 id="example-covid-19-lockdown-at-fortnightly-resolution">Example: COVID-19 Lockdown at Fortnightly Resolution<a class="anchor" aria-label="anchor" href="#example-covid-19-lockdown-at-fortnightly-resolution"></a>
</h3>
<p>The COVID-19 pandemic provides a compelling test case. Brazilian
lockdowns began around March 16, 2020—almost perfectly aligned with the
fortnight boundary. Monthly data for March averages the pre-lockdown
first half with the post-lockdown second half. Fortnightly data can
separate them.</p>
<p>We examine <strong>labor force participation</strong>, which dropped
sharply as workers exited the labor market entirely (not just becoming
unemployed, but stopping their job search):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply experimental strategies to boost fortnight determination</span></span>
<span><span class="co"># conf=0.85 (85% confidence), upa=0.80 (80% consensus)</span></span>
<span><span class="va">crosswalk_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pnadc_experimental_periods.html">pnadc_experimental_periods</a></span><span class="op">(</span></span>
<span>  <span class="va">crosswalk</span>,</span>
<span>  strategy <span class="op">=</span> <span class="st">"both"</span>,  <span class="co"># probabilistic + UPA aggregation</span></span>
<span>  confidence_threshold <span class="op">=</span> <span class="fl">0.85</span>,       <span class="co"># &gt;=85% of interval in one period</span></span>
<span>  upa_proportion_threshold <span class="op">=</span> <span class="fl">0.80</span>,   <span class="co"># &gt;=80% UPA consensus for extension</span></span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The experimental crosswalk now has ~12-13% fortnight determination</span></span>
<span><span class="co"># vs 8.9% strict. At conf=0.85, upa=0.80, we balance coverage with</span></span>
<span><span class="co"># assignment confidence.</span></span>
<span><span class="co"># For fortnightly analysis, we use the experimental crosswalk</span></span>
<span><span class="va">pnadc_fortnight</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">pnadc</span>, <span class="va">crosswalk_exp</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">Ano</span>, <span class="va">Trimestre</span>, <span class="va">UPA</span>, <span class="va">V1008</span>, <span class="va">V1014</span>,</span>
<span>                                                    <span class="va">ref_fortnight_in_quarter</span>, <span class="va">ref_fortnight_yyyyff</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                         by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ano"</span>, <span class="st">"Trimestre"</span>, <span class="st">"UPA"</span>, <span class="st">"V1008"</span>, <span class="st">"V1014"</span><span class="op">)</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">pnadc_fortnight</span> <span class="op">&lt;-</span> <span class="va">pnadc_fortnight</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">ref_fortnight_in_quarter</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">Ano</span> <span class="op">==</span> <span class="fl">2020</span> <span class="op">&amp;</span> <span class="va">Trimestre</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Compute participation rate by fortnight using V1028 (original quarterly weight)</span></span>
<span><span class="co"># Since fortnights cannot aggregate across quarters, V1028 is appropriate</span></span>
<span><span class="va">fortnight_covid</span> <span class="op">&lt;-</span> <span class="va">pnadc_fortnight</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span></span>
<span>  participation_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pea</span> <span class="op">*</span> <span class="va">V1028</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span></span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">V1028</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  unemployment_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">unemployed</span> <span class="op">*</span> <span class="va">V1028</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span></span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pea</span> <span class="op">*</span> <span class="va">V1028</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  n_obs <span class="op">=</span> <span class="va">.N</span></span>
<span><span class="op">)</span>, by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">Ano</span>, <span class="va">Trimestre</span>, <span class="va">ref_fortnight_in_quarter</span>, <span class="va">ref_fortnight_yyyyff</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Add period Date column (1st or 16th of month)</span></span>
<span><span class="va">fortnight_covid</span><span class="op">[</span>, <span class="fu">`:=`</span><span class="op">(</span></span>
<span>  month <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="va">ref_fortnight_yyyyff</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">100</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1L</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">2L</span> <span class="op">+</span> <span class="fl">1L</span>,</span>
<span>  day <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fifelse.html" class="external-link">fifelse</a></span><span class="op">(</span><span class="va">ref_fortnight_yyyyff</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">2L</span> <span class="op">==</span> <span class="fl">1L</span>, <span class="fl">1L</span>, <span class="fl">16L</span><span class="op">)</span>,</span>
<span>  year <span class="op">=</span> <span class="va">ref_fortnight_yyyyff</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">100L</span></span>
<span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">fortnight_covid</span><span class="op">[</span>, <span class="va">period</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span>, <span class="va">day</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Create plot comparing monthly vs fortnightly</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Monthly as reference</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">covid_monthly_participation</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">participation_rate</span><span class="op">)</span>,</span>
<span>            color <span class="op">=</span> <span class="st">"darkred"</span>, linewidth <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">covid_monthly_participation</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">participation_rate</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"darkred"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Fortnightly</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">covid_fortnight_participation</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">participation_rate</span><span class="op">)</span>,</span>
<span>            color <span class="op">=</span> <span class="st">"#ff7f0e"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">covid_fortnight_participation</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">participation_rate</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"#ff7f0e"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Mark lockdown transition</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2020-03-16"</span><span class="op">)</span>,</span>
<span>             linetype <span class="op">=</span> <span class="st">"dotted"</span>, color <span class="op">=</span> <span class="st">"gray40"</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 month"</span>, date_labels <span class="op">=</span> <span class="st">"%b\n%Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"COVID-19 Labor Force Participation: Monthly vs Fortnightly"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Fortnightly data (orange) reveals sharper discontinuity at lockdown onset (experimental strategies)"</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"Labor Force Participation Rate"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Uses pnadc_experimental_periods(strategy='both', conf=0.85, upa=0.80) for ~12-13% fortnight rate."</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figures/applied-examples/fig-covid-fortnight-comparison.png" style="width:100.0%" alt="COVID Lockdown: Monthly vs Fortnightly"><div class="figcaption">COVID Lockdown: Monthly vs Fortnightly</div>
</div>
<p>The fortnightly data shows a sharper discontinuity around March
16—the participation rate in the second fortnight of March (Mar-2)
dropped more steeply than the monthly average suggests. This
demonstrates how fortnightly resolution can capture transition timing
more precisely.</p>
</div>
<div class="section level3">
<h3 id="example-carnival-week-labor-market-effects">Example: Carnival Week Labor Market Effects<a class="anchor" aria-label="anchor" href="#example-carnival-week-labor-market-effects"></a>
</h3>
<p>Carnival is Brazil’s largest cultural event, concentrated in specific
states (Bahia, Rio de Janeiro, Pernambuco) and occurring during a
specific week each year. Do workers reduce their hours during Carnival
week?</p>
<p>With strict determination, the ~1.5% weekly rate makes this analysis
challenging. However, using <code><a href="../reference/pnadc_experimental_periods.html">pnadc_experimental_periods()</a></code>
with the same thresholds boosts this to ~14-15%. We <strong>pool
multiple years</strong> (2019, 2022-2025, excluding COVID years) and
compare Carnival states to other states. We use <strong>average hours
worked</strong> (VD4035) as our indicator, which should show a clear
drop during Carnival:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use experimental strategies for improved weekly determination</span></span>
<span><span class="co"># (Same crosswalk_exp created in the fortnight example above)</span></span>
<span></span>
<span><span class="co"># Filter to Q1 of Carnival years (2019, 2022-2025)</span></span>
<span><span class="co"># Use observations with determined weeks (among employed with valid hours)</span></span>
<span><span class="va">carnival_years</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2019L</span>, <span class="fl">2022L</span>, <span class="fl">2023L</span>, <span class="fl">2024L</span>, <span class="fl">2025L</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Merge experimental crosswalk for week data</span></span>
<span><span class="va">pnadc_weekly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">pnadc</span>, <span class="va">crosswalk_exp</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">Ano</span>, <span class="va">Trimestre</span>, <span class="va">UPA</span>, <span class="va">V1008</span>, <span class="va">V1014</span>,</span>
<span>                                                 <span class="va">ref_week_in_quarter</span>, <span class="va">ref_week_yyyyww</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                      by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ano"</span>, <span class="st">"Trimestre"</span>, <span class="st">"UPA"</span>, <span class="st">"V1008"</span>, <span class="st">"V1014"</span><span class="op">)</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">pnadc_weekly</span> <span class="op">&lt;-</span> <span class="va">pnadc_weekly</span><span class="op">[</span></span>
<span>  <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">ref_week_in_quarter</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">Trimestre</span> <span class="op">==</span> <span class="fl">1L</span> <span class="op">&amp;</span> <span class="va">Ano</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">carnival_years</span> <span class="op">&amp;</span></span>
<span>  <span class="va">employed</span> <span class="op">==</span> <span class="fl">1L</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">VD4035</span><span class="op">)</span></span>
<span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Define Carnival weeks (ISO week of Carnival Tuesday varies by year)</span></span>
<span><span class="co"># 2019: Week 10 | 2022: Week 9 | 2023: Week 8 | 2024: Week 7 | 2025: Week 10</span></span>
<span><span class="va">carnival_weeks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>  Ano <span class="op">=</span> <span class="va">carnival_years</span>,</span>
<span>  carnival_iso_week <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10L</span>, <span class="fl">9L</span>, <span class="fl">8L</span>, <span class="fl">7L</span>, <span class="fl">10L</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract ISO week and merge</span></span>
<span><span class="va">pnadc_weekly</span><span class="op">[</span>, <span class="va">iso_week</span> <span class="op">:=</span> <span class="va">ref_week_yyyyww</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">100L</span><span class="op">]</span></span>
<span><span class="va">pnadc_weekly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">pnadc_weekly</span>, <span class="va">carnival_weeks</span>, by <span class="op">=</span> <span class="st">"Ano"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">pnadc_weekly</span><span class="op">[</span>, <span class="va">is_carnival_week</span> <span class="op">:=</span> <span class="op">(</span><span class="va">iso_week</span> <span class="op">==</span> <span class="va">carnival_iso_week</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Flag Carnival-intensive states (BA=29, RJ=33, PE=26)</span></span>
<span><span class="va">pnadc_weekly</span><span class="op">[</span>, <span class="va">is_carnival_state</span> <span class="op">:=</span> <span class="va">UF</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">29L</span>, <span class="fl">33L</span>, <span class="fl">26L</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Aggregate: Average hours worked by Carnival vs non-Carnival weeks × region</span></span>
<span><span class="va">weekly_carnival</span> <span class="op">&lt;-</span> <span class="va">pnadc_weekly</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span></span>
<span>  avg_hours_worked <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">VD4035</span> <span class="op">*</span> <span class="va">V1028</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span></span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">V1028</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  n_obs <span class="op">=</span> <span class="va">.N</span></span>
<span><span class="op">)</span>, by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">is_carnival_week</span>, <span class="va">is_carnival_state</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Create difference-in-differences plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">weekly_carnival</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fifelse.html" class="external-link">fifelse</a></span><span class="op">(</span><span class="va">is_carnival_week</span>, <span class="st">"Carnival Week"</span>, <span class="st">"Other Weeks"</span><span class="op">)</span>,</span>
<span>           y <span class="op">=</span> <span class="va">avg_hours_worked</span>,</span>
<span>           fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fifelse.html" class="external-link">fifelse</a></span><span class="op">(</span><span class="va">is_carnival_state</span>, <span class="st">"Carnival States (BA/RJ/PE)"</span>, <span class="st">"Other States"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">45</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Carnival States (BA/RJ/PE)"</span> <span class="op">=</span> <span class="st">"#ff7f0e"</span>,</span>
<span>                               <span class="st">"Other States"</span> <span class="op">=</span> <span class="st">"#1f77b4"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Average Hours Worked by Week Type and Region"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Pooled data from Q1 2019, 2022-2025 (experimental strategies)"</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"Average Hours Worked (per week)"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Uses pnadc_experimental_periods(strategy='both', conf=0.85, upa=0.80) for ~5-6% weekly rate. Pooled across 5 years."</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figures/applied-examples/fig-carnival-weekly-did.png" style="width:100.0%" alt="Carnival Week Effects"><div class="figcaption">Carnival Week Effects</div>
</div>
<p>The comparison shows that workers in Carnival-intensive states
(BA/RJ/PE) reduce their average hours worked during Carnival week
(34.8h) compared to other weeks (36.9h)—a drop of about 2 hours. The
pattern provides evidence of Carnival’s labor market impact, though the
small weekly sample sizes mean estimates have considerable
uncertainty.</p>
</div>
<div class="section level3">
<h3 id="practical-guidelines-for-sub-monthly-analysis">Practical Guidelines for Sub-Monthly Analysis<a class="anchor" aria-label="anchor" href="#practical-guidelines-for-sub-monthly-analysis"></a>
</h3>
<table class="table">
<colgroup>
<col width="26%">
<col width="42%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th>Question Type</th>
<th>Recommended Granularity</th>
<th>Sample Strategy</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>“How much changed?”</td>
<td>Monthly</td>
<td>Standard strict algorithm</td>
</tr>
<tr class="even">
<td>“When exactly did it change?”</td>
<td>Fortnight</td>
<td>Use experimental strategies</td>
</tr>
<tr class="odd">
<td>“Was there a within-week pattern?”</td>
<td>Weekly</td>
<td>Experimental + pool multiple years</td>
</tr>
</tbody>
</table>
<p><strong>Key takeaways:</strong></p>
<ol style="list-style-type: decimal">
<li>
<strong>Monthly analysis handles most use cases</strong> with 94.3%
determination (8Q) or 97.0% (full history)</li>
<li>
<strong>Fortnightly analysis</strong> becomes practical with
experimental strategies (~12-13% with conf=0.85 vs ~8.9% strict)</li>
<li>
<strong>Weekly analysis</strong> benefits from experimental
strategies (~5-6% with conf=0.85 vs ~3.3% strict); pool multiple years
essential for subgroup analysis</li>
<li>
<strong>Confidence threshold trade-off</strong>: Use 0.85-0.9 for
balance; use 0.8 only if you need maximum weekly coverage</li>
</ol>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="reproducing-these-results">Reproducing These Results<a class="anchor" aria-label="anchor" href="#reproducing-these-results"></a>
</h2>
<p>To reproduce the analyses in this vignette:</p>
<ol style="list-style-type: decimal">
<li>Download PNADC quarterly microdata from IBGE</li>
<li>Stack multiple quarters (we recommend at least 2 years)</li>
<li>Apply mensalization:</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://antrologos.github.io/PNADCperiods/">PNADCperiods</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load your stacked PNADC data</span></span>
<span><span class="va">pnadc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="st">"your_pnadc_stacked.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build crosswalk and apply with weight calibration</span></span>
<span><span class="va">crosswalk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pnadc_identify_periods.html">pnadc_identify_periods</a></span><span class="op">(</span><span class="va">pnadc</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pnadc_apply_periods.html">pnadc_apply_periods</a></span><span class="op">(</span><span class="va">pnadc</span>, <span class="va">crosswalk</span>,</span>
<span>                               weight_var <span class="op">=</span> <span class="st">"V1028"</span>,</span>
<span>                               anchor <span class="op">=</span> <span class="st">"quarter"</span>,</span>
<span>                               calibrate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute monthly series</span></span>
<span><span class="va">monthly_total</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">weight_monthly</span><span class="op">)</span>, <span class="fu">.</span><span class="op">(</span></span>
<span>  unemployment_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">VD4001</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">VD4002</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="va">weight_monthly</span><span class="op">)</span> <span class="op">/</span></span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">VD4001</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">weight_monthly</span><span class="op">)</span>,</span>
<span>  participation_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">VD4001</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">weight_monthly</span><span class="op">)</span> <span class="op">/</span></span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_monthly</span><span class="op">)</span></span>
<span><span class="op">)</span>, by <span class="op">=</span> <span class="va">ref_month_yyyymm</span><span class="op">]</span></span></code></pre></div>
<p>See <a href="getting-started.html">Get Started</a> for complete
documentation of the package functions.</p>
<hr>
</div>
<div class="section level2">
<h2 id="see-also">See Also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
<ul>
<li>
<a href="getting-started.html">Get Started</a> - Basic mensalization
workflow</li>
<li>
<a href="how-it-works.html">How It Works</a> - Algorithm details and
technical explanation</li>
<li>
<a href="annual-poverty-analysis.html">Annual Poverty Analysis</a> -
Monthly poverty analysis with annual income data</li>
<li>
<a href="download-and-prepare.html">Download and Prepare Data</a> -
Data download workflow</li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>IBGE. Pesquisa Nacional por Amostra de Domicilios Continua (PNADC).
<a href="https://www.ibge.gov.br/estatisticas/sociais/trabalho/" class="external-link uri">https://www.ibge.gov.br/estatisticas/sociais/trabalho/</a>
</li>
<li>Hecksher, M. (2025). Mensalizacao da PNADC. Working paper.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://orcid.org/0000-0002-6796-4547" class="external-link">Rogerio Barbosa</a>, <a href="https://orcid.org/0000-0002-5449-6787" class="external-link">Marcos Hecksher</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
