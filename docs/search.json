[{"path":"https://antrologos.github.io/mensalizePNADC/articles/applied-examples.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Applied Examples: Quarterly vs Monthly Labor Market Series","text":"Quarterly labor market data PNADC represents moving averages monthly phenomena. averaging smooths short-term fluctuations, obscuring precise timing economic turning points true magnitude shocks. vignette demonstrates mensalizePNADC reveals dynamics quarterly data hides. focus specific periods comparisons difference striking.","code":"library(data.table) library(ggplot2) library(scales)  # Load pre-computed series (included with package) data(\"vignette_series\", package = \"mensalizePNADC\")  # Prepare data quarterly_total  <- as.data.table(vignette_quarterly_total) quarterly_gender <- as.data.table(vignette_quarterly_gender) quarterly_race   <- as.data.table(vignette_quarterly_race) monthly_total    <- as.data.table(vignette_monthly_total) monthly_gender   <- as.data.table(vignette_monthly_gender) monthly_race     <- as.data.table(vignette_monthly_race)  cat(\"Period:\", vignette_metadata$period_start, \"to\", vignette_metadata$period_end, \"\\n\") #> Period: 2012-Q1 to 2025-Q3 cat(\"Determination rate:\", sprintf(\"%.1f%%\", vignette_metadata$determination_rate * 100), \"\\n\") #> Determination rate: 95.4%"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/applied-examples.html","id":"covid-19-revealing-the-true-shock","dir":"Articles","previous_headings":"","what":"1. COVID-19: Revealing the True Shock","title":"Applied Examples: Quarterly vs Monthly Labor Market Series","text":"COVID-19 pandemic caused sharpest labor market shock Brazilian history. quarterly data understates peak delays timing.  Key findings: Monthly data shows unemployment peaked 15.3% março 2021 Quarterly data shows lower peak 14.9% - understating shock quarterly “peak” appears later true monthly peak","code":"# Focus on COVID period covid_q <- quarterly_total[period >= \"2019-10-01\" & period <= \"2022-01-01\"] covid_m <- monthly_total[period >= \"2019-10-01\" & period <= \"2022-01-01\"]  # Find peaks peak_quarterly <- covid_q[unemployment_rate == max(unemployment_rate)] peak_monthly <- covid_m[unemployment_rate == max(unemployment_rate)]  ggplot() +   # Quarterly as step function (shows moving average nature)   geom_step(data = covid_q, aes(x = period, y = unemployment_rate),             color = \"steelblue\", linewidth = 1.2, direction = \"mid\") +   geom_point(data = covid_q, aes(x = period, y = unemployment_rate),              color = \"steelblue\", size = 3) +    # Monthly as line   geom_line(data = covid_m, aes(x = period, y = unemployment_rate),             color = \"darkred\", linewidth = 0.9) +   geom_point(data = covid_m, aes(x = period, y = unemployment_rate),              color = \"darkred\", size = 1.5) +    # Annotate peaks   annotate(\"segment\", x = peak_monthly$period, xend = peak_monthly$period,            y = peak_monthly$unemployment_rate + 0.005,            yend = peak_monthly$unemployment_rate + 0.02,            arrow = arrow(length = unit(0.2, \"cm\")), color = \"darkred\") +   annotate(\"text\", x = peak_monthly$period, y = peak_monthly$unemployment_rate + 0.022,            label = paste0(\"Monthly peak: \", format(peak_monthly$period, \"%b %Y\"), \"\\n\",                          sprintf(\"%.1f%%\", peak_monthly$unemployment_rate * 100)),            size = 3.2, color = \"darkred\", hjust = 0.5) +    annotate(\"segment\", x = peak_quarterly$period + 30, xend = peak_quarterly$period + 30,            y = peak_quarterly$unemployment_rate - 0.005,            yend = peak_quarterly$unemployment_rate - 0.02,            arrow = arrow(length = unit(0.2, \"cm\")), color = \"steelblue\") +   annotate(\"text\", x = peak_quarterly$period + 30, y = peak_quarterly$unemployment_rate - 0.025,            label = paste0(\"Quarterly peak: \", format(peak_quarterly$period, \"%b %Y\"), \"\\n\",                          sprintf(\"%.1f%%\", peak_quarterly$unemployment_rate * 100)),            size = 3.2, color = \"steelblue\", hjust = 0.5) +    scale_y_continuous(labels = percent_format(accuracy = 0.1),                      limits = c(0.10, 0.17)) +   scale_x_date(date_breaks = \"3 months\", date_labels = \"%b\\n%Y\") +    labs(     title = \"COVID-19 Unemployment Spike: Monthly vs Quarterly\",     subtitle = \"Monthly data (red) shows the true peak; quarterly (blue) averages it away\",     x = NULL, y = \"Unemployment Rate\",     caption = \"Source: PNADC/IBGE. Quarterly shown as step function to emphasize moving-average nature.\"   ) +   theme_minimal(base_size = 11) +   theme(     plot.title = element_text(face = \"bold\"),     panel.grid.minor = element_blank()   ) #> Warning: Removed 1 row containing missing values or values outside the scale range #> (`geom_segment()`). #> Warning: Removed 1 row containing missing values or values outside the scale range #> (`geom_text()`)."},{"path":"https://antrologos.github.io/mensalizePNADC/articles/applied-examples.html","id":"the-2014-2017-recession-tracking-the-deterioration","dir":"Articles","previous_headings":"","what":"2. The 2014-2017 Recession: Tracking the Deterioration","title":"Applied Examples: Quarterly vs Monthly Labor Market Series","text":"Brazil’s 2014-2017 recession saw unemployment rise 6% 14%. Monthly data reveals month--month deterioration quarterly data smooths.  Key findings: Monthly data reveals 3 months unemployment jumps exceeding 1 percentage point sudden deteriorations invisible quarterly data precise peak occurred fevereiro 2017 14.0%","code":"# Focus on recession build-up recession_q <- quarterly_total[period >= \"2014-06-01\" & period <= \"2017-06-01\"] recession_m <- monthly_total[period >= \"2014-06-01\" & period <= \"2017-06-01\"]  # Find the peak peak_m <- recession_m[unemployment_rate == max(unemployment_rate)]  # Calculate month-to-month changes for monthly setorder(recession_m, period) recession_m[, change := unemployment_rate - shift(unemployment_rate)] big_jumps <- recession_m[!is.na(change) & change > 0.01]  ggplot() +   # Quarterly   geom_step(data = recession_q, aes(x = period, y = unemployment_rate),             color = \"steelblue\", linewidth = 1, direction = \"mid\", alpha = 0.7) +   geom_point(data = recession_q, aes(x = period, y = unemployment_rate),              color = \"steelblue\", size = 2.5) +    # Monthly   geom_line(data = recession_m, aes(x = period, y = unemployment_rate),             color = \"darkred\", linewidth = 0.8) +   geom_point(data = recession_m, aes(x = period, y = unemployment_rate),              color = \"darkred\", size = 1.2) +    # Highlight big monthly jumps   geom_point(data = big_jumps, aes(x = period, y = unemployment_rate),              color = \"darkred\", size = 3, shape = 21, fill = \"yellow\", stroke = 1.5) +    # Mark the peak   annotate(\"point\", x = peak_m$period, y = peak_m$unemployment_rate,            color = \"darkred\", size = 4, shape = 18) +   annotate(\"text\", x = peak_m$period + 45, y = peak_m$unemployment_rate,            label = paste0(\"Peak: \", format(peak_m$period, \"%b %Y\"), \"\\n\",                          sprintf(\"%.1f%%\", peak_m$unemployment_rate * 100)),            size = 3, hjust = 0, color = \"darkred\") +    scale_y_continuous(labels = percent_format(accuracy = 1),                      breaks = seq(0.06, 0.14, 0.02)) +   scale_x_date(date_breaks = \"6 months\", date_labels = \"%b\\n%Y\") +    labs(     title = \"2014-2017 Recession: Month-by-Month Unemployment Rise\",     subtitle = \"Yellow circles: months with >1 p.p. unemployment increase. Monthly data (red) vs quarterly (blue).\",     x = NULL, y = \"Unemployment Rate\",     caption = \"Source: PNADC/IBGE. Monthly data reveals sudden jumps hidden in quarterly averages.\"   ) +   theme_minimal(base_size = 11) +   theme(     plot.title = element_text(face = \"bold\"),     panel.grid.minor = element_blank()   )"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/applied-examples.html","id":"gender-gap-during-covid-women-left-the-labor-force","dir":"Articles","previous_headings":"","what":"3. Gender Gap During COVID: Women Left the Labor Force","title":"Applied Examples: Quarterly vs Monthly Labor Market Series","text":"COVID-19 disproportionately affected women’s labor force participation due school closures care responsibilities. Monthly data captures exact timing magnitude divergence.  Key findings: Pre-COVID gender gap: 19.1 percentage points Maximum gap COVID: 21.5 percentage points agosto 2020 Women’s participation dropped 54.0% 46.4% Monthly data pinpoints divergence began recovery started","code":"# Prepare gender data for COVID period covid_gender_m <- monthly_gender[period >= \"2019-10-01\" & period <= \"2021-09-01\"] covid_gender_q <- quarterly_gender[period >= \"2019-10-01\" & period <= \"2021-09-01\"]  # Calculate gender gap gap_monthly <- dcast(covid_gender_m, period ~ sexo, value.var = \"participation_rate\") gap_monthly[, gap := Men - Women] setorder(gap_monthly, period)  # Find max gap max_gap <- gap_monthly[gap == max(gap)]  # Pre-COVID baseline baseline <- gap_monthly[period == \"2020-02-15\"]  ggplot() +   # Men - monthly   geom_line(data = covid_gender_m[sexo == \"Men\"],             aes(x = period, y = participation_rate),             color = \"steelblue\", linewidth = 1) +   # Women - monthly   geom_line(data = covid_gender_m[sexo == \"Women\"],             aes(x = period, y = participation_rate),             color = \"coral\", linewidth = 1) +    # Shade the gap at maximum point   annotate(\"rect\",            xmin = max_gap$period - 20, xmax = max_gap$period + 20,            ymin = max_gap$Women, ymax = max_gap$Men,            fill = \"purple\", alpha = 0.2) +   annotate(\"segment\",            x = max_gap$period, xend = max_gap$period,            y = max_gap$Women, yend = max_gap$Men,            color = \"purple\", linewidth = 1.5) +   annotate(\"text\", x = max_gap$period + 25, y = (max_gap$Men + max_gap$Women) / 2,            label = paste0(\"Max gap: \", sprintf(\"%.1f p.p.\", (max_gap$Men - max_gap$Women) * 100)),            size = 3, hjust = 0, color = \"purple\") +    # Labels   annotate(\"text\", x = as.Date(\"2021-06-01\"), y = 0.715, label = \"Men\",            color = \"steelblue\", fontface = \"bold\", size = 4) +   annotate(\"text\", x = as.Date(\"2021-06-01\"), y = 0.505, label = \"Women\",            color = \"coral\", fontface = \"bold\", size = 4) +    # Baseline reference   geom_hline(yintercept = baseline$Women, linetype = \"dashed\", color = \"coral\", alpha = 0.5) +   annotate(\"text\", x = as.Date(\"2019-11-01\"), y = baseline$Women + 0.01,            label = \"Pre-COVID\\nwomen's rate\", size = 2.5, color = \"coral\", hjust = 0) +    scale_y_continuous(labels = percent_format(accuracy = 1),                      limits = c(0.45, 0.75)) +   scale_x_date(date_breaks = \"3 months\", date_labels = \"%b\\n%Y\") +    labs(     title = \"COVID-19 Gender Impact: Women's Participation Collapsed\",     subtitle = paste0(\"Gender gap widened from \", sprintf(\"%.1f\", baseline$gap * 100),                      \" to \", sprintf(\"%.1f\", max_gap$gap * 100),                      \" p.p. - monthly data shows exact timing\"),     x = NULL, y = \"Labor Force Participation Rate\",     caption = \"Source: PNADC/IBGE. Monthly data from mensalizePNADC.\"   ) +   theme_minimal(base_size = 11) +   theme(     plot.title = element_text(face = \"bold\"),     panel.grid.minor = element_blank()   )"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/applied-examples.html","id":"racial-inequality-unemployment-gap-widened-during-covid","dir":"Articles","previous_headings":"","what":"4. Racial Inequality: Unemployment Gap Widened During COVID","title":"Applied Examples: Quarterly vs Monthly Labor Market Series","text":"unemployment gap Black White workers widened significantly pandemic. Monthly data reveals happened.  Key findings: Pre-COVID Black-White gap: 4.8 percentage points Maximum gap: 8.0 percentage points agosto 2020 Black unemployment peaked nearly 20% White unemployment peaked 12% Monthly data shows gap widened immediately COVID started remained elevated","code":"# Prepare race data - focus on unemployment rate gap race_unemp_m <- monthly_race[period >= \"2019-01-01\" & period <= \"2022-01-01\"] race_unemp_q <- quarterly_race[period >= \"2019-01-01\" & period <= \"2022-01-01\"]  # Calculate gap (Black - White) gap_race_m <- dcast(race_unemp_m, period ~ raca, value.var = \"unemployment_rate\") gap_race_m[, gap := Black - White] setorder(gap_race_m, period)  # Find max gap max_race_gap <- gap_race_m[gap == max(gap, na.rm = TRUE)]  # Pre-COVID baseline_race <- gap_race_m[period == \"2020-02-15\"]  ggplot() +   # White unemployment   geom_line(data = race_unemp_m[raca == \"White\"],             aes(x = period, y = unemployment_rate),             color = \"#2166AC\", linewidth = 1) +   # Black unemployment   geom_line(data = race_unemp_m[raca == \"Black\"],             aes(x = period, y = unemployment_rate),             color = \"#B2182B\", linewidth = 1) +   # Brown unemployment   geom_line(data = race_unemp_m[raca == \"Brown\"],             aes(x = period, y = unemployment_rate),             color = \"#DFC27D\", linewidth = 1) +    # Shade max gap period   annotate(\"rect\",            xmin = max_race_gap$period - 20, xmax = max_race_gap$period + 20,            ymin = max_race_gap$White, ymax = max_race_gap$Black,            fill = \"gray50\", alpha = 0.2) +    # COVID start marker   geom_vline(xintercept = as.Date(\"2020-03-15\"), linetype = \"dashed\", alpha = 0.5) +   annotate(\"text\", x = as.Date(\"2020-03-15\"), y = 0.21,            label = \"COVID\\nstart\", size = 2.5, hjust = -0.1) +    # Labels   annotate(\"text\", x = as.Date(\"2021-10-01\"), y = 0.175, label = \"Black\",            color = \"#B2182B\", fontface = \"bold\", size = 3.5) +   annotate(\"text\", x = as.Date(\"2021-10-01\"), y = 0.135, label = \"Brown\",            color = \"#DFC27D\", fontface = \"bold\", size = 3.5) +   annotate(\"text\", x = as.Date(\"2021-10-01\"), y = 0.095, label = \"White\",            color = \"#2166AC\", fontface = \"bold\", size = 3.5) +    # Gap annotation   annotate(\"text\", x = max_race_gap$period + 60, y = (max_race_gap$Black + max_race_gap$White) / 2,            label = paste0(\"Max gap: \", sprintf(\"%.1f p.p.\", max_race_gap$gap * 100), \"\\n\",                          format(max_race_gap$period, \"%b %Y\")),            size = 3, hjust = 0) +    scale_y_continuous(labels = percent_format(accuracy = 1),                      limits = c(0.08, 0.22)) +   scale_x_date(date_breaks = \"4 months\", date_labels = \"%b\\n%Y\") +    labs(     title = \"Racial Unemployment Gap: COVID Amplified Inequality\",     subtitle = paste0(\"Black-White gap widened from \", sprintf(\"%.1f\", baseline_race$gap * 100),                      \" to \", sprintf(\"%.1f\", max_race_gap$gap * 100), \" p.p.\"),     x = NULL, y = \"Unemployment Rate\",     caption = \"Source: PNADC/IBGE. Monthly data from mensalizePNADC.\"   ) +   theme_minimal(base_size = 11) +   theme(     plot.title = element_text(face = \"bold\"),     panel.grid.minor = element_blank()   )"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/applied-examples.html","id":"formalization-rate-detecting-the-covid-paradox","dir":"Articles","previous_headings":"","what":"5. Formalization Rate: Detecting the “COVID Paradox”","title":"Applied Examples: Quarterly vs Monthly Labor Market Series","text":"COVID, formalization rate increased despite economic collapse. ? Informal workers lost jobs faster, changing composition employment.  Key findings: Pre-COVID formalization: 58.9% COVID peak: 62.6% abril 2020 3.7 p.p. jump happened single month Monthly data captures compositional shift quarterly data smooths","code":"# Focus on COVID period formalization covid_form_m <- monthly_total[period >= \"2019-10-01\" & period <= \"2021-06-01\",                                .(period, formalization_rate)] covid_form_q <- quarterly_total[period >= \"2019-10-01\" & period <= \"2021-06-01\",                                  .(period, formalization_rate)]  # Find the spike max_formal <- covid_form_m[formalization_rate == max(formalization_rate)] pre_covid <- covid_form_m[period == \"2020-02-15\"]  ggplot() +   # Quarterly   geom_step(data = covid_form_q, aes(x = period, y = formalization_rate),             color = \"steelblue\", linewidth = 1, direction = \"mid\") +   geom_point(data = covid_form_q, aes(x = period, y = formalization_rate),              color = \"steelblue\", size = 2.5) +    # Monthly   geom_line(data = covid_form_m, aes(x = period, y = formalization_rate),             color = \"darkgreen\", linewidth = 0.9) +   geom_point(data = covid_form_m, aes(x = period, y = formalization_rate),              color = \"darkgreen\", size = 1.5) +    # Highlight the spike   annotate(\"point\", x = max_formal$period, y = max_formal$formalization_rate,            color = \"darkgreen\", size = 4, shape = 18) +   annotate(\"segment\", x = max_formal$period, xend = max_formal$period,            y = max_formal$formalization_rate + 0.005,            yend = max_formal$formalization_rate + 0.025,            arrow = arrow(length = unit(0.2, \"cm\")), color = \"darkgreen\") +   annotate(\"text\", x = max_formal$period, y = max_formal$formalization_rate + 0.03,            label = paste0(\"COVID spike:\\n\", sprintf(\"%.1f%%\", max_formal$formalization_rate * 100), \"\\n\",                          \"(informal jobs lost)\"),            size = 3, hjust = 0.5, color = \"darkgreen\") +    # Pre-COVID reference   geom_hline(yintercept = pre_covid$formalization_rate, linetype = \"dashed\", alpha = 0.5) +    scale_y_continuous(labels = percent_format(accuracy = 1),                      limits = c(0.56, 0.66)) +   scale_x_date(date_breaks = \"3 months\", date_labels = \"%b\\n%Y\") +    labs(     title = \"The COVID Formalization Paradox\",     subtitle = \"Formalization rate ROSE because informal workers lost jobs disproportionately\",     x = NULL, y = \"Formalization Rate\",     caption = \"Source: PNADC/IBGE. Green = monthly, blue = quarterly.\"   ) +   theme_minimal(base_size = 11) +   theme(     plot.title = element_text(face = \"bold\"),     panel.grid.minor = element_blank()   )"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/applied-examples.html","id":"summary-what-monthly-data-reveals","dir":"Articles","previous_headings":"","what":"Summary: What Monthly Data Reveals","title":"Applied Examples: Quarterly vs Monthly Labor Market Series","text":"Monthly data mensalizePNADC enables: Precise timing economic turning points True magnitudes shocks (moving averages) Exact dating policy-relevant changes Short-term dynamics invisible quarterly data","code":""},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/articles/applied-examples.html","id":"data-source","dir":"Articles","previous_headings":"Technical Notes","what":"Data Source","title":"Applied Examples: Quarterly vs Monthly Labor Market Series","text":"series shown computed 22,850,046 PNADC observations covering 2012-Q1 2025-Q3. mensalization algorithm achieved 95.4% determination rate, meaning nearly observations assigned specific months.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/articles/applied-examples.html","id":"reproduce-these-results","dir":"Articles","previous_headings":"Technical Notes","what":"Reproduce These Results","title":"Applied Examples: Quarterly vs Monthly Labor Market Series","text":"See Getting Started vignette complete algorithm explanation.","code":"library(mensalizePNADC) library(data.table)  # Load your stacked PNADC data pnadc <- fread(\"your_pnadc_stacked.csv\")  # Apply mensalization with weight computation result <- mensalizePNADC(pnadc, compute_weights = TRUE)  # Compute monthly unemployment rate monthly_unemp <- result[!is.na(weight_monthly), .(   unemployment_rate = sum((VD4001 == 1 & VD4002 == 2) * weight_monthly) /                       sum((VD4001 == 1) * weight_monthly) ), by = ref_month_yyyymm]"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/applied-examples.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Applied Examples: Quarterly vs Monthly Labor Market Series","text":"IBGE. Pesquisa Nacional por Amostra de Domicilios Continua (PNADC). https://www.ibge.gov.br/estatisticas/sociais/trabalho/ Hecksher, M. (2024). Mensalizacao da PNADC. Working paper.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting Started with mensalizePNADC","text":"mensalizePNADC package converts Brazil’s quarterly PNADC (Pesquisa Nacional por Amostra de Domicilios Continua) survey data monthly time series. provides two main capabilities: Reference month identification: Determines month within quarter survey observation refers Monthly weight computation: Adjusts survey weights monthly (instead quarterly) estimates Note: Results identical original Stata implementation Marcos Hecksher.","code":""},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"required-input-variables","dir":"Articles","previous_headings":"Quick Reference","what":"Required Input Variables","title":"Getting Started with mensalizePNADC","text":"Minimum (reference month identification): Additional (compute_weights = TRUE):","code":""},{"path":[]},{"path":[]},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"why-stacked-data-matters","dir":"Articles","previous_headings":"","what":"Why Stacked Data Matters","title":"Getting Started with mensalizePNADC","text":"algorithm achieves 97.0% determination rate processing stacked multi-quarter data. process quarters individually, ’ll get ~65-75% determination. ? PNADC uses rotating panel household (UPA + V1014) interviewed 5 consecutive quarters. Crucially, household always interviewed relative month position (always month 1, always month 2, always month 3). means birthday constraints quarter can determine month quarters: Recommended: Stack least 2 years quarterly data calling mensalizePNADC().","code":"UPA=123456, V1014=1 appears in 5 quarters:    2023-Q1: month_min=1, month_max=2 (ambiguous: Jan or Feb)   2023-Q2: month_min=1, month_max=3 (ambiguous: Apr, May, or Jun)   2023-Q3: month_min=2, month_max=2 (DETERMINED: August)  ← Birthday constraint!   2023-Q4: month_min=1, month_max=2 (ambiguous: Oct or Nov)   2024-Q1: month_min=2, month_max=3 (ambiguous: Feb or Mar)  Cross-quarter aggregation:   upa_month_min = max(1, 1, 2, 1, 2) = 2   upa_month_max = min(2, 3, 2, 2, 3) = 2  Result: ALL 5 quarters → ref_month_in_quarter = 2"},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-1-load-your-data","dir":"Articles","previous_headings":"Basic Usage","what":"Step 1: Load your data","title":"Getting Started with mensalizePNADC","text":"","code":"library(mensalizePNADC) library(data.table)  # Load your stacked quarterly PNADC data pnadc <- fread(\"pnadc_stacked.csv\",   select = c(\"Ano\", \"Trimestre\", \"UPA\", \"V1008\", \"V1014\", \"V2003\",              \"V2008\", \"V20081\", \"V20082\", \"V2009\"))  # Check data dimensions cat(\"Rows:\", nrow(pnadc), \"\\n\") cat(\"Quarters:\", uniqueN(pnadc[, .(Ano, Trimestre)]), \"\\n\")"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-2-get-the-crosswalk","dir":"Articles","previous_headings":"Basic Usage","what":"Step 2: Get the crosswalk","title":"Getting Started with mensalizePNADC","text":"","code":"crosswalk <- mensalizePNADC(pnadc) # Processing PNADC data... # |==============================| 100% #   Determination rate: 97.0%  # View the crosswalk (a data.table) head(crosswalk) #    Ano Trimestre    UPA V1008 V1014 V2003   ref_month ref_month_in_quarter ref_month_yyyymm # 1: 2012         1 110000     1     1     1 2012-01-01                    1           201201 # 2: 2012         1 110000     1     1     2 2012-01-01                    1           201201  # Check the determination rate attribute attr(crosswalk, \"determination_rate\") # [1] 0.97"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-3-join-with-original-data","dir":"Articles","previous_headings":"Basic Usage","what":"Step 3: Join with original data","title":"Getting Started with mensalizePNADC","text":"","code":"# Load an original quarterly file with all variables you need library(haven) original <- read_dta(\"PNADC_2023T1.dta\")  # Join to add monthly information monthly_data <- merge(original, crosswalk,   by = c(\"Ano\", \"Trimestre\", \"UPA\", \"V1008\", \"V1014\", \"V2003\"),   all.x = TRUE)  # Now you have: # - ref_month: Reference month as Date (e.g., 2023-01-01) # - ref_month_in_quarter: Position in quarter (1, 2, 3, or NA) # - ref_month_yyyymm: Integer YYYYMM format (e.g., 202301)"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-4-use-the-monthly-information","dir":"Articles","previous_headings":"Basic Usage","what":"Step 4: Use the monthly information","title":"Getting Started with mensalizePNADC","text":"","code":"# Filter to a specific month jan_2023 <- monthly_data[ref_month_yyyymm == 202301]  # Group by month by_month <- monthly_data[, .(   n_obs = .N,   mean_age = mean(V2009, na.rm = TRUE) ), by = ref_month_yyyymm]  # Check determination rate by year monthly_data[, .(   total = .N,   determined = sum(!is.na(ref_month_in_quarter)),   rate = round(mean(!is.na(ref_month_in_quarter)) * 100, 1) ), by = Ano]"},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"overview-diagram","dir":"Articles","previous_headings":"The Algorithm Explained","what":"Overview Diagram","title":"Getting Started with mensalizePNADC","text":"reference month identification follows 7-step pipeline:","code":"┌─────────────────────────────────────────────────────────────────────────────┐ │                    REFERENCE MONTH IDENTIFICATION PIPELINE                   │ └─────────────────────────────────────────────────────────────────────────────┘  INPUTS (per observation): ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐ │  Year (Ano)  │  │  Quarter     │  │  Birthday    │  │  Age         │ │              │  │  (Trimestre) │  │  (V2008/1/2) │  │  (V2009)     │ └──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘         │                │                  │                 │         ▼                ▼                  ▼                 ▼ ┌─────────────────────────────────────────────────────────────────────────────┐ │ STEP 1: Calculate Valid Interview Saturdays                                 │ │         (IBGE \"Parada Tecnica\" Rules)                                       │ ├─────────────────────────────────────────────────────────────────────────────┤ │  For each month, find first Saturday with >=4 days in that month.           │ │  OUTPUT: date_min = First Saturday of Month 1                               │ │          date_max = First Saturday of Month 3 + 21 days                     │ └─────────────────────────────────────────────────────────────────────────────┘                                      │                                      ▼ ┌─────────────────────────────────────────────────────────────────────────────┐ │ STEP 2: Apply Birthday Constraints                                          │ ├─────────────────────────────────────────────────────────────────────────────┤ │  Compare (Survey_Year - Birth_Year) with Reported_Age to determine if      │ │  interview was BEFORE or AFTER the person's birthday this year.            │ │                                                                             │ │  If AFTER birthday  -> date_min = max(date_min, Sat_after_birthday)         │ │  If BEFORE birthday -> date_max = min(date_max, Sat_before_birthday)        │ └─────────────────────────────────────────────────────────────────────────────┘                                      │                                      ▼ ┌─────────────────────────────────────────────────────────────────────────────┐ │ STEP 3: Convert Date Ranges to Month Positions (1, 2, or 3)                 │ ├─────────────────────────────────────────────────────────────────────────────┤ │  month_min_pos = which month does date_min fall in?                         │ │  month_max_pos = which month does date_max fall in?                         │ │  Special handling: days 1-3 of a month belong to previous month's week      │ └─────────────────────────────────────────────────────────────────────────────┘                                      │                                      ▼ ┌─────────────────────────────────────────────────────────────────────────────┐ │ STEP 4: Aggregate to UPA-Panel Level                                        │ ├─────────────────────────────────────────────────────────────────────────────┤ │  All people in same (UPA, V1014) are interviewed in the SAME MONTH.         │ │  Take intersection of all individual constraints:                           │ │                                                                             │ │    upa_month_min = max(all individual month_min_pos)                        │ │    upa_month_max = min(all individual month_max_pos)                        │ │                                                                             │ │  If upa_month_min = upa_month_max -> DETERMINED!                            │ │  If upa_month_min < upa_month_max -> Still ambiguous, try Step 5            │ └─────────────────────────────────────────────────────────────────────────────┘                                      │                                      ▼ ┌─────────────────────────────────────────────────────────────────────────────┐ │ STEP 5: Cross-Quarter Aggregation (KEY INNOVATION)                          │ ├─────────────────────────────────────────────────────────────────────────────┤ │  PNADC uses ROTATING PANEL: same (UPA, V1014) interviewed in SAME MONTH     │ │  POSITION across all quarterly visits (up to 5 consecutive quarters).       │ │                                                                             │ │  Combine constraints from ALL quarters -> dramatically improves accuracy:   │ │                                                                             │ │    Per-quarter only:  ~65-75% determination                                 │ │    Cross-quarter:     ~97.0% determination                                  │ └─────────────────────────────────────────────────────────────────────────────┘                                      │                                      ▼ ┌─────────────────────────────────────────────────────────────────────────────┐ │ STEP 6: Dynamic Exception Detection                                         │ ├─────────────────────────────────────────────────────────────────────────────┤ │  Algorithm DYNAMICALLY detects which quarters need relaxed timing rules:    │ │                                                                             │ │  1. Calculate positions using STANDARD rules (>=4 days, day <=3 threshold)  │ │  2. Calculate positions using ALTERNATIVE rules (>=3 days, day <=2)         │ │  3. Detect: if standard produces min>max but alternative would work         │ │  4. Propagate: if ANY UPA needs exception -> apply to ALL in that quarter   │ │                                                                             │ │  Known exception quarters: 2016t3, 2016t4, 2017t2, 2022t3, 2023t2           │ └─────────────────────────────────────────────────────────────────────────────┘                                      │                                      ▼ ┌─────────────────────────────────────────────────────────────────────────────┐ │ STEP 7: Final Month Assignment                                              │ ├─────────────────────────────────────────────────────────────────────────────┤ │  After applying exceptions and recalculating:                               │ │  If upa_month_min == upa_month_max -> Reference month DETERMINED            │ │  Otherwise -> remains NA (indeterminate, ~3% of observations)               │ └─────────────────────────────────────────────────────────────────────────────┘                                     │                                     ▼ ┌─────────────────────────────────────────────────────────────────────────────┐ │ OUTPUT                                                                       │ ├─────────────────────────────────────────────────────────────────────────────┤ │  ref_month_in_quarter: 1, 2, 3, or NA (indeterminate)                       │ │  ref_month:            Full date (e.g., 2023-02-01)                         │ │  ref_month_yyyymm:     Integer format (e.g., 202302)                        │ └─────────────────────────────────────────────────────────────────────────────┘"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-1-valid-interview-saturdays-ibge-rules","dir":"Articles","previous_headings":"The Algorithm Explained","what":"Step 1: Valid Interview Saturdays (IBGE Rules)","title":"Getting Started with mensalizePNADC","text":"PNADC interviews households reference weeks end Saturdays. IBGE’s “Parada Tecnica” rule: reference week belongs month Saturday least 4 days within month. calculate first valid Saturday: Example Q1 2023: valid Saturday calculation defines possible interview date range quarter: - date_min = First valid Saturday Month 1 - date_max = First valid Saturday Month 3 + 21 days","code":"first_saturday_day = day of the first Saturday of the month if first_saturday_day >= 4:     use this Saturday (it has enough days in the month) else:     use the second Saturday (first_saturday_day + 7) JANUARY 2023:   Sun  Mon  Tue  Wed  Thu  Fri  SAT    1    2    3    4    5    6   [7]  <- First Saturday is day 7                                      7 >= 4? YES -> Valid! (7 days in January)  FEBRUARY 2023:   Wed  Thu  Fri  SAT  ...    1    2    3   [4]              <- First Saturday is day 4                                   4 >= 4? YES -> Valid! (4 days in February)  APRIL 2023:   SAT  Sun  Mon  Tue  ...   [1]   2    3    4              <- First Saturday is day 1                                   1 >= 4? NO -> Skip to second Saturday!   Fri  SAT  Sun  ...    7   [8]   9                   <- Use day 8 instead"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-2-birthday-constraints","dir":"Articles","previous_headings":"The Algorithm Explained","what":"Step 2: Birthday Constraints","title":"Getting Started with mensalizePNADC","text":"reported age combined birth year tells us whether interview happened person’s birthday: Example: Interview birthday Example: Interview birthday Unknown birthdays: V2008=99, V20081=99, V20082=9999, person’s birthday constrain date. However, may still determined household aggregation (Step 4) cross-quarter aggregation (Step 5).","code":"visit_before_birthday = (Survey_Year - Birth_Year) - Reported_Age  If = 0: Interview was AFTER birthday (person already celebrated this year) If = 1: Interview was BEFORE birthday (birthday hasn't happened yet) Person: Born March 15, 1990 Survey Year: 2023 Reported Age: 33  Check: 2023 - 1990 = 33        33 - 33 = 0  -> Interview was AFTER March 15, 2023  Constraint: date_min = max(date_min, first_Saturday_on_or_after(March 15))             date_min = max(Jan 7, March 18) = March 18  This person can only have been interviewed in MARCH (month 3). Person: Born March 15, 1990 Survey Year: 2023 Reported Age: 32  Check: 2023 - 1990 = 33        33 - 32 = 1  -> Interview was BEFORE March 15, 2023  Constraint: date_max = min(date_max, Saturday_before(March 15))             date_max = min(March 25, March 11) = March 11  This person can only have been interviewed in JANUARY or FEBRUARY."},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-3-date-to-month-position","dir":"Articles","previous_headings":"The Algorithm Explained","what":"Step 3: Date to Month Position","title":"Getting Started with mensalizePNADC","text":"Transform date window [date_min, date_max] month--quarter positions (1, 2, 3). Boundary handling: Interviews days 1-3 month typically belong reference week started previous month:","code":"For date_min: if day <= 3 AND not in first month of quarter:               subtract 1 from month position  For date_max: if day <= 3:               use the month of (date - 3 days) instead"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-4-upa-panel-aggregation","dir":"Articles","previous_headings":"The Algorithm Explained","what":"Step 4: UPA-Panel Aggregation","title":"Getting Started with mensalizePNADC","text":"people UPA + V1014 interviewed together reference month. Take intersection: Example:","code":"upa_month_min = MAX of all individual month_min_pos upa_month_max = MIN of all individual month_max_pos Household (UPA=123456, V1014=1) has 3 members:  Person A: month_min=1, month_max=2 (could be Jan or Feb) Person B: month_min=1, month_max=3 (could be Jan, Feb, or Mar) Person C: month_min=2, month_max=3 (could be Feb or Mar)  Aggregation:   upa_month_min = max(1, 1, 2) = 2   upa_month_max = min(2, 3, 3) = 2  Result: min=2, max=2 -> Reference month is FEBRUARY!  Visual:               Jan    Feb    Mar Person A:     [======] Person B:     [=============] Person C:            [========] Intersection:        [==]      <- Only February satisfies all"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-5-cross-quarter-aggregation","dir":"Articles","previous_headings":"The Algorithm Explained","what":"Step 5: Cross-Quarter Aggregation","title":"Getting Started with mensalizePNADC","text":"Since relative month position constant across quarters, constraints quarter apply quarters: processing stacked data improves determination ~70% ~97%.","code":"For each (UPA, V1014) group across ALL quarters:   upa_month_min = MAX of all month_min_pos from all quarters   upa_month_max = MIN of all month_max_pos from all quarters"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-6-dynamic-exception-detection","dir":"Articles","previous_headings":"The Algorithm Explained","what":"Step 6: Dynamic Exception Detection","title":"Getting Started with mensalizePNADC","text":"quarters need relaxed timing rules. algorithm dynamically detects : standard rules produce impossible results (min > max) alternative work, quarter flagged needing exception. Known exception quarters (detected automatically): 2016t3, 2016t4, 2017t2, 2022t3, 2023t2","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"step-7-final-assignment","dir":"Articles","previous_headings":"The Algorithm Explained","what":"Step 7: Final Assignment","title":"Getting Started with mensalizePNADC","text":"applying exceptions: upa_month_min == upa_month_max, reference month determined. Otherwise, remains NA. makes observations indeterminate (~3%)? Handling indeterminate observations: Exclude: Remove monthly analysis Quarterly fallback: Use original quarterly weights Proportional distribution: Distribute 1/3 month","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"monthly-weights","dir":"Articles","previous_headings":"","what":"Monthly Weights","title":"Getting Started with mensalizePNADC","text":"monthly aggregate estimates, need monthly-appropriate survey weights.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"how-weight-calibration-works","dir":"Articles","previous_headings":"Monthly Weights","what":"How Weight Calibration Works","title":"Getting Started with mensalizePNADC","text":"compute_weights = TRUE, package: 1. Fetches monthly population SIDRA API (table 6022) SIDRA provides moving-quarter population estimates, exact monthly values: package shifts values align center month. Boundary months (Jan 2012, latest month) extrapolated via quadratic regression. 2. Applies hierarchical rake weighting across nested calibration cells: level, weights adjusted monthly totals match quarterly totals proportionally. 3. Calibrates monthly population totals Final scaling ensures monthly weighted totals match SIDRA population (~206 million average).","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"usage-example","dir":"Articles","previous_headings":"Monthly Weights","what":"Usage Example","title":"Getting Started with mensalizePNADC","text":"","code":"# Load full data with all required variables pnadc_full <- fread(\"pnadc_stacked_full.csv\")  # Run mensalization with weight computation result <- mensalizePNADC(pnadc_full, compute_weights = TRUE, verbose = TRUE)  # Use weight_monthly for monthly estimates monthly_pop <- result[, .(   population = sum(weight_monthly, na.rm = TRUE) ), by = ref_month_yyyymm]"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"handling-indeterminate-observations","dir":"Articles","previous_headings":"Monthly Weights","what":"Handling Indeterminate Observations","title":"Getting Started with mensalizePNADC","text":"default (keep_all = TRUE), input rows returned, weight_monthly = NA indeterminate observations:","code":"# Default: returns all rows (indeterminate have weight_monthly = NA) result <- mensalizePNADC(pnadc_full, compute_weights = TRUE) nrow(result) == nrow(pnadc_full)  # TRUE - all rows returned sum(is.na(result$weight_monthly))  # ~3% of rows have NA weights  # Use na.rm = TRUE when aggregating monthly_pop <- result[, .(pop = sum(weight_monthly, na.rm = TRUE)), by = ref_month_yyyymm]  # Alternative: returns only determined rows result_determined <- mensalizePNADC(pnadc_full, compute_weights = TRUE, keep_all = FALSE) nrow(result_determined) < nrow(pnadc_full)  # TRUE (~97% of rows)"},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"using-modular-functions","dir":"Articles","previous_headings":"Advanced Usage","what":"Using Modular Functions","title":"Getting Started with mensalizePNADC","text":"control, use individual functions:","code":"# Step 1: Just identify reference months months <- identify_reference_month(pnadc)  # Step 2: Check determination rate by quarter months[, .(   total = .N,   determined = sum(!is.na(ref_month_in_quarter)),   rate = round(mean(!is.na(ref_month_in_quarter)) * 100, 1) ), by = .(Ano, Trimestre)]  # Step 3: Validate input data validation <- validate_pnadc(pnadc, stop_on_error = FALSE)  # Step 4: Fetch population data manually pop_data <- fetch_monthly_population(verbose = TRUE)  # Step 5: Calibrate weights separately calibrated <- calibrate_monthly_weights(merged_data, pop_data)"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"topic-specific-calibration-coming-soon","dir":"Articles","previous_headings":"Advanced Usage","what":"Topic-Specific Calibration (Coming Soon)","title":"Getting Started with mensalizePNADC","text":"calibrate_to_sidra() function provides theme-specific Bayesian calibration exactly match IBGE’s published SIDRA series. base weight_monthly provides general-purpose monthly weights. exact alignment specific published series (unemployment rate, employment levels), use theme-specific calibration:","code":""},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"benchmarks","dir":"Articles","previous_headings":"Performance","what":"Benchmarks","title":"Getting Started with mensalizePNADC","text":"Key optimization: make_date() function uses pre-computed lookup tables instead ISOdate(), achieving 20x speedup date operations.","code":""},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"optimization-tips","dir":"Articles","previous_headings":"Performance","what":"Optimization Tips","title":"Getting Started with mensalizePNADC","text":"Use data.table directly (automatic conversion data.frame adds overhead) Load required columns reading data Process multiple years together (cross-quarter aggregation improves accuracy)","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"tips-and-best-practices","dir":"Articles","previous_headings":"","what":"Tips and Best Practices","title":"Getting Started with mensalizePNADC","text":"Process multiple quarters together: Processing 2012-2025 together gives ~97% determination vs ~70% per-quarter. Start reference month identification: don’t always need monthly weights. Often just knowing reference month enough. Check determination rates year: Rates 96-99% 2013-2019. Lower rates may indicate data issues. Handle indeterminate observations: Decide whether exclude use quarterly-level analysis cases. Use weight_monthly general analysis: rake-weighted output appropriate purposes.","code":"crosswalk[, .(rate = mean(!is.na(ref_month_in_quarter))), by = .(Ano, Trimestre)]"},{"path":"https://antrologos.github.io/mensalizePNADC/articles/getting-started.html","id":"further-reading","dir":"Articles","previous_headings":"","what":"Further Reading","title":"Getting Started with mensalizePNADC","text":"IBGE PNADC Documentation Package function reference: ?mensalizePNADC, ?identify_reference_month Source code: GitHub repository","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Marcos Hecksher. Author. Rogerio Barbosa. Author, maintainer. Claude AI. Contributor.           R package implementation","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hecksher M, Barbosa R (2026). mensalizePNADC: Convert Quarterly PNADC Survey Data Monthly Time Series. R package version 0.1.0, https://github.com/antrologos/mensalizePNADC, https://antrologos.github.io/mensalizePNADC/.","code":"@Manual{,   title = {mensalizePNADC: Convert Quarterly PNADC Survey Data to Monthly Time Series},   author = {Marcos Hecksher and Rogerio Barbosa},   year = {2026},   note = {R package version 0.1.0,     https://github.com/antrologos/mensalizePNADC},   url = {https://antrologos.github.io/mensalizePNADC/}, }"},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"mensalizepnadc","dir":"","previous_headings":"","what":"Convert Quarterly PNADC Survey Data to Monthly Time Series","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"Convert Brazil’s quarterly PNADC survey data monthly time series. 📖 Full Documentation — Detailed algorithm explanation examples diagrams","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"mensalizePNADC package identifies reference months Brazil’s quarterly PNADC (Pesquisa Nacional por Amostra de Domicilios Continua) survey data optionally computes monthly survey weights. enables monthly (instead quarterly) labor market analysis using PNADC microdata. Key Features: High accuracy: 97.0% determination rate 28.4 million observations (2012-2025) — identical Stata Dynamic exception detection: Automatically detects quarters needing relaxed timing rules Fast processing: ~1 minute 28.4 million rows (basic mode) — ~450,000 rows/sec Minimal dependencies: Requires data.table checkmate; sidrar needed weight calibration Flexible output: Returns crosswalk easy joins original data","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"","code":"# Install from GitHub devtools::install_github(\"antrologos/mensalizePNADC\")"},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick Start","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"","code":"library(mensalizePNADC) library(data.table)  # Load stacked quarterly PNADC data (minimum required columns) pnadc <- fread(\"pnadc_stacked.csv\",   select = c(\"Ano\", \"Trimestre\", \"UPA\", \"V1008\", \"V1014\", \"V2003\",              \"V2008\", \"V20081\", \"V20082\", \"V2009\"))  # Get reference month crosswalk crosswalk <- mensalizePNADC(pnadc) # Step 1/1: Identifying reference months... #   Determination rate: 97.0%  # Join with original data result <- merge(original_data, crosswalk,   by = c(\"Ano\", \"Trimestre\", \"UPA\", \"V1008\", \"V1014\", \"V2003\"))  # Now use ref_month_yyyymm for monthly analysis result[, .(n = .N), by = ref_month_yyyymm]"},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"important-use-stacked-data-for-best-results","dir":"","previous_headings":"","what":"Important: Use Stacked Data for Best Results","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"mensalization algorithm achieves 97.0% determination rate processing stacked multi-quarter data. process quarters individually, ’ll get ~65-75% determination. design: PNADC uses rotating panel households interviewed relative month position quarter. algorithm combines birthday constraints quarters narrow month household belongs . Recommended: Stack least 2 years quarterly data calling mensalizePNADC().","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"required-input-variables","dir":"","previous_headings":"","what":"Required Input Variables","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"Minimum (reference month identification ): Additional (compute_weights = TRUE):","code":""},{"path":[]},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"performance","dir":"","previous_headings":"","what":"Performance","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"97.0% determination rate 28.4 million observations (2012-2025) ~1 minute basic processing (28.4M rows) — ~450,000 rows/sec ~5 minutes weight calibration — ~95,000 rows/sec Identical results original Stata implementation","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"📖 Online Documentation — Full pkgdown site function reference 📖 Getting Started Vignette — Detailed algorithm explanation diagrams installing: vignette(\"getting-started\", package = \"mensalizePNADC\")","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"authors","dir":"","previous_headings":"","what":"Authors","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"Marcos Hecksher - Original methodology Stata implementation Rogerio Barbosa - R package maintainer","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"IBGE PNADC Documentation Hecksher, M. (2024). Mensalizacao da PNADC. Working paper.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Convert Quarterly PNADC Survey Data to Monthly Time Series","text":"MIT","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_monthly_weights.html","id":null,"dir":"Reference","previous_headings":"","what":"Calibrate Monthly Weights — calibrate_monthly_weights","title":"Calibrate Monthly Weights — calibrate_monthly_weights","text":"original PNADC survey weights (V1028) designed quarterly estimates. function creates monthly weights : Grouping observations nested demographic/geographic cells Iteratively adjusting weights monthly totals match quarterly totals within cell Calibrating final weights external monthly population totals","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_monthly_weights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calibrate Monthly Weights — calibrate_monthly_weights","text":"","code":"calibrate_monthly_weights(   data,   monthly_totals,   n_cells = 4L,   keep_all = TRUE,   verbose = TRUE )"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_monthly_weights.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calibrate Monthly Weights — calibrate_monthly_weights","text":"data data.frame data.table PNADC microdata including reference month information (output identify_reference_month). Required columns include: Reference month columns: ref_month_yyyymm, ref_month_in_quarter Survey design: V1028, UF, posest, posest_sxi Demographics: V2009 (age) Time: Ano, Trimestre monthly_totals data.frame monthly population totals. Required columns: ref_month_yyyymm anomesexato: YYYYMM integer m_populacao: Monthly population thousands n_cells Integer. Number hierarchical cell levels use (1-4). Default 4 (full hierarchy). Lower values faster less precise. keep_all Logical. TRUE (default), return rows including indeterminate reference months (weight_calibrated = NA). FALSE, return observations determined reference months. verbose Logical. Print progress messages? Default TRUE.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_monthly_weights.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calibrate Monthly Weights — calibrate_monthly_weights","text":"data.table input data plus: weight_calibrated: Calibrated monthly weight celula1 celula4: Cell identifiers (computed)","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_monthly_weights.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calibrate Monthly Weights — calibrate_monthly_weights","text":"Redistributes quarterly survey weights monthly weights using hierarchical calibration across demographic geographic cells. hierarchical calibration cells : celula1 Age groups: 0-13, 14-29, 30-59, 60+ celula2 Post-stratum group + age group celula3 State (UF) + celula2 celula4 Post-stratum (posest) + celula2 level, weights adjusted : sum(weight_new) (cell, month) / sum(weight_old) (cell, month) equals sum(V1028) (cell, quarter) / sum(weight_old) (cell, month) preserves quarterly totals redistributing months.","code":""},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_monthly_weights.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calibrate Monthly Weights — calibrate_monthly_weights","text":"","code":"if (FALSE) { # \\dontrun{ # First identify reference months crosswalk <- identify_reference_month(pnadc_data) merged <- merge(pnadc_data, crosswalk, by = join_keys)  # Then calibrate weights result <- calibrate_monthly_weights(merged, monthly_pop) } # }"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_to_sidra.html","id":null,"dir":"Reference","previous_headings":"","what":"Calibrate Weights to IBGE SIDRA Series (Optional) — calibrate_to_sidra","title":"Calibrate Weights to IBGE SIDRA Series (Optional) — calibrate_to_sidra","text":"optional function users need estimates exactly match IBGE's official monthly series. core mensalizePNADC function already produces valid monthly weights; function provides additional calibration specific themes. Important: Different themes require different Bayesian calibrations. example, weights calibrated match unemployment rates differ weights calibrated match employment levels.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_to_sidra.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calibrate Weights to IBGE SIDRA Series (Optional) — calibrate_to_sidra","text":"","code":"calibrate_to_sidra(   data,   theme = c(\"unemployment\", \"employment\", \"labor_force\", \"income\", \"custom\"),   sidra_series = NULL,   verbose = TRUE )  adjust_weights_bayesian(data, monthly_targets, employment_detail = TRUE)"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_to_sidra.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calibrate Weights to IBGE SIDRA Series (Optional) — calibrate_to_sidra","text":"data data.table output mensalizePNADC compute_weights = TRUE. Must contain weight_monthly employment status variables (VD4001, VD4002, etc.). theme Character. IBGE series match: \"unemployment\" Taxa de desocupacao - unemployment rate \"employment\" Populacao ocupada - employment levels \"labor_force\" PEA/PNEA - labor force participation \"income\" Rendimento habitual - income aggregates \"custom\" User provides target series via sidra_series sidra_series Optional data.frame monthly target series. Required theme = \"custom\". Must contain: ref_month_yyyymm: Month YYYYMM format m_*: Target values indicator (thousands) verbose Logical. Print progress messages? Default TRUE.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_to_sidra.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calibrate Weights to IBGE SIDRA Series (Optional) — calibrate_to_sidra","text":"data.table input data plus: weight_sidra: Bayesian-adjusted weight matching SIDRA series original weight_monthly preserved comparison.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_to_sidra.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calibrate Weights to IBGE SIDRA Series (Optional) — calibrate_to_sidra","text":"Applies theme-specific Bayesian calibration aggregated estimates match IBGE's official SIDRA published series.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_to_sidra.html","id":"why-theme-specific-calibration-","dir":"Reference","previous_headings":"","what":"Why Theme-Specific Calibration?","title":"Calibrate Weights to IBGE SIDRA Series (Optional) — calibrate_to_sidra","text":"IBGE's published SIDRA series internally consistent use slightly different adjustments different indicators. means: Weights optimized unemployment rate may sum exactly published employment level Weights optimized employment may produce exact published unemployment rate Choose theme matches primary analysis focus.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_to_sidra.html","id":"algorithm","dir":"Reference","previous_headings":"","what":"Algorithm","title":"Calibrate Weights to IBGE SIDRA Series (Optional) — calibrate_to_sidra","text":"Uses Bayes' theorem adjust individual weights: $$P(status | category) = P(status) \\times P(category | status) / P(category)$$ : status = employment situation (employed, unemployed, etc.) category = demographic/geographic cell P(status) derived SIDRA targets","code":""},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/reference/calibrate_to_sidra.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calibrate Weights to IBGE SIDRA Series (Optional) — calibrate_to_sidra","text":"","code":"if (FALSE) { # \\dontrun{ # First, get base weights (auto-fetches population from SIDRA) crosswalk <- mensalizePNADC(pnadc_full, compute_weights = TRUE)  # Then, calibrate for unemployment analysis unemployment_data <- calibrate_to_sidra(crosswalk, theme = \"unemployment\")  # Calculate unemployment rate (will match IBGE SIDRA exactly) unemployment_data[, .(   rate = sum(weight_sidra * (VD4002 == 2)) /          sum(weight_sidra * (VD4001 == 1)) * 100 ), by = ref_month_yyyymm] } # }"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/compute_labor_indicators.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Labor Force Indicators — compute_labor_indicators","title":"Compute Labor Force Indicators — compute_labor_indicators","text":"Computes employment rates, unemployment rates, labor market indicators using survey weights. Can compute indicators grouping variable (typically month).","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/compute_labor_indicators.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Labor Force Indicators — compute_labor_indicators","text":"","code":"compute_labor_indicators(   data,   weight_var = \"weight_monthly\",   by = \"ref_month_yyyymm\",   indicators = \"all\" )"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/compute_labor_indicators.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Labor Force Indicators — compute_labor_indicators","text":"data data.frame data.table PNADC microdata weights. Required columns depend indicators requested. weight_var Character. Name weight variable use. Default \"weight_monthly\". Character vector grouping variables. Default \"ref_month_yyyymm\" monthly indicators. indicators Character vector indicators compute. Options: \"population\": Total population, age 14+, labor force, etc. \"employment\": Employment type (formal, informal, etc.) \"sector\": Employment economic sector \"rates\": Unemployment rate, participation rate, etc \"income\": Income aggregates averages \"\": indicators (default)","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/compute_labor_indicators.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Labor Force Indicators — compute_labor_indicators","text":"data.table requested indicators aggregated grouping variables.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/compute_labor_indicators.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Labor Force Indicators — compute_labor_indicators","text":"Calculates standard PNADC labor force indicators weighted microdata. Population indicators: pop_total: Total population pop_14plus: Population age 14+ pop_employed: Employed persons pop_unemployed: Unemployed persons pop_labor_force: Labor force (employed + unemployed) pop_out_of_lf: labor force Rate indicators: rate_participation: Labor force / pop 14+ (%) rate_employment: Employed / pop 14+ (%) rate_unemployment: Unemployed / labor force (%)","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/compute_labor_indicators.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Labor Force Indicators — compute_labor_indicators","text":"","code":"if (FALSE) { # \\dontrun{ # Monthly indicators indicators <- compute_labor_indicators(weighted_data)  # Indicators by state by_state <- compute_labor_indicators(weighted_data, by = c(\"ref_month_yyyymm\", \"UF\")) } # }"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/fetch-sidra-population.html","id":null,"dir":"Reference","previous_headings":"","what":"Fetch Monthly Population from SIDRA — fetch-sidra-population","title":"Fetch Monthly Population from SIDRA — fetch-sidra-population","text":"Functions download transform IBGE's population estimates SIDRA API use monthly weight calibration.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/fetch_monthly_population.html","id":null,"dir":"Reference","previous_headings":"","what":"Fetch Monthly Population from SIDRA — fetch_monthly_population","title":"Fetch Monthly Population from SIDRA — fetch_monthly_population","text":"Downloads population estimates IBGE SIDRA API (table 6022) transforms moving-quarter exact monthly values.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/fetch_monthly_population.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fetch Monthly Population from SIDRA — fetch_monthly_population","text":"","code":"fetch_monthly_population(   start_yyyymm = NULL,   end_yyyymm = NULL,   verbose = TRUE )"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/fetch_monthly_population.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fetch Monthly Population from SIDRA — fetch_monthly_population","text":"start_yyyymm Integer. First month include (YYYYMM format). NULL, returns available months. end_yyyymm Integer. Last month include (YYYYMM format). NULL, returns available months. verbose Logical. Print progress messages? Default TRUE.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/fetch_monthly_population.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fetch Monthly Population from SIDRA — fetch_monthly_population","text":"data.table columns: ref_month_yyyymm: Integer YYYYMM format m_populacao: Monthly population thousands","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/fetch_monthly_population.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fetch Monthly Population from SIDRA — fetch_monthly_population","text":"SIDRA table 6022 provides moving-quarter population estimates. value represents 3-month average centered middle month. example, value code 201203 (quarter ending March 2012) represents population February 2012. function: Fetches raw moving-quarter data SIDRA Transforms exact monthly values aligning middle months Extrapolates boundary months (first last) using quadratic regression extrapolation follows methodology Hecksher (2024), using quadratic regression population differences estimate first month (Jan 2012) recent month.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/fetch_monthly_population.html","id":"dependencies","dir":"Reference","previous_headings":"","what":"Dependencies","title":"Fetch Monthly Population from SIDRA — fetch_monthly_population","text":"function requires sidrar package API access. Install : install.packages(\"sidrar\")","code":""},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/reference/fetch_monthly_population.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fetch Monthly Population from SIDRA — fetch_monthly_population","text":"","code":"if (FALSE) { # \\dontrun{ # Fetch all available months pop <- fetch_monthly_population()  # Fetch specific date range pop <- fetch_monthly_population(201301, 201912) } # }"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/identify_reference_month.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify Reference Month in PNADC Data — identify_reference_month","title":"Identify Reference Month in PNADC Data — identify_reference_month","text":"PNADC quarterly survey, interview actually refers specific month within quarter. function identifies month observation belongs , enabling shorter term time series analysis. algorithm uses: IBGE's reference week timing rules (first Saturday sufficient days month) Respondent birthdates constrain possible interview dates UPA-panel level aggregation (everyone sampling unit interviewed together) Dynamic exception detection (identifies quarters needing relaxed rules data)","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/identify_reference_month.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify Reference Month in PNADC Data — identify_reference_month","text":"","code":"identify_reference_month(data, verbose = TRUE, .pb = NULL, .pb_offset = 0L)"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/identify_reference_month.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify Reference Month in PNADC Data — identify_reference_month","text":"data data.frame data.table PNADC microdata. Required columns: Ano: Survey year Trimestre: Quarter (1-4) UPA: Primary Sampling Unit V1014: Panel identifier V2008: Birth day (1-31) V20081: Birth month (1-12) V20082: Birth year V2009: Age Optional recommended complete crosswalk: V1008: Household sequence within UPA V2003: Person sequence within household verbose Logical. TRUE (default), display progress bar step information. .pb Optional progress bar object created txtProgressBar. provided, function updates progress bar instead creating . Used internally mensalizePNADC() show unified progress across steps. .pb_offset Integer. Offset add progress bar updates using external progress bar. Default 0.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/identify_reference_month.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify Reference Month in PNADC Data — identify_reference_month","text":"data.table original key columns plus: ref_month: Reference month Date (first day month, e.g., \"2023-01-01\") ref_month_in_quarter: Position quarter (1, 2, 3) NA indeterminate ref_month_yyyymm: Integer YYYYMM format (e.g., 202301)","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/identify_reference_month.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Identify Reference Month in PNADC Data — identify_reference_month","text":"Determines month within quarter corresponds survey observation based IBGE's \"Parada Tecnica\" (technical break) rules.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/identify_reference_month.html","id":"exception-detection","dir":"Reference","previous_headings":"","what":"Exception Detection","title":"Identify Reference Month in PNADC Data — identify_reference_month","text":"function detects quarters need relaxed timing rules based data . algorithm detects exceptions per-month level within quarter: Checks standard rules produce impossible results (min > max) Checks relaxed rules resolve issue Applies exception rules entire quarter UPA requires ","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/identify_reference_month.html","id":"cross-quarter-aggregation-important-","dir":"Reference","previous_headings":"","what":"Cross-Quarter Aggregation (Important!)","title":"Identify Reference Month in PNADC Data — identify_reference_month","text":"optimal determination rates (~97%), input data stacked across multiple quarters (ideally 4+ years). algorithm leverages PNADC's rotating panel design UPA-V1014 interviewed relative week across quarterly visits. Per-quarter processing: ~65-75% determination rate Multi-quarter stacked: ~97% determination rate","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/identify_reference_month.html","id":"processing-steps","dir":"Reference","previous_headings":"","what":"Processing Steps","title":"Identify Reference Month in PNADC Data — identify_reference_month","text":"function processes data following steps: Calculate first valid interview Saturday month quarter (standard rule) person, calculate possible interview date range based birthday constraints Convert date ranges month--quarter positions Aggregate UPA-panel level (persons must agree) Calculate alternative (exception) date ranges positions Dynamically detect quarters/months need exception rules Apply exception rules recalculate final month positions","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/identify_reference_month.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identify Reference Month in PNADC Data — identify_reference_month","text":"","code":"if (FALSE) { # \\dontrun{ # Identify reference months result <- identify_reference_month(pnadc_data)  # Check determination rate result[, .(   total = .N,   determined = sum(!is.na(ref_month_in_quarter)),   rate = mean(!is.na(ref_month_in_quarter)) ), by = .(Ano, Trimestre)] } # }"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC-package.html","id":null,"dir":"Reference","previous_headings":"","what":"mensalizePNADC: Convert Quarterly PNADC Survey Data to Monthly Time Series — mensalizePNADC-package","title":"mensalizePNADC: Convert Quarterly PNADC Survey Data to Monthly Time Series — mensalizePNADC-package","text":"mensalizePNADC package provides tools identify exact month Brazil's quarterly official household survey, PNADC (Pesquisa Nacional por Amostra de Domicilios Continua - IBGE), allowing analyzing survey data monthly time series.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"mensalizePNADC: Convert Quarterly PNADC Survey Data to Monthly Time Series — mensalizePNADC-package","text":"package offers two main capabilities: Reference month identification: Determines month within quarter survey observation refers , using IBGE's \"Parada Tecnica\" rules respondent birthdates Monthly weight computation: Adjusts survey weights monthly (instead quarterly) estimates using customized calibration package highly optimized large datasets: approximately 1 minute process 28.4 million rows (450,000 rows/sec), 97.0 percent determination rate (identical Stata implementation). Uses pre-computed lookup tables 20x faster date creation. main function mensalizePNADC, processes stacked quarterly PNADC data returns crosswalk joining original data.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"mensalizePNADC: Convert Quarterly PNADC Survey Data to Monthly Time Series — mensalizePNADC-package","text":"IBGE Manual Basico da Entrevista PNADC (methodology \"Parada Tecnica\")","code":""},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"mensalizePNADC: Convert Quarterly PNADC Survey Data to Monthly Time Series — mensalizePNADC-package","text":"Marcos Hecksher mdhecksher@gmail.com Rogerio Barbosa rogerio.barbosa@iesp.uerj.br","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC.html","id":null,"dir":"Reference","previous_headings":"","what":"Mensalize PNADC Quarterly Survey Data — mensalizePNADC","title":"Mensalize PNADC Quarterly Survey Data — mensalizePNADC","text":"function processes stacked quarterly PNADC microdata : Identify month within quarter observation refers Optionally compute monthly adjusted survey weights (compute_weights = TRUE) output crosswalk table can joined original (stacked unstacked) PNADC data files add monthly time information.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mensalize PNADC Quarterly Survey Data — mensalizePNADC","text":"","code":"mensalizePNADC(   data,   compute_weights = FALSE,   keep_all = TRUE,   output = c(\"crosswalk\", \"microdata\", \"aggregates\"),   verbose = TRUE )"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mensalize PNADC Quarterly Survey Data — mensalizePNADC","text":"data data.frame data.table stacked quarterly PNADC microdata. reference month identification (compute_weights = FALSE), minimum required columns : Ano, Trimestre: Year quarter UPA, V1014: Primary sampling unit panel V2008, V20081, V20082: Birth day, month, year V2009: Age monthly weight computation (compute_weights = TRUE), additional columns required. See Details. compute_weights Logical. TRUE, compute monthly adjusted survey weights addition identifying reference months. Default FALSE. Requires sidrar package fetch population data IBGE SIDRA API. makes monthly weights sum population results https://sidra.ibge.gov.br/tabela/6022. keep_all Logical. TRUE (default), return rows input data, weight_monthly = NA observations reference month determined. FALSE, return observations determined reference months (smaller output). applies compute_weights = TRUE. output Character. return: \"crosswalk\" (default): Minimal crosswalk joining \"microdata\": Full microdata computed columns \"aggregates\": Monthly aggregated indicators verbose Logical. Print progress messages? Default TRUE.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mensalize PNADC Quarterly Survey Data — mensalizePNADC","text":"Depends output parameter: output = \"crosswalk\" (default): data.table join keys new time variables: Join keys: Ano, Trimestre, UPA, V1008, V1014, V2003 ref_month: Reference month Date ref_month_in_quarter: Position quarter (1, 2, 3) NA ref_month_yyyymm: Integer YYYYMM format weight_monthly: Monthly weight (compute_weights = TRUE) output = \"microdata\": Full input data computed columns added. output = \"aggregates\": Monthly aggregated indicators.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Mensalize PNADC Quarterly Survey Data — mensalizePNADC","text":"Main function convert quarterly PNADC survey data monthly time series. Returns crosswalk data.frame joining original data, adding reference month information optionally monthly survey weights.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC.html","id":"reference-month-identification","dir":"Reference","previous_headings":"","what":"Reference Month Identification","title":"Mensalize PNADC Quarterly Survey Data — mensalizePNADC","text":"algorithm determines month survey response refers based : IBGE's \"Parada Tecnica\" rules reference week timing Respondent birthdates (constrains possible interview dates) UPA-panel grouping (everyone interviewed together)","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC.html","id":"cross-quarter-aggregation-important-","dir":"Reference","previous_headings":"","what":"Cross-Quarter Aggregation (Important!)","title":"Mensalize PNADC Quarterly Survey Data — mensalizePNADC","text":"optimal determination rates (~97%), input data stacked across multiple quarter datasets (ideally 4+ years). algorithm leverages PNADC's rotating panel design locations defined values variables UPA-V1014 always interviewed relative month within given quarter across quarterly visits. Per-quarter processing: ~65-75% determination rate Multi-quarter stacked: ~97% determination rate cross-quarter aggregation dramatically improves accuracy combining birthday constraints multiple interview rounds.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC.html","id":"monthly-weight-computation","dir":"Reference","previous_headings":"","what":"Monthly Weight Computation","title":"Mensalize PNADC Quarterly Survey Data — mensalizePNADC","text":"compute_weights = TRUE, function: Fetches monthly population IBGE SIDRA API (table 6022) Redistributes quarterly weights months using hierarchical rake weighting Smooths monthly aggregates remove quarterly artifacts resulting weight_monthly adjusted weight general-purpose monthly analysis. theme-specific calibration match IBGE SIDRA series (e.g., unemployment rate, employment levels), use calibrate_to_sidra separately. Additional required columns weight computation: Survey design: V1028, V1008, V2003, UF, posest, posest_sxi","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC.html","id":"dependencies","dir":"Reference","previous_headings":"","what":"Dependencies","title":"Mensalize PNADC Quarterly Survey Data — mensalizePNADC","text":"compute_weights = TRUE, sidrar package required fetch population data. Install : install.packages(\"sidrar\")","code":""},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/reference/mensalizePNADC.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mensalize PNADC Quarterly Survey Data — mensalizePNADC","text":"","code":"if (FALSE) { # \\dontrun{ # Basic usage: identify reference months only library(mensalizePNADC)  # Load stacked quarterly data (minimum columns) pnadc <- data.table::fread(\"pnadc_stacked.csv\",   select = c(\"Ano\", \"Trimestre\", \"UPA\", \"V1008\", \"V1014\", \"V2003\",              \"V2008\", \"V20081\", \"V20082\", \"V2009\"))  # Get crosswalk crosswalk <- mensalizePNADC(pnadc)  # Join with original quarterly file original <- haven::read_dta(\"PNADC_2023T1.dta\") monthly <- dplyr::left_join(original, crosswalk,   by = c(\"Ano\", \"Trimestre\", \"UPA\", \"V1008\", \"V1014\", \"V2003\"))   # With monthly weights for general analysis # (requires sidrar package and internet connection) pnadc_full <- haven::read_dta(\"PNADCtrimestralempilhada.dta\")  result <- mensalizePNADC(pnadc_full, compute_weights = TRUE)  # Use weight_monthly for any monthly aggregate result[, .(pop = sum(weight_monthly)), by = ref_month_yyyymm] } # }"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/smooth_monthly_aggregates.html","id":null,"dir":"Reference","previous_headings":"","what":"Smooth Monthly Aggregates — smooth_monthly_aggregates","title":"Smooth Monthly Aggregates — smooth_monthly_aggregates","text":"quarterly survey data converted monthly estimates, resulting time series often shows artificial quarterly patterns. function applies smoothing algorithm : Computes 3-month differences capture trends Stratifies month position within quarter (1st, 2nd, 3rd) Accumulates changes via cumulative sums Calibrates reference period Produces smooth monthly series preserve genuine variation","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/smooth_monthly_aggregates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smooth Monthly Aggregates — smooth_monthly_aggregates","text":"","code":"smooth_monthly_aggregates(   monthly_aggregates,   calibration_start = 201301L,   calibration_end = 201912L )"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/smooth_monthly_aggregates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Smooth Monthly Aggregates — smooth_monthly_aggregates","text":"monthly_aggregates data.table monthly aggregated indicators. Required columns: ref_month_yyyymm: Month identifier YYYYMM format z_*: Indicator columns monthly totals (e.g., z_popocup) calibration_start Integer YYYYMM. Start calibration period. Default 201301. calibration_end Integer YYYYMM. End calibration period. Default 201912.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/smooth_monthly_aggregates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Smooth Monthly Aggregates — smooth_monthly_aggregates","text":"data.table smoothed monthly estimates. input variable z_varname, output includes: m_varname: Smoothed monthly estimate","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/smooth_monthly_aggregates.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Smooth Monthly Aggregates — smooth_monthly_aggregates","text":"Applies moving average methodology remove quarterly artifacts monthly estimates derived quarterly survey data. smoothing algorithm works follows: indicator variable: Compute 3-month difference: d3 = 3 * (value[t] - value[t-1]) Split month position (1, 2, 3 within quarter) Compute cumulative sum within position Calculate residual intermediate series calibration period Apply position-specific adjustment Final smoothed value uses moving average quarterly reference","code":""},{"path":[]},{"path":"https://antrologos.github.io/mensalizePNADC/reference/smooth_monthly_aggregates.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Smooth Monthly Aggregates — smooth_monthly_aggregates","text":"","code":"if (FALSE) { # \\dontrun{ # After calibrating weights, aggregate to monthly totals monthly_agg <- calibrated_data[, .(z_populacao = sum(weight_calibrated)), by = ref_month_yyyymm] smoothed <- smooth_monthly_aggregates(monthly_agg) } # }"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/utils-dates.html","id":null,"dir":"Reference","previous_headings":"","what":"Date Utility Functions — utils-dates","title":"Date Utility Functions — utils-dates","text":"Internal helper functions date calculations, designed match Stata's date handling conventions. Optimized pre-computed lookup tables fast date creation (~20x faster ISOdate).","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/utils-validation.html","id":null,"dir":"Reference","previous_headings":"","what":"Input Validation Utilities — utils-validation","title":"Input Validation Utilities — utils-validation","text":"Internal helper functions validating PNADC input data.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/validate_pnadc.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate PNADC Input Data — validate_pnadc","title":"Validate PNADC Input Data — validate_pnadc","text":"Checks input data required columns specified processing.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/validate_pnadc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate PNADC Input Data — validate_pnadc","text":"","code":"validate_pnadc(data, check_weights = FALSE, stop_on_error = TRUE)"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/validate_pnadc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate PNADC Input Data — validate_pnadc","text":"data data.frame data.table PNADC microdata check_weights Logical. TRUE, also check weight-related variables. stop_on_error Logical. TRUE, stops error. FALSE, returns validation report list.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/validate_pnadc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate PNADC Input Data — validate_pnadc","text":"stop_on_error TRUE, returns invisibly valid stops error. FALSE, returns list validation results.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/validate_pnadc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Validate PNADC Input Data — validate_pnadc","text":"","code":"if (FALSE) { # \\dontrun{ validate_pnadc(my_data) validate_pnadc(my_data, check_weights = TRUE) } # }"},{"path":"https://antrologos.github.io/mensalizePNADC/reference/vignette_series.html","id":null,"dir":"Reference","previous_headings":"","what":"Pre-computed Labor Market Series for Vignette Examples — vignette_series","title":"Pre-computed Labor Market Series for Vignette Examples — vignette_series","text":"datasets contain pre-computed quarterly monthly labor market indicators PNADC data (2012-Q1 2025-Q3). used \"Applied Examples\" vignette demonstrate value mensalization.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/vignette_series.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Pre-computed Labor Market Series for Vignette Examples — vignette_series","text":"Data tables labor market indicators: vignette_quarterly_total vignette_monthly_total: period Date observation unemployment_rate Unemployment rate participation_rate Labor force participation rate formalization_rate Share formal employment employment_level Employment--population ratio frequency Either \"Quarterly\" \"Monthly\" vignette_quarterly_gender vignette_monthly_gender: period Date observation sexo \"Men\" \"Women\" participation_rate Labor force participation rate unemployment_rate Unemployment rate frequency Either \"Quarterly\" \"Monthly\" vignette_quarterly_race vignette_monthly_race: period Date observation raca \"White\", \"Black\", \"Brown\" employment_level Employment--population ratio unemployment_rate Unemployment rate frequency Either \"Quarterly\" \"Monthly\" vignette_metadata: List : determination_rate Proportion observations assigned months n_observations Total number observations processed period_start First quarter data period_end Last quarter data generated_date Date data generated","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/vignette_series.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Pre-computed Labor Market Series for Vignette Examples — vignette_series","text":"Computed PNADC microdata (IBGE) using mensalizePNADC.","code":""},{"path":"https://antrologos.github.io/mensalizePNADC/reference/vignette_series.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Pre-computed Labor Market Series for Vignette Examples — vignette_series","text":"","code":"# Load the data data(vignette_series)  # Check the quarterly unemployment series head(vignette_quarterly_total) #> Key: <Ano, Trimestre> #>      Ano Trimestre       pia      pea employed unemployed   formal #>    <int>     <int>     <num>    <num>    <num>      <num>    <num> #> 1:  2012         1 153031139 95326786 87713372    7613414 51535264 #> 2:  2012         2 153563499 96637255 89317837    7319418 52423462 #> 3:  2012         3 154104058 96854910 89957697    6897213 53183612 #> 4:  2012         4 154641041 96893288 90209026    6684262 53508367 #> 5:  2013         1 155174436 97105372 89297958    7807414 53370203 #> 6:  2013         2 155687158 97756285 90418683    7337602 54072265 #>    unemployment_rate participation_rate formalization_rate employment_level #>                <num>              <num>              <num>            <num> #> 1:        0.07986647          0.6229241          0.5875417        0.5731734 #> 2:        0.07574116          0.6292983          0.5869316        0.5816346 #> 3:        0.07121181          0.6285033          0.5912069        0.5837465 #> 4:        0.06898581          0.6265690          0.5931598        0.5833447 #> 5:        0.08040146          0.6257820          0.5976643        0.5754682 #> 6:        0.07506015          0.6279020          0.5980209        0.5807716 #>        period frequency #>        <Date>    <char> #> 1: 2012-02-15 Quarterly #> 2: 2012-05-15 Quarterly #> 3: 2012-08-15 Quarterly #> 4: 2012-11-15 Quarterly #> 5: 2013-02-15 Quarterly #> 6: 2013-05-15 Quarterly  # Check metadata vignette_metadata$determination_rate #> [1] 0.9542711"}]
